import{B as H}from"./index-DOAnfiMc.js";import{C as z}from"./index-CoHYOsAq.js";import{F as N}from"./index-B8UWVO2a.js";import{I as E}from"./index-BVBpVZEi.js";import{a as S}from"./basic-tablle-data-AN7MRnVF.js";import{u as I}from"./project-7SCfM68f.js";import{T as P}from"./index-B-jw8vvV.js";import{T as R}from"./index-C6OqzQN-.js";import{_ as L}from"./repeater-Btx_aIdJ.js";import{V as D}from"./VueSelect-CeaoYkHk.js";import{I as G}from"./index-DxXSMpKh.js";import{C as M}from"./index-2iT3jdVW.js";import{S as U}from"./index-Jp7OXFH1.js";import{u as F,s as j,y as q,b as y,B as _,d as c,e as s,g as b,c as d,o as u,f as o,n as $,h as X,t as p,q as h,p as J}from"./index-CyQKzwXM.js";import{w as C}from"./widget-bg-2-DZ1m5zGG.js";import{C as K}from"./VueSelect.vue_vue_type_style_index_0_lang-XABNT5P5.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-cleave.min-BqMPJFk5.js";/* empty css                                              */import"./user-1-Dmhlt7-s.js";import"./user-4-_9lLfOE2.js";import"./user-6-Bk4CTUVR.js";import"./av-2-D6_jNZbn.js";import"./v4-D8aEg3BZ.js";import"./vee-validate.esm-BhM9XJEy.js";const f=F().headers(),W={components:{Button:H,VueSelect:D,Card:z,Checkbox:M,Textinput:R,Select:U,widgetBg2:C,InputGroup:E,vSelect:K,FromGroup:N,Icon:G,Textarea:P,Repeater:L},data(){return{advancedTable:S,idTraspase:null,totalCobranza:null,store:null,widgetBg2:C,cellClient:null,tours:[],agencyOptions:[],booking:{idMega:"",type_booking:"",user_id:"",tour_id:"",bookingorigin_id:"",arrivalplace_id:"",fullNameAgency:null,client_id:"",agency_id:"",origintransfer_id:"",code:"",correlative:"",date_arrival:"",time_arrival:"",nro_pax:"",is_reference_pax:"",nro_pax_childs:"",nro_pax_adults:"",nro_pax_olds:"",reference_voucher:"",observations:"",arrival_place:"",contact_emergency:"",telephone_emergency:"",reference_location:"",is_igv:"",igv:"",is_detail_subtotaltour:"",subtotal_tour:"",subtotal_hotel:"",subtotal_flight:"",subtotal_catalog:"",discount:"",total:"",total_paid:"",total_billing:"",is_grouped:"",description_grouped:"",is_checkin:"",is_checkout:"",is_postponed:"",user_id_postponed:"",postponed_description:"",text_amount:"",register_flight:"",is_favorite:"",is_breakfast:"",nro_breakfast:"",start_breakfast:"",end_breakfast:"",pending_tours:"",origintransfer:"",program_transfer:""},current:1,basicTableData:[{codigo:"HRS2024-000231",nombreHotel:"HOTEL POSADA LODGE (TARAPOTO)",detallehotel:"HAB. TRIPLE (AC) (2 hab. x 6 noches)",contacto:"Cel: 963122673"}],client:{document:"",fullname:"",tradename:"",address:"",cellphone:"",telephone:"",email:"",date_birthday:""},modelValue:!1,perpage:3,show:!1,showEdit:!1,show2:!1,realizado:"--",pageRange:10,actions:[{name:"edit",icon:"heroicons:pencil-square",doit:t=>{this.openModalEdit(t)}},{name:"delete",icon:"heroicons-outline:trash",doit:t=>{this.removeProject(t)}}],vehiculos:[{value:1,label:"Compartido"},{value:1,label:"Privado"}],turnos:[{value:1,label:"Full Day"},{value:2,label:"Mañana"},{value:3,label:"Tarde"},{value:4,label:"Noche"}],columns:[{label:"¿Es Abierto?",field:"abierto"},{label:"Tours Turístico",field:"tour"},{label:"Vehículo",field:"vehiculo"},{label:"Turno",field:"turno"},{label:"N° pax",field:"pasajero"},{label:"Fecha",field:"fecha"},{label:"Observación",field:"observation"},{label:"Realizado",field:"realizado"},{label:"Action",field:"action"}],columnsTraspase:[{label:"",field:"abierto"},{label:"N° pax",field:"pasajero"},{label:"Tours Turístico",field:"tour"},{label:"Vehículo",field:"vehiculo"},{label:"Turno",field:"turno"},{label:"Fecha Asigsnada",field:"fecha"},{label:"Precio corporativo	",field:"preciocorporativo"},{label:"Cobranza	",field:"cobranza"}],columnsReservaHotelExpense:[{label:"Habitacion",field:"habitacion"},{label:"N° PAX	",field:"pasajeross"},{label:"Cant. HAB",field:"cantidad"},{label:"Check-In",field:"checkin"},{label:"Check-out",field:"checkout"},{label:"#Noches",field:"noches"},{label:"Precio",field:"precio"},{label:"Descuento",field:"descuento"},{label:"Adicional",field:"adicional"},{label:"Observación",field:"observacion"},{label:"Subtotal",field:"subtotal"},{label:"",field:"action"}],selectedBooking:null,searchTerm:"",filteredOptions:[],bookingsOptions:[],bedroomOptions:[{value:"simple",label:"HAB. SIMPLE"},{value:"simple_ac",label:"HAB. SIMPLE (AC)"},{value:"matrimonial",label:"HAB. MATRIMONIAL"},{value:"matrimonial_ac",label:"HAB. MATRIMONIAL (AC)"},{value:"doble",label:"HAB. DOBLE"},{value:"doble_ac",label:"HAB. DOBLE (AC)"},{value:"triple",label:"HAB. TRIPLE"},{value:"triple_ac",label:"HAB. TRIPLE (AC)"},{value:"grupal",label:"HAB. GRUPAL"},{value:"grupal_ac",label:"HAB. GRUPAL (AC)"}],rows:[{item:"Headphone",qty:2,price:"$600.25",total:"$1200.50"},{item:"Headphone",qty:2,price:"$600.25",total:"$1200.50"},{item:"Headphone",qty:2,price:"$600.25",total:"$1200.50"},{item:"Headphone",qty:2,price:"$600.25",total:"$1200.50"}],selectedTours:[],columnsReservasAlojamiento:[{label:"Código",field:"codigo"},{label:"Nombre Hotel",field:"nombreHotel"},{label:"Detalle Hab.	",field:"detallehotel"},{label:"Action",field:"action"}]}},setup(t){const e=j(null);return q(()=>e.value,(i,r)=>{}),{modelValue:e}},methods:{handleSelectionChange(t){},handleCheckboxChange(t){const e=this.selectedTours.indexOf(t);e!==-1?this.selectedTours.splice(e,1):this.selectedTours.push(t),this.selectedTours=[...this.selectedTours],this.calculateTotalCobranza()},calculateTotalCobranza(){let t=0;this.tours.forEach((e,i)=>{const r=parseFloat(e.quantity),a=parseFloat(e.price_corporate);!isNaN(r)&&!isNaN(a)&&(this.tours[i].delegated_payment=r*a,this.selectedTours.includes(e.id)&&(t+=this.tours[i].delegated_payment))}),this.totalCobranza=t},handleGuardarTraspaso(){const t=y();if(!this.selectedTours||this.selectedTours.length===0){t.error("Debe seleccionar al menos un programa para poder registrar el traspaso");return}const e={agency_id:this.idTraspase,origintransfer_id:this.booking.tour_id.value,observations:this.booking.observations,total:this.totalCobranza,tours:this.selectedTours};_.post("https://thtsystemv2.tech/public/api/v1/bookings/create-traspase",e,f).then(i=>{t.success(i.data.message);const r=this.selectedTours.filter(n=>n!=null),a=this.tours.filter(n=>r.includes(n.id)).map(n=>n.delegated_payment).filter(n=>n!==null),g={ids:r,delegated_payments:a,booking_id:Number(this.idMega)};return _.post("https://thtsystemv2.tech/public/api/v1/bookings/update-delegated-payments",g,f)}).then(i=>{t.success("Pagos delegados actualizados correctamente")}).catch(i=>{console.error("Error:",i),t.error("Error al guardar el traspaso")})},filterOptions(){const t=this.searchTerm.toLowerCase();this.bookingsOptions&&(this.filteredOptions=this.bookingsOptions.filter(e=>e.label.toLowerCase().includes(t)))}},watch:{modelValue(t,e){},"booking.tour_id":function(t,e){this.idMega=t.value,_.get(`https://thtsystemv2.tech/public/api/v1/bookings/record-fortrasnfer/${t.value}`,f).then(i=>{this.tours=i.data.data.tours,this.tours.forEach(r=>{this.realizado=r.price_corporate}),this.booking.nro_pax=i.data.data.book.nro_pax,this.cellClient=i.data.data.book.client.cellphone,this.booking.reference_location=i.data.data.book.reference_location,this.tours.length===0&&y().error("Esta reserva no tiene Tour turísticos registrados")}).catch(i=>{console.error("Error al cargar el registro:",i)})},tours:{deep:!0,handler(t){this.calculateTotalCobranza()}}},created(){this.store=I();const t=this.$route.params.id,e=this.$route.params.fullname;this.fullNameAgency=e,this.idTraspase=t},mounted(){_.get("https://thtsystemv2.tech/public/api/v1/bookings/code-list",f).then(t=>{this.bookingsOptions=t.data.bookings.map(e=>({value:e.id,label:`${e.code}
${e.client}`})),this.bookingsOptions.length>0&&this.filterOptions()}).catch(t=>{console.error("Error al obtener las reservas:",t)}),_.get("https://thtsystemv2.tech/public/api/v1/agencies/list-formated",f).then(t=>{this.agencyOptions=t.data.agencies.map(e=>({value:e.id,label:`${e.firstName}
${e.document}`})),this.agencyOptions.length>0&&this.filterOptions()}).catch(t=>{console.error("Error al obtener las agencias:",t)})}},Y={class:"grid grid-cols-2 gap-0"},Z={class:"my-custom-design"},ee={class:"grid grid-cols-1 lg:grid-cols-1 gap-4"},te={class:"lg:col-span-1"},oe={class:"flex flex-col justify-center items-center h-full"},le={class:"text-2xl font-medium text-white mb-2 text-center"},ae={class:"block"},se={class:"list space-y-8"},ie={class:"flex space-x-3 rtl:space-x-reverse"},re={class:"flex-none text-2xl text-slate-600 dark:text-slate-300"},ne={class:"flex-1"},ce=o("div",{class:"uppercase text-xs text-slate-500 dark:text-slate-300 mb-1 leading-[12px]"}," N° paxs ",-1),de={href:"mailto:someone@example.com",class:"text-base text-slate-600 dark:text-slate-50"},ue={class:"flex space-x-3 rtl:space-x-reverse"},pe={class:"flex-none text-2xl text-slate-600 dark:text-slate-300"},he={class:"flex-1"},me=o("div",{class:"uppercase text-xs text-slate-500 dark:text-slate-300 mb-1 leading-[12px]"}," Cel ",-1),_e={href:"tel:0189749676767",class:"text-base text-slate-600 dark:text-slate-50"},be={class:"flex space-x-3 rtl:space-x-reverse"},fe={class:"flex-none text-2xl text-slate-600 dark:text-slate-300"},ge={class:"flex-1"},ve=o("div",{class:"uppercase text-xs text-slate-500 dark:text-slate-300 mb-1 leading-[12px]"}," Referencia ubicación ",-1),xe={class:"text-base text-slate-600 dark:text-slate-50"},ke={class:"grid grid-cols-1"},Te={class:"flex flex-col"},ye={key:0},Ce={class:"flex space-x-3 items-center text-left rtl:space-x-reverse"},Ae={key:1,class:"text-slate-500 dark:text-slate-400 block min-w-[208px]"},Ve={key:3,style:{"font-weight":"bold"}},we={key:4,class:"block w-full"},Oe={key:5},Be={key:6},He={key:7},ze={key:8},Ne={class:"mt-1 self-end"},Ee={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Se=o("div",{class:"lg:col-span-1"},null,-1),Ie={class:"lg:col-span-3 flex justify-end"};function Pe(t,e,i,r,a,g){const n=d("vSelect"),A=d("VueSelect"),k=d("FromGroup"),x=d("Icon"),v=d("Textinput"),V=d("Checkbox"),w=d("vue-good-table"),O=d("InputGroup"),T=d("Button"),B=d("Card");return u(),c("div",null,[s(B,{class:"mb-0",title:"Traspasar Reserva -  Datos Generales"},{default:b(()=>[o("div",Y,[s(k,{label:"Buscar Reserva"},{default:b(()=>[s(A,null,{default:b(()=>[s(n,{options:a.filteredOptions,modelValue:a.booking.tour_id,"onUpdate:modelValue":e[0]||(e[0]=l=>a.booking.tour_id=l)},null,8,["options","modelValue"])]),_:1})]),_:1}),o("div",Z,[o("div",ee,[o("div",te,[o("div",{class:"bg-no-repeat bg-cover bg-center p-5 rounded-[6px] relative",style:$({backgroundImage:"url("+a.widgetBg2+")",height:"100px"})},[o("div",oe,[o("div",null,[o("h4",le,[o("span",ae,[X("Agencia: "),o("strong",null,p(t.fullNameAgency),1)])])])])],4)])])]),o("ul",se,[o("li",ie,[o("div",re,[s(x,{icon:"heroicons:envelope"})]),o("div",ne,[ce,o("a",de,p(a.booking.nro_pax),1)])]),o("li",ue,[o("div",pe,[s(x,{icon:"heroicons:phone-arrow-up-right"})]),o("div",he,[me,o("a",_e,p(a.cellClient),1)])]),o("li",be,[o("div",fe,[s(x,{icon:"heroicons:map"})]),o("div",ge,[ve,o("div",xe,p(a.booking.reference_location),1)])])]),s(k,{label:"Observaciones"},{default:b(()=>[s(v,{modelValue:a.booking.observations,"onUpdate:modelValue":e[1]||(e[1]=l=>a.booking.observations=l),type:"text",placeholder:"Ingrese el número de teléfono fijo"},null,8,["modelValue"])]),_:1})]),o("div",ke,[o("div",Te,[s(w,{class:"-mx-6 mt-6 mb-5",columns:a.columnsTraspase,styleClass:" vgt-table  table-head   v-middle striped  listview",rows:this.tours,"pagination-options":{enabled:!1,perPage:a.perpage},"sort-options":{enabled:!1}},{"table-row":b(l=>[l.column.field=="abierto"?(u(),c("span",ye,[o("div",Ce,[s(V,{modelValue:a.selectedTours,"onUpdate:modelValue":e[2]||(e[2]=m=>a.selectedTours=m),onChange:m=>g.handleCheckboxChange(l.row.id)},null,8,["modelValue","onChange"])])])):h("",!0),l.column.field=="tour"?(u(),c("span",Ae,p(l.row.description),1)):h("",!0),l.column.field=="vehiculo"?(u(),c("span",{key:2,class:J({"text-yellow-500 font-bold":l.row.vehicle_tour===2,"text-blue-500 font-bold":l.row.vehicle_tour===1})},p(l.row.vehicle_tour===2?"Privado":"Compartido"),3)):h("",!0),l.column.field=="turno"?(u(),c("span",Ve,p(l.row.shift===1?"Full Day":l.row.shift===2?"Mañana":l.row.shift===3?"Tarde":"Noche"),1)):h("",!0),l.column.field=="pasajero"?(u(),c("span",we,p(l.row.quantity),1)):h("",!0),l.column.field=="fecha"?(u(),c("span",Oe,p(l.row.created_at),1)):h("",!0),l.column.field=="preciocorporativo"?(u(),c("span",Be,[s(v,{type:"text",placeholder:"Precio corporativo",modelValue:a.tours[l.index].price_corporate,"onUpdate:modelValue":m=>a.tours[l.index].price_corporate=m},null,8,["modelValue","onUpdate:modelValue"])])):h("",!0),l.column.field=="realizado"?(u(),c("span",He,[s(v,{type:"text",placeholder:"-",modelValue:a.realizado,"onUpdate:modelValue":e[3]||(e[3]=m=>a.realizado=m),disabled:""},null,8,["modelValue"])])):h("",!0),l.column.field=="cobranza"?(u(),c("span",ze,[s(v,{type:"text",placeholder:"-",modelValue:a.tours[l.index].delegated_payment,"onUpdate:modelValue":m=>a.tours[l.index].delegated_payment=m},null,8,["modelValue","onUpdate:modelValue"])])):h("",!0)]),_:1},8,["columns","rows","pagination-options"]),o("div",Ne,[s(O,{label:"T. TOURS S/. ",modelValue:a.totalCobranza,"onUpdate:modelValue":e[4]||(e[4]=l=>a.totalCobranza=l),class:"append",name:"hi_Fullname",type:"text",placeholder:"",horizontal:"",appendIcon:"heroicons-outline:cash",classInput:"text-right"},null,8,["modelValue"])])])]),o("div",Ee,[Se,o("div",Ie,[s(T,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[5]||(e[5]=l=>t.closeModal())}),s(T,{type:"submit",text:"Guardar Traspaso",btnClass:"btn-dark",onClick:g.handleGuardarTraspaso},null,8,["onClick"])])])]),_:1})])}const nt=Q(W,[["render",Pe]]);export{nt as default};
