import{I as ne}from"./index-BffMpWx5.js";/* empty css                                              */import{B as z}from"./index-CvW4wJPB.js";import{T as je}from"./Table-DeKGPd3l.js";import{C as se}from"./index-COOwjdNO.js";import{D as ie}from"./index-Bs_uOHMv.js";import{P as Ee}from"./index-DEP2tP3N.js";import{P as ae}from"./index-Dr9vJUyq.js";import{a as Ae}from"./basic-tablle-data-AN7MRnVF.js";import{u as ee}from"./project-BEvoPr6t.js";import{I as te}from"./index-2H-cusMd.js";import{u as le,b as G,s as T,y as F,z as be,c as k,o as h,d as v,e as n,g,f as s,k as u,w,A as W,B as I,t as $,q as x,h as de,D as ge,E as ve,F as pe,m as _e,l as D,p as fe,C as Me}from"./index-BFn_3Gdk.js";import{F as H}from"./index-z1TsTTdr.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as J}from"./index-BL9tae9R.js";import{C as ke}from"./index-JvTu2BQt.js";import{S as q}from"./index-BaZVwneS.js";import{M as re}from"./index-2mWc_vCg.js";import{C as xe}from"./VueSelect.vue_vue_type_style_index_0_lang-CworQ5tj.js";import{V as ye}from"./VueSelect-QFU_7fbT.js";import{b as ue}from"./menu-BIf-sRSE.js";import{q as Se}from"./vue-tailwind-datepicker-CG1Mmuub.js";import{G as Ie}from"./Projects-grid-D3-YVNtE.js";import"./user-1-Dmhlt7-s.js";import"./user-4-_9lLfOE2.js";import"./user-6-Bk4CTUVR.js";import"./av-2-D6_jNZbn.js";import"./v4-D8aEg3BZ.js";import"./vue-cleave.min-ClV1fVcS.js";/* empty css                                              */import"./transition-DUAAdbaG.js";import"./focus-management-C7_eiYjk.js";import"./keyboard-CmTzE63w.js";import"./use-outside-click-RVZZ1L_X.js";import"./hidden-Br4jqfTk.js";import"./micro-task-CxIZtCgj.js";import"./open-closed-Bo1bAx4t.js";import"./use-resolve-button-type-0pot5Y2u.js";const Ue={name:"client_form",id:"client_form",autocomplete:"off",class:"mx-auto space-y-4"},Pe={class:"grid grid-cols-3 lg:grid-cols-3 gap-4"},Te={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Be={class:"lg:col-span-3"},He=s("div",{class:"lg:hidden"},null,-1),Oe={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Re={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ne={class:"lg:col-span-3"},Le=s("div",{class:"lg:hidden"},null,-1),qe={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Fe={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},$e={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Ge=s("div",{class:"lg:col-span-1"},null,-1),ze={class:"lg:col-span-3 flex justify-end"},Ve={__name:"ClientAddModal",props:{activeModal:Boolean},emits:["close","updateClientList"],setup(e,{emit:l}){ee();const d=le().headers(),_=G(),t=e,p=l,M=()=>{p("close")},a=T([]),V=T([]),A=T([]),E=async()=>{try{const y=await I.get("https://thtsystemv2.tech/public/api/v1/ubigeo/departments",d);a.value=y.data.data.map(c=>({value:c.id,label:c.name}))}catch(y){console.error("Error fetching departments:",y)}},f=[{value:1,label:"Natural"},{value:2,label:"Jurídico"}],U=[{value:1,label:"DNI"},{value:2,label:"RUC"},{value:3,label:"PASAPORTE"}],B=[{id:1,label:"Soltero"},{id:2,label:"Casado"},{id:2,label:"Viudo"},{id:2,label:"Divorciado"}],j=[{id:1,label:"Masculino"},{id:2,label:"Femenino"}],m=T({typedocument_id:"",department_id:"",province_id:"",district_id:"",type_client:"",fullname:"",document:"",tradename:"",address:"",email:"",telephone:"",cellphone:"",date_birthday:"",sex:"",status:"",typeDocument:""}),O=T(f[0].value),b=T(U[0].value);let o=T(null),i=T(null),R=T(null),N=T(null),L=T(null);const S=()=>{const y=document.querySelector(".typecliente-select select");if(y){const C=y.selectedIndex,r=C.toString();y.options[C].text,m.value.type_client=r}const c=document.querySelector(".typedocument-select select");if(y){const C=c.selectedIndex,r=c.options[C].text;m.value.typedocument_id=C,m.value.typeDocument=r}I.post("https://thtsystemv2.tech/public/api/v1/clients/create",m.value,{...d}).then(C=>{p("updateClientList",C.data),M(),_.success(C.data.message)}).catch(C=>{console.error("Error al guardar los datos:",C)})},K=()=>{I.post("https://thtsystemv2.tech/public/api/v1/getDniData",{dni:m.value.document}).then(y=>{m.value.fullname=y.data.data.nombre_completo}).catch(y=>{console.error("Error al obtener datos del DNI:",y)})},Z=async()=>{try{const y=await I.get(`https://thtsystemv2.tech/public/api/v1/ubigeo/provinces/${m.value.department_id}`,d);A.value=y.data.data.map(c=>({value:c.id,label:c.name}))}catch(y){console.error("Error fetching provinces:",y)}},P=async()=>{try{const y=await I.get(`https://thtsystemv2.tech/public/api/v1/ubigeo/districts/${m.value.province_id}`,d);V.value=y.data.data.map(c=>({value:c.id,label:c.name}))}catch(y){console.error("Error fetching provinces:",y)}};F(()=>L.value,(y,c)=>{const C=document.querySelector(".sexo-select select");if(C){const r=C.selectedIndex,Y=C.options[r].text;m.value.sex=Y}}),F(()=>N.value,(y,c)=>{const C=document.querySelector(".state-select select");if(C){const r=C.selectedIndex,Y=C.options[r].text;m.value.status=Y}}),F(()=>R.value,(y,c)=>{if(document.querySelector(".district-select select")){const r=y.toString().padStart(6,"0");m.value.district_id=r}}),F(()=>i.value,(y,c)=>{if(document.querySelector(".province-select select")){const r=y.toString().padStart(4,"0");m.value.province_id=r}}),F(()=>o.value,(y,c)=>{if(document.querySelector(".department-select select")){const r=y.toString().padStart(2,"0");m.value.department_id=r}});const me=T("N° DNI"),he=T("RENIEC");return F(()=>b.value,y=>{const c=document.querySelector(".typedocument-select select");if(c){const C=c.selectedIndex,r=c.options[C],Y=c.options[C].text;m.value.typedocument_id=C,m.value.typeDocument=Y,me.value=`N° ${r.textContent}`,he.value=y==="1"?"RENIEC":y==="2"?"SUNAT":"Validar"}}),F(()=>O.value,(y,c)=>{const C=document.querySelector(".typecliente-select select");if(C){const r=C.selectedIndex,Y=r.toString();C.options[r].text,m.value.type_client=Y}}),be(()=>{E()}),(y,c)=>{const C=k("flat-pickr");return h(),v("div",null,[n(u(re),{activeModal:t.activeModal,onClose:M,title:"Registrar nuevo Cliente",sizeClass:"max-w-4xl",centered:""},{default:g(()=>[s("form",Ue,[s("div",Pe,[s("div",null,[n(u(H),{label:"Tipo de cliente"},{default:g(()=>[n(u(q),{options:f,modelValue:O.value,"onUpdate:modelValue":c[0]||(c[0]=r=>O.value=r),class:"typecliente-select",placeholder:"Seleccione Cliente"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(u(H),{label:"Tipo documento"},{default:g(()=>[n(u(q),{options:U,modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=r=>b.value=r),class:"typedocument-select"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(u(H),{label:"N° Documento"},{default:g(()=>[n(u(te),{type:"text",placeholder:me.value,modelValue:m.value.document,"onUpdate:modelValue":c[2]||(c[2]=r=>m.value.document=r)},{append:g(()=>[n(u(z),{text:he.value,btnClass:"btn-outline-dark",onClick:w(K,["prevent"])},null,8,["text"])]),_:1},8,["placeholder","modelValue"])]),_:1})])]),s("div",Te,[s("div",Be,[n(u(H),{label:"Nombre ó Razón Social"},{default:g(()=>[n(u(J),{type:"text",id:"client_fullname",modelValue:m.value.fullname,"onUpdate:modelValue":c[3]||(c[3]=r=>m.value.fullname=r),modelModifiers:{trim:!0},placeholder:"Ingrese Nombre ó Razón Social "},null,8,["modelValue"])]),_:1})]),He]),s("div",Oe,[s("div",null,[n(u(H),null,{default:g(()=>[n(u(q),{options:a.value,label:"Departamento",modelValue:u(o),"onUpdate:modelValue":c[4]||(c[4]=r=>W(o)?o.value=r:o=r),class:"department-select",onChange:Z},null,8,["options","modelValue"])]),_:1})]),s("div",null,[n(u(H),null,{default:g(()=>[n(u(q),{options:A.value,label:"Provincias",modelValue:u(i),"onUpdate:modelValue":c[5]||(c[5]=r=>W(i)?i.value=r:i=r),class:"province-select",onChange:P,placeholder:""},null,8,["options","modelValue"])]),_:1})]),s("div",null,[n(u(H),null,{default:g(()=>[n(u(q),{options:V.value,label:"Distritos",modelValue:u(R),"onUpdate:modelValue":c[6]||(c[6]=r=>W(R)?R.value=r:R=r),class:"district-select",placeholder:""},null,8,["options","modelValue"])]),_:1})])]),s("div",Re,[s("div",Ne,[n(u(H),{label:"Dirección"},{default:g(()=>[n(u(J),{type:"text",modelValue:m.value.address,"onUpdate:modelValue":c[7]||(c[7]=r=>m.value.address=r),modelModifiers:{trim:!0},placeholder:"Ingrese Direción"},null,8,["modelValue"])]),_:1})]),Le]),s("div",qe,[s("div",null,[n(u(H),{label:"Celular"},{default:g(()=>[n(u(J),{type:"text",modelValue:m.value.cellphone,"onUpdate:modelValue":c[8]||(c[8]=r=>m.value.cellphone=r),modelModifiers:{trim:!0},placeholder:"Ingrese N° de celular"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(u(H),{label:"Teléfono fijo"},{default:g(()=>[n(u(J),{type:"text",modelValue:m.value.telephone,"onUpdate:modelValue":c[9]||(c[9]=r=>m.value.telephone=r),modelModifiers:{trim:!0},placeholder:"Ingrese N° de telefono fijo"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(u(H),{label:"Correo electrónico"},{default:g(()=>[n(u(J),{type:"email",modelValue:m.value.email,"onUpdate:modelValue":c[10]||(c[10]=r=>m.value.email=r),modelModifiers:{trim:!0},placeholder:"Ingrese correo electrónico"},null,8,["modelValue"])]),_:1})])]),s("div",Fe,[s("div",null,[n(u(H),{label:"Fecha de nacimiento"},{default:g(()=>[n(C,{modelValue:m.value.date_birthday,"onUpdate:modelValue":c[11]||(c[11]=r=>m.value.date_birthday=r),class:"form-control",id:"date_birthday",placeholder:"yyyy, dd M",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"}},null,8,["modelValue"])]),_:1})]),s("div",null,[n(u(H),null,{default:g(()=>[n(u(q),{options:B,label:"Estado",modelValue:u(N),"onUpdate:modelValue":c[12]||(c[12]=r=>W(N)?N.value=r:N=r),class:"state-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(u(H),null,{default:g(()=>[n(u(q),{options:j,label:"Sexo",modelValue:u(L),"onUpdate:modelValue":c[13]||(c[13]=r=>W(L)?L.value=r:L=r),class:"sexo-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})])]),s("div",$e,[Ge,s("div",ze,[n(u(z),{text:"Cancelar",btnClass:"btn-light mr-2",onClick:w(M,["prevent"])}),n(u(z),{type:"submit",text:"Guardar Cambios",btnClass:"btn-dark",onClick:w(S,["prevent"])})])])])]),_:1},8,["activeModal"])])}}},X=le().headers(),we={components:{Dropdown:ie,Select:q,Button:z,FromGroup:H,EditProject:Ve,Textinput:J,Modal:re,Checkbox:ke,InputGroup:te,vSelect:xe,Icon:ne,VueSelect:ye,MenuItem:ue,Card:se,ProgressBar:ae},data(){return{idBookingg:null,searchTerm:"",tellephonAndCellphone:"",selectedAsignHotel:!1,selectedHotel:!1,showEditModal:!1,store:ee(),bookingsOptions:[],customerOptions:[],hotelOptions:[],projects:[],actions:[{name:"edit",icon:"heroicons:pencil-square",doit:e=>{this.openModalEdit(e)}},{name:"delete",icon:"heroicons-outline:trash",doit:e=>{this.removeProject(e)}}],columnsReservaHotelExpense:[{label:"Habitacion",field:"habitacion"},{label:"Hotel",field:"hotel"},{label:"N° PAX	",field:"pasajeross"},{label:"Cant. HAB",field:"cantidad"},{label:"Check-In",field:"checkin"},{label:"Check-out",field:"checkout"},{label:"#Noches",field:"noches"},{label:"Precio",field:"precio"},{label:"Descuento",field:"descuento"},{label:"Adicional",field:"adicional"},{label:"Observación",field:"observacion"},{label:"Subtotal",field:"subtotal"},{label:"",field:"action"}],id:null,bookinghotel:{id:null,hotel_id:null,booking_id_number:null,client_id_number:null,booking_id:null,client_id:null,collaborator_id:null,code:null,correlative:null,reference_voucher:null,is_external:null,total:null,observation:null,created_at:null,updated_at:null,deleted_at:null,hotel_description:null,client_fullname:null,client_document:null,client_cellphone:null,client_telephone:null},bedroomOptions:[{value:1,label:"HAB. SIMPLE"},{value:2,label:"HAB. SIMPLE (AC)"},{value:3,label:"HAB. MATRIMONIAL"},{value:4,label:"HAB. MATRIMONIAL (AC)"},{value:5,label:"HAB. DOBLE"},{value:6,label:"HAB. DOBLE (AC)"},{value:7,label:"HAB. TRIPLE"},{value:8,label:"HAB. TRIPLE (AC)"},{value:9,label:"HAB. GRUPAL"},{value:10,label:"HAB. GRUPAL (AC)"}]}},props:{activeModal:Boolean,code:String,idCliente:String,idBooking:String,clientData:Object},emits:["close"],created(){this.fetchHotels(),this.fetchClients(),this.fetchBookings(),console.log(this.clientData)},watch:{selectedAsignHotel(e,l){if(e!==l){const d=this.projects.findIndex(_=>_.id===e);d===-1?I.get(`https://thtsystemv2.tech/public/api/v1/typebedrooms/description/${e}`,X).then(_=>{const t={typebedroom_id:e,description:_.data.data};this.projects.push(t),console.log(this.projects),this.calculateTotal(this.projects.length-1)}):I.get(`https://thtsystemv2.tech/public/api/v1/typebedrooms/description/${e}`,X).then(_=>{this.projects[d].description=_.data.data,this.calculateTotal(d)})}},"bookinghotel.client_id"(e){if(e){const{value:l,label:d}=e;console.log(`Nuevo cliente seleccionado: ${l}, ${d}`),l!==void 0?(this.bookinghotel.client_id_number=l,this.fetchContactNumbers(l)):this.fetchContactNumbers(this.bookinghotel.client_id_number)}else this.bookinghotel.client_id_number=null},projects:{deep:!0,handler(e,l){this.calculateTotalForAllProjects()}},code:function(e,l){this.bookinghotel.booking_id=e},idCliente:function(e,l){this.fetchClients(),this.bookinghotel.client_id=e},idBooking:function(e,l){this.idBookingg=e},clientData:{handler(e){var t,p,M,a,V,A,E,f,U,B;this.id=(e==null?void 0:e.id)!==void 0?e==null?void 0:e.id:"",console.log(this.id);const l=(t=e==null?void 0:e.booking_data)==null?void 0:t.code,_=`${(p=e==null?void 0:e.client_data)==null?void 0:p.fullname}-${l}`;this.bookinghotel.booking_id=_,this.bookinghotel.booking_id_number=((M=e==null?void 0:e.booking_data)==null?void 0:M.id)!==void 0?(a=e==null?void 0:e.booking_data)==null?void 0:a.id:"",this.bookinghotel.client_id_number=((V=e==null?void 0:e.client_data)==null?void 0:V.id)!==void 0?(A=e==null?void 0:e.client_data)==null?void 0:A.id:"",this.bookinghotel.client_id=((E=e==null?void 0:e.client_data)==null?void 0:E.fullname)!==void 0?(f=e==null?void 0:e.client_data)==null?void 0:f.fullname:"",this.bookinghotel.hotel_id=((U=e==null?void 0:e.hotel_data)==null?void 0:U.id)!==void 0?(B=e==null?void 0:e.hotel_data)==null?void 0:B.id:"",this.bookinghotel.reference_voucher=(e==null?void 0:e.reference_voucher)!==null?e==null?void 0:e.reference_voucher:"",this.bookinghotel.observation=(e==null?void 0:e.observation)!==null?e==null?void 0:e.observation:"",this.bookinghotel.total=(e==null?void 0:e.total)!==null?parseFloat(e==null?void 0:e.total).toFixed(2):"",e!=null&&e.detailbedrooms_data?this.projects=e.detailbedrooms_data.map(j=>({hotelsbooking_id:j.hotelsbooking_id??null,typebedroom_id:j.typebedroom_id===null?j.id:j.typebedroom_id,date_checkin:j.date_checkin??null,date_checkout:j.date_checkout??null,quantity:j.quantity??null,hotel:j.hotel_id??null,guests:j.guests??null,nights:j.nights??null,price:j.price??null,description:j.typebedroom??null,additional:j.additional??null,discount:j.discount??null,observation:j.observation??null})):this.projects=[],console.log("Id Booking ",this.bookinghotel.booking_id_number),console.log("Id Cliente ",this.bookinghotel.client_id_number)},immediate:!0,deep:!0},"bookinghotel.booking_id"(e,l){if(e){const{value:d,label:_}=e;this.bookinghotel.booking_id_number=d,console.log(`Booking ID Number set to ${d} from selected booking with label: ${_}`)}else this.bookinghotel.booking_id_number=null}},methods:{closeEditModal(){this.$emit("close")},updateNights(e){const l=new Date(this.projects[e].date_checkin),_=new Date(this.projects[e].date_checkout).getTime()-l.getTime(),t=Math.ceil(_/(1e3*3600*24));this.projects[e].nights=t},async fetchContactNumbers(e){try{const l=await I.get(`https://thtsystemv2.tech/public/api/v1/clients/cellphone&telephone/${e}`,X);this.tellephonAndCellphone=l.data.contact_numbers}catch(l){console.error("Error al obtener los números de contacto:",l)}},calculateTotalForAllProjects(){let e=0;this.projects.forEach(l=>{const d=l.price||0,_=l.nights||0,t=l.quantity||1;l.subtotal=d*_*t,e+=d*_*t}),this.bookinghotel.total=e},calculateTotal(e){const l=this.projects[e],d=l.price||0,_=l.nights||0,t=l.quantity||1;l.total=d*_*t,this.calculateTotalForAllProjects()},saveReservaHotel(){const e={hotel_id:this.bookinghotel.hotel_id,client_id:this.bookinghotel.client_id_number,booking_id:this.bookinghotel.booking_id_number,collaborator_id:this.bookinghotel.collaborator_id,code:this.bookinghotel.code,correlative:this.bookinghotel.correlative,reference_voucher:this.bookinghotel.reference_voucher,is_external:this.bookinghotel.is_external,observation:this.bookinghotel.observation,total:this.bookinghotel.total,detailbedrooms:this.projects.map(l=>({typebedroom_id:l.typebedroom_id===null?l.id:l.typebedroom_id,date_checkin:l.date_checkin,date_checkout:l.date_checkout,quantity:l.quantity,guests:l.guests,hotel_id:l.hotel,nights:l.nights,price:l.price,additional:l.additional,discount:l.discount,observation:l.observation}))};console.log(e),I.post(`https://thtsystemv2.tech/public/api/v1/hotelsbookings/update/${this.id}`,e,{...X}).then(l=>{this.$emit("postComplete",l.data);const d=G();this.closeEditModal(),d.success(l.data.message)}).catch(l=>{console.error("Error al enviar los datos al backend:",l)})},openModal(){this.showEditModal=!0},deleteProject(e){this.projects.splice(e,1)},async fetchHotels(){try{const e=await I.get("https://thtsystemv2.tech/public/api/v1/hotels/list",X);this.hotelOptions=e.data.data.map(l=>({value:l.id,label:l.tradename}))}catch(e){console.error("Error al obtener los datos de los colaboradores:",e)}},async fetchClients(){try{const e=await I.get("https://thtsystemv2.tech/public/api/v1/clients/list",X);this.customerOptions=e.data.data.map(l=>({value:l.id,label:l.fullname}))}catch(e){console.error("Error fetching departments:",e)}},async fetchBookings(){try{const e=await I.get("https://thtsystemv2.tech/public/api/v1/hotelsbookings/list-vselect",X);console.log(e),this.bookingsOptions=e.data.map(l=>({value:l.id,label:l.client_booking_info}))}catch(e){console.error("Error fetching departments:",e)}}},computed:{limitedCustomerOptions(){return this.customerOptions.slice(0,6)}}},Ye=e=>(ge("data-v-37b0ac36"),e=e(),ve(),e),Xe={name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4"},Je={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Qe={class:"flex items-center"},We={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ke={class:"flex items-center"},Ze={class:"flex-grow mr-2"},De={class:"grid grid-cols-1"},et={class:"flex flex-col"},tt={key:0},lt={class:"flex space-x-3 items-center text-left rtl:space-x-reverse"},ot={key:1},nt={key:2,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},st={key:3,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},it={key:4,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},at={key:5,class:"block w-full"},dt={key:6},ct={key:7},rt={key:8},ut={key:9},mt={key:10},ht={key:11},pt={key:12,class:"action-btn text-end mr-3"},_t=["onClick"],bt={class:"mt-5 self-end"},gt={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},vt=Ye(()=>s("div",{class:"lg:col-span-1"},null,-1)),ft={class:"lg:col-span-3 flex justify-end"};function kt(e,l,d,_,t,p){const M=k("vSelect"),a=k("VueSelect"),V=k("FromGroup"),A=k("InputGroup"),E=k("Select"),f=k("Textinput"),U=k("flat-pickr"),B=k("Icon"),j=k("vue-good-table"),m=k("Button"),O=k("EditProject"),b=k("Modal");return h(),v("div",null,[n(b,{title:"Editar reserva de hotel",label:"Modal title",activeModal:d.activeModal,onClose:p.closeEditModal,sizeClass:"max-w-8xl"},{default:g(()=>[s("form",Xe,[s("div",Je,[s("div",null,[n(V,{label:"Reserva"},{default:g(()=>[n(a,null,{default:g(()=>[n(M,{options:t.bookingsOptions,modelValue:t.bookinghotel.booking_id,"onUpdate:modelValue":l[0]||(l[0]=o=>t.bookinghotel.booking_id=o),placeholder:"Reserva"},null,8,["options","modelValue"])]),_:1})]),_:1})]),s("div",null,[s("div",Qe,[n(V,{label:"Cliente Responsable",class:"flex-1"},{default:g(()=>[n(a,null,{default:g(()=>[n(M,{options:t.customerOptions,modelValue:t.bookinghotel.client_id,"onUpdate:modelValue":l[1]||(l[1]=o=>t.bookinghotel.client_id=o)},null,8,["options","modelValue"])]),_:1})]),_:1})])]),s("div",null,[n(V,{label:"Número teléfono"},{default:g(()=>[n(A,{type:"tel",modelValue:t.tellephonAndCellphone,"onUpdate:modelValue":l[2]||(l[2]=o=>t.tellephonAndCellphone=o),placeholder:"Número de teléfono"},null,8,["modelValue"])]),_:1})])]),s("div",We,[s("div",null,[n(V,{label:"Asignar habitación"},{default:g(()=>[s("div",Ke,[s("div",Ze,[n(E,{options:t.bedroomOptions,modelValue:t.selectedAsignHotel,"onUpdate:modelValue":l[3]||(l[3]=o=>t.selectedAsignHotel=o),placeholder:"Seleccionar Hotel",class:"w-full"},null,8,["options","modelValue"])])])]),_:1})]),s("div",null,[n(V,{label:"N° ref. comprobante"},{default:g(()=>[n(f,{type:"text",modelValue:t.bookinghotel.reference_voucher,"onUpdate:modelValue":l[4]||(l[4]=o=>t.bookinghotel.reference_voucher=o),placeholder:"Número de referencia del comprobante"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(V,{label:"Observaciones"},{default:g(()=>[n(f,{type:"text",modelValue:t.bookinghotel.observation,"onUpdate:modelValue":l[5]||(l[5]=o=>t.bookinghotel.observation=o),placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),s("div",De,[s("div",et,[n(j,{class:"-mx-6 mb-5",columns:t.columnsReservaHotelExpense,styleClass:" vgt-table  table-head   v-middle striped lesspadding2 listview",rows:this.projects,"sort-options":{enabled:!1}},{"table-row":g(o=>[o.column.field=="habitacion"?(h(),v("span",tt,[s("div",lt,$(o.row.description),1)])):x("",!0),o.column.field=="pasajeross"?(h(),v("span",ot,[n(f,{type:"text",placeholder:"N° pax",modelValue:t.projects[o.index].guests,"onUpdate:modelValue":i=>t.projects[o.index].guests=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="cantidad"?(h(),v("span",nt,[n(f,{type:"text",placeholder:"Cant. HAB",modelValue:t.projects[o.index].quantity,"onUpdate:modelValue":i=>t.projects[o.index].quantity=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="checkin"?(h(),v("span",st,[n(U,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:t.projects[o.index].date_checkin,"onUpdate:modelValue":i=>t.projects[o.index].date_checkin=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="hotel"?(h(),v("span",it,[n(E,{options:t.hotelOptions,modelValue:t.projects[o.index].hotel,"onUpdate:modelValue":i=>t.projects[o.index].hotel=i},null,8,["options","modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="checkout"?(h(),v("span",at,[n(U,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:t.projects[o.index].date_checkout,"onUpdate:modelValue":i=>t.projects[o.index].date_checkout=i,onChange:i=>p.updateNights(o.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):x("",!0),o.column.field=="noches"?(h(),v("span",dt,[n(f,{type:"text",placeholder:"#Noches",modelValue:t.projects[o.index].nights,"onUpdate:modelValue":i=>t.projects[o.index].nights=i,onChange:i=>p.calculateTotal(o.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):x("",!0),o.column.field=="precio"?(h(),v("span",ct,[n(f,{type:"text",placeholder:"Precio",modelValue:t.projects[o.index].price,"onUpdate:modelValue":i=>t.projects[o.index].price=i,onChange:i=>p.calculateTotal(o.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):x("",!0),o.column.field=="descuento"?(h(),v("span",rt,[n(f,{type:"text",placeholder:"Descuento",modelValue:t.projects[o.index].discount,"onUpdate:modelValue":i=>t.projects[o.index].discount=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),de(),o.column.field=="adicional"?(h(),v("span",ut,[n(f,{type:"text",placeholder:"Adicional",modelValue:t.projects[o.index].additional,"onUpdate:modelValue":i=>t.projects[o.index].additional=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="observacion"?(h(),v("span",mt,[n(f,{type:"text",placeholder:"Observacion",modelValue:t.projects[o.index].observation,"onUpdate:modelValue":i=>t.projects[o.index].observation=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="subtotal"?(h(),v("span",ht,[n(f,{type:"text",placeholder:"Subtotal",modelValue:t.projects[o.index].subtotal,"onUpdate:modelValue":i=>t.projects[o.index].subtotal=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="action"?(h(),v("div",pt,[s("div",{class:"text-xl",onClick:i=>p.deleteProject(o.index)},[n(B,{icon:"heroicons-outline:trash",class:"text-danger-500"})],8,_t)])):x("",!0)]),_:1},8,["columns","rows"]),s("div",bt,[n(A,{label:"T. RESERVA S/.",class:"append",name:"hi_Fullname",type:"number",placeholder:"",modelValue:t.bookinghotel.total,"onUpdate:modelValue":l[6]||(l[6]=o=>t.bookinghotel.total=o),horizontal:"",appendIcon:"heroicons-outline:cash",classInput:"text-right"},null,8,["modelValue"])])])]),s("div",gt,[vt,s("div",ft,[n(m,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:l[7]||(l[7]=w(o=>p.closeEditModal(),["prevent"]))}),n(m,{type:"submit",text:"Guardar Reserva",btnClass:"btn-dark",onClick:l[8]||(l[8]=w(o=>p.saveReservaHotel(),["prevent"]))})])])]),n(O,{activeModal:t.showEditModal,onClose:l[9]||(l[9]=o=>t.showEditModal=!1),title:"Actualizar Registro de Colaborador",onUpdateClientList:p.fetchClients},null,8,["activeModal","onUpdateClientList"])]),_:1},8,["activeModal","onClose"])])}const Ce=ce(we,[["render",kt],["__scopeId","data-v-37b0ac36"]]),oe=le().headers(),xt={components:{InputGroup:te,Button:z,Pagination:Ee,VueTailwindDatePicker:Se,Dropdown:ie,Icon:ne,MenuItem:ue,EditProject:Ce,Card:se,ProgressBar:ae},data(){const e=new Date,d=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0]+" 00:00:00",t=new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]+" 23:59:59";return{searchTerm:"",clientData:{},showEditModal:!1,advancedTable:Ae,current:1,perpage:10,dateValue:{startDate:d,endDate:t},pageRange:10,actions:[{name:"edit",icon:"heroicons:pencil-square",doit:p=>{console.log(p),this.clientData=p,this.showEditModal=!0}},{name:"delete",icon:"heroicons-outline:trash",doit:async p=>{try{await I.delete(`https://thtsystemv2.tech/public/api/v1/clients/delete/${p.id}`,oe),G().success("Cliente eliminado correctamente",{timeout:1500}),this.listarHoteles()}catch(M){console.error("Error al eliminar empleado:",M)}}}],columns:[{label:"Codigo",field:"code"},{label:"Nombre Hotel",field:"hotel_data.tradename"},{label:"Reponsable",field:"client_data.fullname"},{label:"Comprobante",field:"reference_voucher"},{label:"Reserva Asociada",field:"booking_data.code"},{label:"Total ",field:"total"},{label:"Action",field:"action"}],projects:[]}},methods:{async reloadCrmTable(){try{await this.listarClientes()}catch(e){console.error("Error al recargar Clientes :",e)}},async listarClientes(){try{const e={start_date:this.dateValue.startDate,end_date:this.dateValue.endDate},d=(await I.get("https://thtsystemv2.tech/public/api/v1/hotelsbookings/list-all",{...oe,params:e})).data.results;this.projects=d.map(t=>{var p,M,a,V,A,E,f,U,B,j,m,O,b,o,i,R,N,L;return{id:t.id??null,hotel_id:((p=t.hotel_data)==null?void 0:p.id)??null,booking_id:t.booking_id??null,client_id:((M=t.client_data)==null?void 0:M.id)??null,collaborator_id:t.collaborator_id??null,code:t.code??null,total:t.total??null,correlative:t.correlative??null,reference_voucher:t.reference_voucher??null,is_external:t.is_external??null,observation:t.observation??null,created_at:t.created_at??null,updated_at:t.updated_at??null,deleted_at:t.deleted_at??null,hotel_description:t.hotel_description??null,client_fullname:t.client_fullname??null,client_document:t.client_document??null,client_cellphone:t.client_cellphone??null,client_telephone:t.client_telephone??null,hotel_data:{id:((a=t.hotel_data)==null?void 0:a.id)??null,tourismcitie_id:((V=t.hotel_data)==null?void 0:V.tourismcitie_id)??null,tradename:((A=t.hotel_data)==null?void 0:A.tradename)??null,document:((E=t.hotel_data)==null?void 0:E.document)??null,fullname:((f=t.hotel_data)==null?void 0:f.fullname)??null},client_data:{id:((U=t.client_data)==null?void 0:U.id)??null,typedocument_id:((B=t.client_data)==null?void 0:B.typedocument_id)??null,type_client:((j=t.client_data)==null?void 0:j.type_client)??null,fullname:((m=t.client_data)==null?void 0:m.fullname)??null,document:((O=t.client_data)==null?void 0:O.document)??null},booking_data:{id:((b=t.booking_data)==null?void 0:b.id)??null,type_booking:((o=t.booking_data)==null?void 0:o.type_booking)??null,user_id:((i=t.booking_data)==null?void 0:i.user_id)??null,code:((R=t.booking_data)==null?void 0:R.code)??null},detailbedrooms_data:((N=t.detailbedrooms_data)==null?void 0:N.map(S=>({id:S.id??null,hotelsbooking_id:S.hotelsbooking_id??null,typebedroom_id:S.typebedroom_id??null,date_checkin:S.date_checkin??null,date_checkout:S.date_checkout??null,quantity:S.quantity??null,guests:S.guests??null,nights:S.nights??null,hotel_id:S.hotel_id??null,price:S.price??null,additional:S.additional??null,discount:S.discount??null,observation:S.observation??null,typebedroom:S.typebedroom??null})))??[],detailbedrooms_paid_data:((L=t.detailbedrooms_paid_data)==null?void 0:L.map(S=>({id:S.id??null})))??[]}}),console.log(this.projects),G().success("Reservas de hotel listadas correctamente",{timeout:1500})}catch(e){console.error("Error al obtener los datos de los empleados:",e)}}},watch:{dateValue(e,l){if(!e.startDate||!e.endDate)this.advancedTable=[];else{const d=e.startDate.split(" ")[0],_=e.endDate.split(" ")[0];I.get(`https://thtsystemv2.tech/public/api/v1/hotelsbookings/list-all?start_date=${d}&end_date=${_}`,oe).then(t=>{const p=t.data.results;this.projects=p.map(a=>{var V,A,E,f,U,B,j,m,O,b,o,i,R,N,L,S,K,Z;return{id:a.id??null,hotel_id:((V=a.hotel_data)==null?void 0:V.id)??null,booking_id:a.booking_id??null,client_id:((A=a.client_data)==null?void 0:A.id)??null,collaborator_id:a.collaborator_id??null,code:a.code??null,total:a.total??null,correlative:a.correlative??null,reference_voucher:a.reference_voucher??null,is_external:a.is_external??null,observation:a.observation??null,created_at:a.created_at??null,updated_at:a.updated_at??null,deleted_at:a.deleted_at??null,hotel_description:a.hotel_description??null,client_fullname:a.client_fullname??null,client_document:a.client_document??null,client_cellphone:a.client_cellphone??null,client_telephone:a.client_telephone??null,hotel_data:{id:((E=a.hotel_data)==null?void 0:E.id)??null,tourismcitie_id:((f=a.hotel_data)==null?void 0:f.tourismcitie_id)??null,tradename:((U=a.hotel_data)==null?void 0:U.tradename)??null,document:((B=a.hotel_data)==null?void 0:B.document)??null,fullname:((j=a.hotel_data)==null?void 0:j.fullname)??null},client_data:{id:((m=a.client_data)==null?void 0:m.id)??null,typedocument_id:((O=a.client_data)==null?void 0:O.typedocument_id)??null,type_client:((b=a.client_data)==null?void 0:b.type_client)??null,fullname:((o=a.client_data)==null?void 0:o.fullname)??null,document:((i=a.client_data)==null?void 0:i.document)??null},booking_data:{id:((R=a.booking_data)==null?void 0:R.id)??null,type_booking:((N=a.booking_data)==null?void 0:N.type_booking)??null,user_id:((L=a.booking_data)==null?void 0:L.user_id)??null,code:((S=a.booking_data)==null?void 0:S.code)??null},detailbedrooms_data:((K=a.detailbedrooms_data)==null?void 0:K.map(P=>({id:P.id??null,hotelsbooking_id:P.hotelsbooking_id??null,typebedroom_id:P.typebedroom_id??null,date_checkin:P.date_checkin??null,date_checkout:P.date_checkout??null,quantity:P.quantity??null,guests:P.guests??null,nights:P.nights??null,price:P.price??null,additional:P.additional??null,discount:P.discount??null,observation:P.observation??null,typebedroom:P.typebedroom??null})))??[],detailbedrooms_paid_data:((Z=a.detailbedrooms_paid_data)==null?void 0:Z.map(P=>({id:P.id??null})))??[]}}),console.log(this.projects),G().success("Reservas de hotel listadas correctamente",{timeout:1500})}).catch(t=>{console.error(t),t.response&&t.response.status===404?G().info("No se encontraron reservas dentro del rango de fechas proporcionado."):G().error("Ocurrió un error al obtener las reservas."),this.advancedTable=[]})}}},mounted(){this.listarClientes()}},yt={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},Vt=s("h5",null,"Todos las Reservas de Hotel",-1),Ct={class:"flex items-center space-x-3"},jt={class:"w-[370px]"},Et={key:0},At={class:"flex space-x-3 items-center text-left rtl:space-x-reverse"},Mt={class:"flex-none"},St={class:"h-10 w-10 rounded-full text-sm bg-[#E0EAFF] dark:bg-slate-700 flex flex-col items-center justify-center font-medium -tracking-[1px]"},It={class:"flex-1 font-medium text-sm leading-4 whitespace-nowrap"},Ut={key:1,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},Pt={key:2,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},Tt={key:3,class:"block w-full"},Bt={class:"flex justify-end sm:justify-start lg:justify-end xl:justify-start -space-x-1 rtl:space-x-reverse"},Ht=["src","alt"],Ot=s("div",{class:"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-300 text-xs ring-2 ring-slate-100 dark:ring-slate-700 rounded-full h-6 w-6 flex flex-col justify-center items-center"}," +2 ",-1),Rt={key:4,class:"min-w-[220px] block"},Nt={class:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-1 font-medium mt-3"},Lt=s("span",{class:"font-normal"},"12/15 Task Completed",-1),qt={key:5,class:"action-btn text-end mr-3"},Ft={class:"text-xl"},$t=["onClick"],Gt={class:"text-base"},zt={class:"py-4 px-3"};function wt(e,l,d,_,t,p){const M=k("Button"),a=k("VueTailwindDatePicker"),V=k("InputGroup"),A=k("ProgressBar"),E=k("Icon"),f=k("MenuItem"),U=k("Dropdown"),B=k("Pagination"),j=k("vue-good-table"),m=k("EditProject"),O=k("Card");return h(),v("div",null,[n(O,{noborder:""},{default:g(()=>[s("div",yt,[Vt,s("div",Ct,[n(M,{icon:"heroicons-outline:arrows-up-down",btnClass:"btn-outline-secondary text-slate-600 dark:border-slate-700 dark:text-slate-300 font-normal btn-sm",iconClass:"text-lg",onClick:p.reloadCrmTable},null,8,["onClick"]),s("div",jt,[n(a,{modelValue:t.dateValue,"onUpdate:modelValue":l[0]||(l[0]=b=>t.dateValue=b),"input-classes":"form-control "},null,8,["modelValue"])]),n(V,{modelValue:t.searchTerm,"onUpdate:modelValue":l[1]||(l[1]=b=>t.searchTerm=b),placeholder:"Buscar por cualquier dato",type:"text",prependIcon:"heroicons-outline:search",merged:""},null,8,["modelValue"])])]),n(j,{class:"-mx-6",columns:t.columns,styleClass:" vgt-table  table-head   v-middle striped  listview",rows:this.projects,"pagination-options":{enabled:!0,perPage:t.perpage},"search-options":{enabled:!0,externalQuery:t.searchTerm},"sort-options":{enabled:!1}},{"table-row":g(b=>[b.column.field=="name"?(h(),v("span",Et,[s("div",At,[s("div",Mt,[s("div",St,$(b.row.name.charAt(0)+b.row.name.charAt(b.row.name.length-1)),1)]),s("div",It,$(b.row.name.length>20?b.row.name.substring(0,20)+"...":b.row.name),1)])])):x("",!0),b.column.field=="startDate"?(h(),v("span",Ut,$(b.row.startDate),1)):x("",!0),b.column.field=="endDate"?(h(),v("span",Pt,$(b.row.endDate),1)):x("",!0),b.column.field=="assignto"?(h(),v("span",Tt,[s("div",Bt,[(h(!0),v(pe,null,_e(b.row.assignto,(o,i)=>(h(),v("div",{class:"h-6 w-6 rounded-full ring-1 ring-slate-100",key:i},[s("img",{src:o.image,alt:o.title,class:"w-full h-full rounded-full"},null,8,Ht)]))),128)),Ot])])):x("",!0),b.column.field=="progress"?(h(),v("span",Rt,[n(A,{value:b.row.progress,barColor:"bg-primary-500"},null,8,["value"]),s("span",Nt,[Lt,de(" "+$(b.row.progress)+"% ",1)])])):x("",!0),b.column.field=="action"?(h(),v("div",qt,[n(U,{classMenuItems:" w-[140px]"},{menus:g(()=>[(h(!0),v(pe,null,_e(t.actions,(o,i)=>(h(),D(f,{key:i},{default:g(()=>[s("div",{onClick:R=>o.doit(b.row),class:fe(`
                
                  ${o.name==="delete"?"bg-danger-500 text-danger-500 bg-opacity-30  hover:bg-opacity-100 hover:text-white":"hover:bg-slate-900 hover:text-white"}
                   w-full border-b border-b-gray-500 border-opacity-10 px-4 py-2 text-sm  last:mb-0 cursor-pointer first:rounded-t last:rounded-b flex  space-x-2 items-center `)},[s("span",Gt,[n(E,{icon:o.icon},null,8,["icon"])]),s("span",null,$(o.name),1)],10,$t)]),_:2},1024))),128))]),default:g(()=>[s("div",Ft,[n(E,{icon:"heroicons-outline:dots-vertical"})])]),_:2},1024)])):x("",!0)]),"pagination-bottom":g(b=>[s("div",zt,[n(B,{total:t.projects.length,current:t.current,"per-page":t.perpage,pageRange:t.pageRange,onPageChanged:l[2]||(l[2]=o=>t.current=o),pageChanged:b.pageChanged,perPageChanged:b.perPageChanged,enableSearch:"",enableSelect:""},null,8,["total","current","per-page","pageRange","pageChanged","perPageChanged"])])]),_:1},8,["columns","rows","pagination-options","search-options"]),n(m,{activeModal:t.showEditModal,onClose:l[3]||(l[3]=b=>t.showEditModal=!1),clientData:t.clientData,title:"Actualizar Datos Cliente",onUpdateClientList:p.listarClientes},null,8,["activeModal","clientData","onUpdateClientList"])]),_:1})])}const Yt=ce(xt,[["render",wt]]),Q=le().headers(),Xt={components:{Dropdown:ie,Select:q,vSelect:xe,Button:z,FromGroup:H,EditProject:Ve,Textinput:J,Modal:re,Checkbox:ke,InputGroup:te,Icon:ne,VueSelect:ye,MenuItem:ue,Card:se,ProgressBar:ae},data(){return{idBookingg:null,searchTerm:"",tellephonAndCellphone:"",selectedAsignHotel:!1,selectedHotel:!1,showEditModal:!1,store:ee(),customerOptions:[],hotelOptions:[],projects:[],actions:[{name:"edit",icon:"heroicons:pencil-square",doit:e=>{this.openModalEdit(e)}},{name:"delete",icon:"heroicons-outline:trash",doit:e=>{this.removeProject(e)}}],columnsReservaHotelExpense:[{label:"Habitacion",field:"habitacion"},{label:"Hotel",field:"hotel"},{label:"N° PAX	",field:"pasajeross"},{label:"Cant. HAB",field:"cantidad"},{label:"Check-In",field:"checkin"},{label:"Check-out",field:"checkout"},{label:"#Noches",field:"noches"},{label:"Precio",field:"precio"},{label:"Descuento",field:"descuento"},{label:"Adicional",field:"adicional"},{label:"Observación",field:"observacion"},{label:"Subtotal",field:"subtotal"},{label:"",field:"action"}],bookinghotel:{id:null,hotel_id:null,booking_id:null,client_id:null,collaborator_id:null,code:null,correlative:null,reference_voucher:null,is_external:null,total:null,observation:null,created_at:null,updated_at:null,deleted_at:null,hotel_description:null,client_fullname:null,client_document:null,client_cellphone:null,client_telephone:null},bedroomOptions:[{value:1,label:"HAB. SIMPLE"},{value:2,label:"HAB. SIMPLE (AC)"},{value:3,label:"HAB. MATRIMONIAL"},{value:4,label:"HAB. MATRIMONIAL (AC)"},{value:5,label:"HAB. DOBLE"},{value:6,label:"HAB. DOBLE (AC)"},{value:7,label:"HAB. TRIPLE"},{value:8,label:"HAB. TRIPLE (AC)"},{value:9,label:"HAB. GRUPAL"},{value:10,label:"HAB. GRUPAL (AC)"}]}},props:{activeModal:Boolean,code:String,idCliente:String,idBooking:String},emits:["close"],created(){this.fetchHotels(),this.fetchClients()},watch:{selectedAsignHotel(e,l){if(e!==l){const d=this.projects.findIndex(_=>_.id===e);d===-1?I.get(`https://thtsystemv2.tech/public/api/v1/typebedrooms/description/${e}`,Q).then(_=>{const t={id:e,description:_.data.data};this.projects.push(t),this.calculateTotal(this.projects.length-1)}):I.get(`https://thtsystemv2.tech/public/api/v1/typebedrooms/description/${e}`,Q).then(_=>{this.projects[d].description=_.data.data,this.calculateTotal(d)})}this.selectedAsignHotel=null},"bookinghotel.client_id"(e,l){I.get(`https://thtsystemv2.tech/public/api/v1/clients/cellphone&telephone/${e.value}`,Q).then(d=>{this.tellephonAndCellphone=d.data.contact_numbers}).catch(d=>{console.error("Error al obtener la descripción del tour:",d)})},projects:{deep:!0,handler(e,l){this.calculateTotalForAllProjects()}},code:function(e,l){this.bookinghotel.booking_id=e},idCliente:function(e,l){this.fetchClients(),this.bookinghotel.client_id=e,console.log("El valor del idCliente es",e)},idBooking:function(e,l){this.idBookingg=e}},methods:{closeEditModal(){this.$emit("close")},updateNights(e){const l=new Date(this.projects[e].date_checkin),_=new Date(this.projects[e].date_checkout).getTime()-l.getTime(),t=Math.ceil(_/(1e3*3600*24));this.projects[e].nights=t},calculateTotalForAllProjects(){let e=0;this.projects.forEach(l=>{const d=l.price||0,_=l.nights||0,t=l.quantity||1;l.subtotal=d*_*t,e+=d*_*t}),this.bookinghotel.total=e},calculateTotal(e){const l=this.projects[e],d=l.price||0,_=l.nights||0,t=l.quantity||1;l.total=d*_*t,this.calculateTotalForAllProjects()},saveReservaHotel(){const e={client_id:this.bookinghotel.client_id.value,booking_id:this.idBookingg,collaborator_id:this.bookinghotel.collaborator_id,code:this.bookinghotel.code,correlative:this.bookinghotel.correlative,reference_voucher:this.bookinghotel.reference_voucher,is_external:this.bookinghotel.is_external,observation:this.bookinghotel.observation,total:this.bookinghotel.total,detailbedrooms:this.projects.map(l=>({typebedroom_id:l.id!==null&&l.id!==void 0?l.id.toString():"",date_checkin:l.date_checkin,date_checkout:l.date_checkout,quantity:l.quantity,guests:l.guests,nights:l.nights,hotel_id:l.hotel,price:l.price,additional:l.additional,discount:l.discount,observation:l.observation}))};console.log(e),I.post("https://thtsystemv2.tech/public/api/v1/hotelsbookings/create",e,{...Q}).then(l=>{this.$emit("postComplete",l.data);const d=G();this.closeEditModal(),d.success(l.data.message)}).catch(l=>{console.error("Error al enviar los datos al backend:",l)})},openModal(){this.showEditModal=!0},deleteProject(e){this.projects.splice(e,1)},async fetchHotels(){try{const e=await I.get("https://thtsystemv2.tech/public/api/v1/hotels/list",Q);this.hotelOptions=e.data.data.map(l=>({value:l.id,label:l.tradename}))}catch(e){console.error("Error al obtener los datos de los colaboradores:",e)}},async fetchClients(){try{const e=await I.get("https://thtsystemv2.tech/public/api/v1/clients/list",Q);this.customerOptions=e.data.data.map(l=>({value:l.id,label:l.fullname}))}catch(e){console.error("Error fetching departments:",e)}}},computed:{limitedCustomerOptions(){return this.customerOptions.slice(0,6)}}},Jt=e=>(ge("data-v-7e11e224"),e=e(),ve(),e),Qt={name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4"},Wt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Kt={class:"flex items-center"},Zt={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Dt={class:"flex items-center"},el={class:"flex-grow mr-2"},tl={class:"grid grid-cols-1"},ll={class:"flex flex-col"},ol={key:0},nl={class:"flex space-x-3 items-center text-left rtl:space-x-reverse"},sl={key:1},il={key:2,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},al={key:3,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},dl={key:4,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},cl={key:5,class:"block w-full"},rl={key:6},ul={key:7},ml={key:8},hl={key:9},pl={key:10},_l={key:11},bl={key:12,class:"action-btn text-end mr-3"},gl=["onClick"],vl={class:"mt-5 self-end"},fl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},kl=Jt(()=>s("div",{class:"lg:col-span-1"},null,-1)),xl={class:"lg:col-span-3 flex justify-end"};function yl(e,l,d,_,t,p){const M=k("vSelect"),a=k("VueSelect"),V=k("FromGroup"),A=k("InputGroup"),E=k("Select"),f=k("Textinput"),U=k("flat-pickr"),B=k("Icon"),j=k("vue-good-table"),m=k("Button"),O=k("EditProject"),b=k("Modal");return h(),v("div",null,[n(b,{title:"Registrar reserva de hotel",label:"Modal title",activeModal:t.store.addmodal,onClose:t.store.closeModal,sizeClass:"max-w-8xl"},{default:g(()=>[s("form",Qt,[s("div",Wt,[s("div",null,[s("div",Kt,[n(V,{label:"Cliente Responsable",class:"flex-1"},{default:g(()=>[n(a,null,{default:g(()=>[n(M,{options:t.customerOptions,modelValue:t.bookinghotel.client_id,"onUpdate:modelValue":l[0]||(l[0]=o=>t.bookinghotel.client_id=o)},null,8,["options","modelValue"])]),_:1})]),_:1}),s("button",{onClick:l[1]||(l[1]=w((...o)=>p.openModal&&p.openModal(...o),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")])]),s("div",null,[n(V,{label:"Número teléfono"},{default:g(()=>[n(A,{type:"tel",modelValue:t.tellephonAndCellphone,"onUpdate:modelValue":l[2]||(l[2]=o=>t.tellephonAndCellphone=o),placeholder:"Número de teléfono"},null,8,["modelValue"])]),_:1})])]),s("div",Zt,[s("div",null,[n(V,{label:"Asignar habitación"},{default:g(()=>[s("div",Dt,[s("div",el,[n(E,{options:t.bedroomOptions,modelValue:t.selectedAsignHotel,"onUpdate:modelValue":l[3]||(l[3]=o=>t.selectedAsignHotel=o),placeholder:"Seleccionar Hotel",class:"w-full"},null,8,["options","modelValue"])])])]),_:1})]),s("div",null,[n(V,{label:"N° ref. comprobante"},{default:g(()=>[n(f,{type:"text",modelValue:t.bookinghotel.reference_voucher,"onUpdate:modelValue":l[4]||(l[4]=o=>t.bookinghotel.reference_voucher=o),placeholder:"Número de referencia del comprobante"},null,8,["modelValue"])]),_:1})]),s("div",null,[n(V,{label:"Observaciones"},{default:g(()=>[n(f,{type:"text",modelValue:t.bookinghotel.observation,"onUpdate:modelValue":l[5]||(l[5]=o=>t.bookinghotel.observation=o),placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),s("div",tl,[s("div",ll,[n(j,{class:"-mx-6 mb-5",columns:t.columnsReservaHotelExpense,styleClass:" vgt-table  table-head   v-middle striped lesspadding2 listview",rows:this.projects,"sort-options":{enabled:!1}},{"table-row":g(o=>[o.column.field=="habitacion"?(h(),v("span",ol,[s("div",nl,$(o.row.description),1)])):x("",!0),o.column.field=="pasajeross"?(h(),v("span",sl,[n(f,{type:"text",placeholder:"N° pax",modelValue:t.projects[o.index].guests,"onUpdate:modelValue":i=>t.projects[o.index].guests=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="cantidad"?(h(),v("span",il,[n(f,{type:"text",placeholder:"Cant. HAB",modelValue:t.projects[o.index].quantity,"onUpdate:modelValue":i=>t.projects[o.index].quantity=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="hotel"?(h(),v("span",al,[n(E,{options:t.hotelOptions,modelValue:t.projects[o.index].hotel,"onUpdate:modelValue":i=>t.projects[o.index].hotel=i},null,8,["options","modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="checkin"?(h(),v("span",dl,[n(U,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:t.projects[o.index].date_checkin,"onUpdate:modelValue":i=>t.projects[o.index].date_checkin=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="checkout"?(h(),v("span",cl,[n(U,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:t.projects[o.index].date_checkout,"onUpdate:modelValue":i=>t.projects[o.index].date_checkout=i,onChange:i=>p.updateNights(o.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):x("",!0),o.column.field=="noches"?(h(),v("span",rl,[n(f,{type:"text",placeholder:"#Noches",modelValue:t.projects[o.index].nights,"onUpdate:modelValue":i=>t.projects[o.index].nights=i,onChange:i=>p.calculateTotal(o.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):x("",!0),o.column.field=="precio"?(h(),v("span",ul,[n(f,{type:"text",placeholder:"Precio",modelValue:t.projects[o.index].price,"onUpdate:modelValue":i=>t.projects[o.index].price=i,onChange:i=>p.calculateTotal(o.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):x("",!0),o.column.field=="descuento"?(h(),v("span",ml,[n(f,{type:"text",placeholder:"Descuento",modelValue:t.projects[o.index].discount,"onUpdate:modelValue":i=>t.projects[o.index].discount=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),de(),o.column.field=="adicional"?(h(),v("span",hl,[n(f,{type:"text",placeholder:"Adicional",modelValue:t.projects[o.index].additional,"onUpdate:modelValue":i=>t.projects[o.index].additional=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="observacion"?(h(),v("span",pl,[n(f,{type:"text",placeholder:"Observacion",modelValue:t.projects[o.index].observation,"onUpdate:modelValue":i=>t.projects[o.index].observation=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="subtotal"?(h(),v("span",_l,[n(f,{type:"text",placeholder:"Subtotal",modelValue:t.projects[o.index].subtotal,"onUpdate:modelValue":i=>t.projects[o.index].subtotal=i},null,8,["modelValue","onUpdate:modelValue"])])):x("",!0),o.column.field=="action"?(h(),v("div",bl,[s("div",{class:"text-xl",onClick:i=>p.deleteProject(o.index)},[n(B,{icon:"heroicons-outline:trash",class:"text-danger-500"})],8,gl)])):x("",!0)]),_:1},8,["columns","rows"]),s("div",vl,[n(A,{label:"T. RESERVA S/.",class:"append",name:"hi_Fullname",type:"number",placeholder:"",modelValue:t.bookinghotel.total,"onUpdate:modelValue":l[6]||(l[6]=o=>t.bookinghotel.total=o),horizontal:"",appendIcon:"heroicons-outline:cash",classInput:"text-right"},null,8,["modelValue"])])])]),s("div",fl,[kl,s("div",xl,[n(m,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:l[7]||(l[7]=w(o=>p.closeEditModal(),["prevent"]))}),n(m,{type:"submit",text:"Guardar Reserva",btnClass:"btn-dark",onClick:l[8]||(l[8]=w(o=>p.saveReservaHotel(),["prevent"]))})])])]),n(O,{activeModal:t.showEditModal,onClose:l[9]||(l[9]=o=>t.showEditModal=!1),title:"Actualizar Registro de Colaborador",onUpdateClientList:p.fetchClients},null,8,["activeModal","onUpdateClientList"])]),_:1},8,["activeModal","onClose"])])}const Vl=ce(Xt,[["render",yl],["__scopeId","data-v-7e11e224"]]),Cl={class:"flex flex-wrap justify-between items-center mb-4"},ro={__name:"index-reservas-hotel",setup(e){const l=ee();let d=T("list");const _=()=>{l.openProject()},t=T(0),p=()=>{t.value=window.innerWidth};be(()=>{window.addEventListener("resize",p),p()});const M=Me(()=>l.projects),a=T(!0),V=T(!1);return setTimeout(()=>{a.value=!1},1e3),F(d,(A,E)=>{A!==E&&(A==="list"?(a.value=!0,V.value=!1):(a.value=!1,V.value=!0),setTimeout(()=>{a.value=!1,V.value=!1},1e3))}),(A,E)=>(h(),v("div",null,[s("div",Cl,[s("div",{class:fe(["md:flex md:space-x-4 md:justify-end items-center rtl:space-x-reverse",t.value<768?"space-x-rb":""])},[n(u(z),{icon:"heroicons:list-bullet",text:"Vista de Lista",btnClass:`${u(d)==="list"?"bg-slate-900 dark:bg-slate-700  text-white":" bg-white dark:bg-slate-800 dark:text-slate-300"}   h-min text-sm font-normal`,iconClass:" text-lg",onClick:E[0]||(E[0]=f=>W(d)?d.value="list":d="list"),isLoading:a.value,isDisabled:a.value},null,8,["btnClass","isLoading","isDisabled"]),n(u(z),{icon:"heroicons-outline:plus",text:"Agregar Reserva de Hotel",btnClass:"btn-dark dark:bg-slate-800  h-min text-sm font-normal",iconClass:" text-lg",onClick:_,isLoading:u(l).isLoading},null,8,["isLoading"])],2)]),a.value?(h(),D(u(je),{key:0,count:M.value.length},null,8,["count"])):x("",!0),u(d)==="grid"&&!V.value?(h(),D(u(Ie),{key:1})):x("",!0),u(d)==="list"&&!a.value?(h(),D(u(Yt),{key:2})):x("",!0),n(Vl),n(Ce)]))}};export{ro as default};
