import{s as S,C as m,v as C,H as W,z as E,y as U,U as z,F as G,I as X,J as Y,K as Z,P as L,$ as A}from"./index-CyQKzwXM.js";import{u as D,o as y,E as _,A as j,T as ee,I as F,N,a as b}from"./keyboard-C8YEoqI_.js";import{w as te}from"./use-outside-click-WivoOT8p.js";import{s as le}from"./use-resolve-button-type-DXZUzXBT.js";import{f as ae,c as h,p as oe,u as ne}from"./menu-BlqYkBdn.js";import{f as ie,u as ue}from"./hidden-1JsWbmcm.js";import{t as re,i as V,l as se}from"./open-closed-CLDwNzJK.js";import{w as ve,h as de,O as pe}from"./focus-management-DKnT3RdX.js";function ce(t,r,i){let g=S(i==null?void 0:i.value),s=m(()=>t.value!==void 0);return[m(()=>s.value?t.value:g.value),function(d){return s.value||(g.value=d),r==null?void 0:r(d)}]}function K(t={},r=null,i=[]){for(let[g,s]of Object.entries(t))q(i,H(r,g),s);return i}function H(t,r){return t?t+"["+r+"]":r}function q(t,r,i){if(Array.isArray(i))for(let[g,s]of i.entries())q(t,H(r,g.toString()),s);else i instanceof Date?t.push([r,i.toISOString()]):typeof i=="boolean"?t.push([r,i?"1":"0"]):typeof i=="string"?t.push([r,i]):typeof i=="number"?t.push([r,`${i}`]):i==null?t.push([r,""]):K(i,r,t)}function fe(t,r){return t===r}var be=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(be||{}),me=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(me||{}),xe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(xe||{});function ge(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let Q=Symbol("ListboxContext");function B(t){let r=Z(Q,null);if(r===null){let i=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,B),i}return r}let $e=C({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>fe},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:r,attrs:i,emit:g}){let s=S(1),d=S(null),e=S(null),x=S(null),p=S([]),c=S(""),f=S(null),a=S(1);function n(l=o=>o){let o=f.value!==null?p.value[f.value]:null,u=pe(l(p.value.slice()),O=>y(O.dataRef.domRef)),v=o?u.indexOf(o):null;return v===-1&&(v=null),{options:u,activeOptionIndex:v}}let w=m(()=>t.multiple?1:0),[P,R]=ce(m(()=>t.modelValue),l=>g("update:modelValue",l),m(()=>t.defaultValue)),k=m(()=>P.value===void 0?D(w.value,{1:[],0:void 0}):P.value),$={listboxState:s,value:k,mode:w,compare(l,o){if(typeof t.by=="string"){let u=t.by;return(l==null?void 0:l[u])===(o==null?void 0:o[u])}return t.by(l,o)},orientation:m(()=>t.horizontal?"horizontal":"vertical"),labelRef:d,buttonRef:e,optionsRef:x,disabled:m(()=>t.disabled),options:p,searchQuery:c,activeOptionIndex:f,activationTrigger:a,closeListbox(){t.disabled||s.value!==1&&(s.value=1,f.value=null)},openListbox(){t.disabled||s.value!==0&&(s.value=0)},goToOption(l,o,u){if(t.disabled||s.value===1)return;let v=n(),O=ae(l===h.Specific?{focus:h.Specific,id:o}:{focus:l},{resolveItems:()=>v.options,resolveActiveIndex:()=>v.activeOptionIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});c.value="",f.value=O,a.value=u??1,p.value=v.options},search(l){if(t.disabled||s.value===1)return;let o=c.value!==""?0:1;c.value+=l.toLowerCase();let u=(f.value!==null?p.value.slice(f.value+o).concat(p.value.slice(0,f.value+o)):p.value).find(O=>O.dataRef.textValue.startsWith(c.value)&&!O.dataRef.disabled),v=u?p.value.indexOf(u):-1;v===-1||v===f.value||(f.value=v,a.value=1)},clearSearch(){t.disabled||s.value!==1&&c.value!==""&&(c.value="")},registerOption(l,o){let u=n(v=>[...v,{id:l,dataRef:o}]);p.value=u.options,f.value=u.activeOptionIndex},unregisterOption(l){let o=n(u=>{let v=u.findIndex(O=>O.id===l);return v!==-1&&u.splice(v,1),u});p.value=o.options,f.value=o.activeOptionIndex,a.value=1},theirOnChange(l){t.disabled||R(l)},select(l){t.disabled||R(D(w.value,{0:()=>l,1:()=>{let o=L($.value.value).slice(),u=L(l),v=o.findIndex(O=>$.compare(u,L(O)));return v===-1?o.push(u):o.splice(v,1),o}}))}};te([e,x],(l,o)=>{var u;$.closeListbox(),ve(o,de.Loose)||(l.preventDefault(),(u=y(e))==null||u.focus())},m(()=>s.value===0)),W(Q,$),re(m(()=>D(s.value,{0:V.Open,1:V.Closed})));let I=m(()=>{var l;return(l=y(e))==null?void 0:l.closest("form")});return E(()=>{U([I],()=>{if(!I.value||t.defaultValue===void 0)return;function l(){$.theirOnChange(t.defaultValue)}return I.value.addEventListener("reset",l),()=>{var o;(o=I.value)==null||o.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,modelValue:o,disabled:u,form:v,...O}=t,T={open:s.value===0,disabled:u,value:k.value};return z(G,[...l!=null&&k.value!=null?K({[l]:k.value}).map(([M,J])=>z(ie,_({features:ue.Hidden,key:M,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:v,disabled:u,name:M,value:J}))):[],j({ourProps:{},theirProps:{...i,...ee(O,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:T,slots:r,attrs:i,name:"Listbox"})])}}}),De=C({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:r,slots:i,expose:g}){var s;let d=(s=t.id)!=null?s:`headlessui-listbox-button-${F()}`,e=B("ListboxButton");g({el:e.buttonRef,$el:e.buttonRef});function x(a){switch(a.key){case b.Space:case b.Enter:case b.ArrowDown:a.preventDefault(),e.openListbox(),A(()=>{var n;(n=y(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(h.First)});break;case b.ArrowUp:a.preventDefault(),e.openListbox(),A(()=>{var n;(n=y(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(h.Last)});break}}function p(a){switch(a.key){case b.Space:a.preventDefault();break}}function c(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),A(()=>{var n;return(n=y(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),ge(()=>{var n;return(n=y(e.optionsRef))==null?void 0:n.focus({preventScroll:!0})})))}let f=le(m(()=>({as:t.as,type:r.type})),e.buttonRef);return()=>{var a,n;let w={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},{...P}=t,R={ref:e.buttonRef,id:d,type:f.value,"aria-haspopup":"listbox","aria-controls":(a=y(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(n=y(e.labelRef))==null?void 0:n.id,d].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:x,onKeyup:p,onClick:c};return j({ourProps:R,theirProps:P,slot:w,attrs:r,slots:i,name:"ListboxButton"})}}}),ke=C({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:r,slots:i,expose:g}){var s;let d=(s=t.id)!=null?s:`headlessui-listbox-options-${F()}`,e=B("ListboxOptions"),x=S(null);g({el:e.optionsRef,$el:e.optionsRef});function p(a){switch(x.value&&clearTimeout(x.value),a.key){case b.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case b.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let n=e.options.value[e.activeOptionIndex.value];e.select(n.dataRef.value)}e.mode.value===0&&(e.closeListbox(),A(()=>{var n;return(n=y(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})}));break;case D(e.orientation.value,{vertical:b.ArrowDown,horizontal:b.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Next);case D(e.orientation.value,{vertical:b.ArrowUp,horizontal:b.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Previous);case b.Home:case b.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.First);case b.End:case b.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Last);case b.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),A(()=>{var n;return(n=y(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case b.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),x.value=setTimeout(()=>e.clearSearch(),350));break}}let c=se(),f=m(()=>c!==null?(c.value&V.Open)===V.Open:e.listboxState.value===0);return()=>{var a,n;let w={open:e.listboxState.value===0},{...P}=t,R={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(n=y(e.buttonRef))==null?void 0:n.id,"aria-orientation":e.orientation.value,id:d,onKeydown:p,role:"listbox",tabIndex:0,ref:e.optionsRef};return j({ourProps:R,theirProps:P,slot:w,attrs:r,slots:i,features:N.RenderStrategy|N.Static,visible:f.value,name:"ListboxOptions"})}}}),Ie=C({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(t,{slots:r,attrs:i,expose:g}){var s;let d=(s=t.id)!=null?s:`headlessui-listbox-option-${F()}`,e=B("ListboxOption"),x=S(null);g({el:x,$el:x});let p=m(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===d:!1),c=m(()=>D(e.mode.value,{0:()=>e.compare(L(e.value.value),L(t.value)),1:()=>L(e.value.value).some(l=>e.compare(L(l),L(t.value)))})),f=m(()=>D(e.mode.value,{1:()=>{var l;let o=L(e.value.value);return((l=e.options.value.find(u=>o.some(v=>e.compare(L(v),L(u.dataRef.value)))))==null?void 0:l.id)===d},0:()=>c.value})),a=oe(x),n=m(()=>({disabled:t.disabled,value:t.value,get textValue(){return a()},domRef:x}));E(()=>e.registerOption(d,n)),X(()=>e.unregisterOption(d)),E(()=>{U([e.listboxState,c],()=>{e.listboxState.value===0&&c.value&&D(e.mode.value,{1:()=>{f.value&&e.goToOption(h.Specific,d)},0:()=>{e.goToOption(h.Specific,d)}})},{immediate:!0})}),Y(()=>{e.listboxState.value===0&&p.value&&e.activationTrigger.value!==0&&A(()=>{var l,o;return(o=(l=y(x))==null?void 0:l.scrollIntoView)==null?void 0:o.call(l,{block:"nearest"})})});function w(l){if(t.disabled)return l.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),A(()=>{var o;return(o=y(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})}))}function P(){if(t.disabled)return e.goToOption(h.Nothing);e.goToOption(h.Specific,d)}let R=ne();function k(l){R.update(l)}function $(l){R.wasMoved(l)&&(t.disabled||p.value||e.goToOption(h.Specific,d,0))}function I(l){R.wasMoved(l)&&(t.disabled||p.value&&e.goToOption(h.Nothing))}return()=>{let{disabled:l}=t,o={active:p.value,selected:c.value,disabled:l},{value:u,disabled:v,...O}=t,T={id:d,ref:x,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":c.value,disabled:void 0,onClick:w,onFocus:P,onPointerenter:k,onMouseenter:k,onPointermove:$,onMousemove:$,onPointerleave:I,onMouseleave:I};return j({ourProps:T,theirProps:O,slot:o,attrs:i,slots:r,name:"ListboxOption"})}}});export{ke as A,Ie as F,$e as I,De as j};
