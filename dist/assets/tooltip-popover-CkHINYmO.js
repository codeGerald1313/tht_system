import{D as L}from"./index-DFq5MbAK.js";import{B as j}from"./index-DCMPjbua.js";import{C as O}from"./index-Hsd0Z0_R.js";import{I as N}from"./index-BcFOD9Ey.js";import{I as R}from"./index-DCC49QXr.js";import{P as B}from"./index-vl95iEIB.js";import{w as F}from"./window-Ds9AqdYU.js";import{M as z}from"./index-MSlXG-Ka.js";import{S as G,u as q,J as v,b as p,d as l,e as d,h as _,c as u,o as n,f as a,n as D,t as m,p as f,i as M,F as H,m as A,l as E}from"./index-BLl1OigC.js";import{q as U}from"./vue-tailwind-datepicker-DbcSElnr.js";import{a as J,d as y}from"./dayjs.min-f9jiEfzB.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as $}from"./menu-CM83wd2-.js";import"./vue-cleave.min-DAvglPmz.js";import"./index-DPFbVGd7.js";import"./transition-CNElC_4N.js";import"./focus-management-Dc3XsveG.js";import"./keyboard-9WePWYgZ.js";import"./use-outside-click-CPWvQZIF.js";import"./hidden-BR_kr5_G.js";import"./micro-task-CxIZtCgj.js";import"./open-closed-0CPOhxDd.js";import"./use-resolve-button-type-BwPomRAb.js";var K={exports:{}};(function(e,s){(function(i,h){e.exports=h(J)})(G,function(i){function h(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var o=h(i),c={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(r){return r+"º"}};return o.default.locale(c,null,!0),c})})(K);const w=q().headers(),W={mixins:[F],components:{Pagination:B,InputGroup:R,Dropdown:L,Icon:N,VueTailwindDatePicker:U,Card:O,MenuItem:$,Button:j,Modal:z},data(){const e=new Date,i=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0]+" 00:00:00",o=new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]+" 23:59:59";return{advancedTable:[],current:1,perpage:10,show:!1,startDateVariable:"",endDateVariable:"",dateValue:{startDate:i,endDate:o},pageRange:5,searchTerm:"",actions:[{name:"edit",icon:"heroicons:pencil-square",doit:c=>{const r=c.id,x=c;this.$router.push({name:"invoice-edit",params:{id:r},query:{otherData:JSON.stringify(x)}})}}],options:[{value:"1",label:"1"},{value:"3",label:"3"},{value:"5",label:"5"}],columns:[{label:"N° reserva	",field:"code"},{label:"Usuario r.	",field:"user_id"},{label:"Proforma",field:"reference_voucher"},{label:"Reponsable	",field:"client_id"},{label:"N° pax	",field:"nro_pax"},{label:"Teléfonos	",field:"amount"},{label:"Sobre tours	",field:"status"},{label:"Check-in	",field:"checking"},{label:"Total	",field:"total"},{label:"Debe	",field:"debe"},{label:"Action",field:"action"}]}},methods:{async reloadCrmTable(){v.get(`https://thtbackend-production.up.railway.app/api/v1/bookings/list?start_date=${this.dateValue.startDate}&end_date=${this.dateValue.endDate}`,w).then(e=>{console.log(e.data),this.advancedTable=e.data.data.map(i=>({...i,formatted_created_at:y(i.created_at).locale("es").format("DD MMM. YYYY")})),p().success(e.data.message),console.log(e)}).catch(e=>{console.error(e),e.response&&e.response.status===404?p().info("No se encontraron reservas dentro del rango de fechas proporcionado."):p().error("Ocurrió un error al obtener las reservas."),this.advancedTable=[]})},openModal(e){this.$router.push(`/app/reserve-preview/${e}`)}},watch:{dateValue(e,s){if(!e.startDate||!e.endDate)this.advancedTable=[];else{const i=e.startDate.split(" ")[0],h=e.endDate.split(" ")[0];v.get(`https://thtbackend-production.up.railway.app/api/v1/bookings/list?start_date=${i}&end_date=${h}`,w).then(o=>{console.log(o.data),p().success(o.data.message),this.advancedTable=o.data.data.map(r=>({...r,formatted_created_at:y(r.created_at).locale("es").format("DD MMM. YYYY")}))}).catch(o=>{console.error(o),o.response&&o.response.status===404?p().info("No se encontraron reservas dentro del rango de fechas proporcionado."):p().error("Ocurrió un error al obtener las reservas."),this.advancedTable=[]})}}},mounted(){v.get(`https://thtbackend-production.up.railway.app/api/v1/bookings/list?start_date=${this.dateValue.startDate}&end_date=${this.dateValue.endDate}`,w).then(e=>{console.log(e.data),p().success(e.data.message),this.advancedTable=e.data.data.map(i=>({...i,formatted_created_at:y(i.created_at).locale("es").format("DD MMM. YYYY")})),console.log(this.advancedTable)}).catch(e=>{console.error(e),e.response&&e.response.status===404?p().info("No se encontraron reservas dentro del rango de fechas proporcionado."):p().error("Ocurrió un error al obtener las reservas.")})}},X={class:"md:flex pb-6 items-center"},Z=a("h6",{class:"flex-1 md:mb-0 mb-3"},"Reservas",-1),ee={class:"w-[370px]"},te={class:"-mx-6"},oe=["onClick"],ae={class:"text-success-600 font-bold"},se={style:{"margin-top":"5px"},class:"font-bold"},ne={key:1,class:"text-slate-500 dark:text-slate-400"},le=a("br",null,null,-1),re={key:2,class:"text-slate-500 dark:text-slate-400",style:{display:"flex","flex-direction":"column"}},ie={class:"font-bold"},de={key:3,style:{display:"flex","flex-direction":"column"}},ce={style:{"margin-top":"5px"}},ue={key:4,class:"text-slate-500 dark:text-slate-400"},me={key:0,class:"bg-blue-200 py-1 px-2 rounded-full text-blue-600 font-semibold inline-block",style:{width:"160px"}},pe={key:1,class:"flex items-center text-yellow-600 bg-yellow-100 py-1 px-2 rounded-full",style:{width:"120px"}},_e=a("svg",{class:"h-4 w-4 mr-2 fill-current",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M19.707 3.293a1 1 0 00-1.414 0l-10 10-4-4a1 1 0 10-1.414 1.414l5 5a1 1 0 001.414 0l11-11a1 1 0 000-1.414z","clip-rule":"evenodd"})],-1),fe=a("span",{class:"flex items-center font-semibold"}," Completados ",-1),he=[_e,fe],be={key:5,class:"text-slate-500 dark:text-slate-400"},ge={key:0,class:"flex items-center bg-green-200 py-1 px-2 rounded-full"},xe=a("span",{class:"text-green-600 font-semibold"},"Confirmado",-1),ve=[xe],ye={key:1,class:"font-bold"},we={key:2},ke={key:6,class:"text-red-500 dark:text-slate-400 font-bold"},De={key:7,class:"action-btn text-end mr-3"},Me={class:"text-xl"},Ce=["onClick"],Te={class:"text-base"},Ye={class:"py-4 px-3"},Ve={name:"client_form",id:"client_form",autocomplete:"off",class:"mx-auto space-y-4"},Pe={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Ie=a("div",{class:"lg:col-span-1"},null,-1),Se={class:"lg:col-span-3 flex justify-end"};function Le(e,s,i,h,o,c){const r=u("InputGroup"),x=u("VueTailwindDatePicker"),g=u("Button"),k=u("Icon"),C=u("MenuItem"),T=u("Dropdown"),Y=u("Pagination"),V=u("vue-good-table"),P=u("Card"),I=u("Modal");return n(),l("div",null,[d(P,{noborder:""},{default:_(()=>[a("div",X,[Z,a("div",{class:D(["md:flex md:space-x-3 items-center flex-none rtl:space-x-reverse",e.window.width<768?"space-x-rb":""])},[d(r,{modelValue:o.searchTerm,"onUpdate:modelValue":s[0]||(s[0]=t=>o.searchTerm=t),placeholder:"Escriba para buscar",type:"text",prependIcon:"heroicons-outline:search",merged:""},null,8,["modelValue"]),a("div",ee,[d(x,{modelValue:o.dateValue,"onUpdate:modelValue":s[1]||(s[1]=t=>o.dateValue=t),"input-classes":"form-control "},null,8,["modelValue"])]),d(g,{icon:"heroicons-outline:arrows-up-down",btnClass:" btn-outline-secondary text-slate-600 dark:border-slate-700 dark:text-slate-300 font-normal btn-sm ",iconClass:"text-lg",onClick:c.reloadCrmTable},null,8,["onClick"]),d(g,{icon:"heroicons-outline:plus-sm",text:"Agregar Reserva",btnClass:" btn-dark font-normal btn-sm ",iconClass:"text-lg",link:"invoice-add"})],2)]),a("div",te,[d(V,{columns:o.columns,styleClass:" vgt-table  centered ",rows:o.advancedTable,"sort-options":{enabled:!1},"pagination-options":{enabled:!0,perPage:o.perpage},"search-options":{enabled:!0,externalQuery:o.searchTerm}},{"table-row":_(t=>[t.column.field==="code"?(n(),l("span",{key:0,class:"font-medium w-[140px]",onClick:b=>c.openModal(t.row.id),style:{display:"flex","flex-direction":"column"}},[a("span",ae,m(t.row.code),1),a("span",se,"Reg: "+m(t.row.formatted_created_at),1)],8,oe)):f("",!0),t.column.field=="user_id"?(n(),l("span",ne,[M(m(t.row.user.name)+" ",1),le])):f("",!0),t.column.field=="client_id"?(n(),l("span",re,[a("span",null,m(t.row.client.fullname),1),a("span",ie,m(t.row.client.document),1)])):f("",!0),t.column.field==="amount"?(n(),l("span",de,[a("span",null,"Teléfono: "+m(t.row.client.telephone),1),a("span",ce,"Celular: "+m(t.row.client.cellphone),1)])):f("",!0),t.column.field=="status"?(n(),l("span",ue,[t.row.pending_tours>0?(n(),l("span",me," Por Realizar "+m(t.row.pending_tours)+" Tours ",1)):(n(),l("span",pe,he))])):f("",!0),t.column.field=="checking"?(n(),l("span",be,[t.row.is_checkin?(n(),l("span",ge,ve)):t.row.is_checkout?(n(),l("span",ye," Checkou ")):(n(),l("span",we," Pendiente "))])):f("",!0),t.column.field==="debe"?(n(),l("span",ke," S/."+m(((parseFloat(t.row.total)||0)-(parseFloat(t.row.total_paid)||0)).toFixed(2)),1)):f("",!0),t.column.field=="action"?(n(),l("div",De,[d(T,{classMenuItems:" w-[140px]"},{menus:_(()=>[(n(!0),l(H,null,A(o.actions,(b,S)=>(n(),E(C,{key:S},{default:_(()=>[a("div",{onClick:je=>b.doit(t.row),class:D(`
                
                  ${b.name==="delete"?"bg-danger-500 text-danger-500 bg-opacity-30  hover:bg-opacity-100 hover:text-white":"hover:bg-slate-900 hover:text-white"}
                   w-full border-b border-b-gray-500 border-opacity-10 px-4 py-2 text-sm  last:mb-0 cursor-pointer first:rounded-t last:rounded-b flex  space-x-2 items-center `)},[a("span",Te,[d(k,{icon:b.icon},null,8,["icon"])]),a("span",null,m(b.name),1)],10,Ce)]),_:2},1024))),128))]),default:_(()=>[a("div",Me,[d(k,{icon:"heroicons-outline:dots-vertical"})])]),_:2},1024)])):f("",!0)]),"pagination-bottom":_(t=>[a("div",Ye,[d(Y,{total:o.advancedTable.length,current:o.current,"per-page":o.perpage,pageRange:o.pageRange,onPageChanged:s[2]||(s[2]=b=>o.current=b),pageChanged:t.pageChanged,perPageChanged:t.perPageChanged,enableSearch:"",enableSelect:"",options:o.options},{default:_(()=>[M(" > ")]),_:2},1032,["total","current","per-page","pageRange","pageChanged","perPageChanged","options"])])]),_:1},8,["columns","rows","pagination-options","search-options"])])]),_:1}),d(I,{title:"Datos de reserva | R2024-000643",label:"Modal title",activeModal:o.show,onClose:s[3]||(s[3]=t=>o.show=!1),sizeClass:"max-w-4xl"},{default:_(()=>[a("form",Ve,[a("div",Pe,[Ie,a("div",Se,[d(g,{text:"Cancelar",btnClass:"btn-light mr-2"}),d(g,{type:"submit",text:"Guardar Cambios",btnClass:"btn-dark"})])])])]),_:1},8,["activeModal"])])}const st=Q(W,[["render",Le]]);export{st as default};
