import{C as oe}from"./index-COOwjdNO.js";import{B as re}from"./index-CRJE58yX.js";import{I as te}from"./index-BffMpWx5.js";import{F as M}from"./index-z1TsTTdr.js";import{I as Z}from"./index-2H-cusMd.js";import{V as ae}from"./VueSelect-QFU_7fbT.js";import{T as ue}from"./TotalTable-C3szSPF8.js";import{M as $}from"./index-2mWc_vCg.js";import{S as P}from"./index-BaZVwneS.js";import{T as N}from"./index-BL9tae9R.js";import{D as ne}from"./index-Bs_uOHMv.js";import{b as R,u as ee,s as w,y as D,c as C,o as y,l as me,g as s,f as t,w as x,e as l,k as c,d as B,q as I,B as E,F as pe,t as W,z as fe,A as Q,h as ge,D as ke,E as Ve}from"./index-BFn_3Gdk.js";import{B as F}from"./index-CvW4wJPB.js";import{u as le}from"./project-BEvoPr6t.js";import{C as ye}from"./VueSelect.vue_vue_type_style_index_0_lang-CworQ5tj.js";import{T as be}from"./index-DERosrGp.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as ie}from"./menu-BIf-sRSE.js";import{C as Ce}from"./index-JvTu2BQt.js";import{P as xe}from"./index-Dr9vJUyq.js";import{a as Me}from"./basic-tablle-data-AN7MRnVF.js";const Be={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ee={key:0,class:"text-red-500"},Se={key:0,class:"text-red-500"},Ue={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ae={class:"grid lg:grid-cols-3 gap-4"},Ie={key:0,class:"text-red-500"},Te={class:"grid lg:grid-cols-3 gap-4"},Oe={class:"form-group col-lg-12 form__footerBtn"},je={class:"text-right mt-6"},we={__name:"CollaboratorAddModalCommision",props:{activeModal:Boolean},emits:["close","updateColaboradorList"],setup(a,{emit:e}){le();const b=R(),U=ee().headers(),o=a,d=e,T=()=>{d("close")},r=w({partnercompany_id:"",vehicletype_id:"",fullname:"",document:"",cellphone:"",email:"",address:"",date_birthday:"",sex:"",status:"",partnercompany:"",vehicletype:""}),h=w(null),v=w(null),O=w(null),j=w(null),q=[{label:"Seleccione"},{label:"Soltero"},{label:"Casado"},{label:"Otros"}],u=[{label:"Seleccione"},{label:"Masculino"},{label:"Femenino"},{label:"Otros"}],H=[{label:"Mototaxi",value:"Mototaxi"},{label:"Auto",value:"Auto"},{label:"H350",value:"H350"},{label:"Techo Alto",value:"Techo Alto"}],n=S=>!!r.value[S],i=S=>n(S),V=()=>{E.post("https://thtsystemv2.tech/public/api/v1/collaborators/create",r.value,{...U}).then(S=>{d("updateColaboradorList"),T(),b.success(S.data.message)}).catch(S=>{console.error("Error al guardar los datos:",S)})},G=[{label:"GUAROS GROUP",value:"GUAROS GROUP"}],z=()=>{E.post("https://thtsystemv2.tech/public/api/v1/getDniData",{dni:r.value.document}).then(S=>{r.value.fullname=S.data.data.nombre_completo}).catch(S=>{console.error("Error al obtener datos del DNI:",S)})};return D(()=>h.value,(S,g)=>{const A=document.querySelector(".state-select select");if(A){const _=A.selectedIndex,L=A.options[_].text;r.value.status=L}}),D(()=>v.value,(S,g)=>{const A=document.querySelector(".sexo-select select");if(A){const _=A.selectedIndex,L=A.options[_].text;r.value.sex=L}}),D(()=>O.value,(S,g)=>{const A=document.querySelector(".partercompany-select select");if(A){const _=A.selectedIndex,L=A.options[_].text;r.value.partnercompany_id=_,r.value.partnercompany=L}}),D(()=>j.value,(S,g)=>{const A=document.querySelector(".typevehiculo-select select");if(A){const _=A.selectedIndex,L=A.options[_].text;r.value.vehicletype_id=_,r.value.vehicletype=L}}),(S,g)=>{const A=C("flat-pickr");return y(),me(c($),{activeModal:o.activeModal,onClose:T,title:"Registrar nuevo Colaborador",sizeClass:"max-w-5xl",centered:""},{default:s(()=>[t("form",{onSubmit:g[10]||(g[10]=x((..._)=>S.addProject&&S.addProject(..._),["prevent"])),class:"space-y-4 col-span-3"},[t("div",Be,[t("div",null,[l(c(M),{label:"N° Documento"},{default:s(()=>[l(c(Z),{type:"text",placeholder:"DNI",modelValue:r.value.document,"onUpdate:modelValue":g[0]||(g[0]=_=>r.value.document=_)},{append:s(()=>[l(c(F),{text:"RENIEC",btnClass:"btn-outline-dark ",onClick:x(z,["prevent"])})]),_:1},8,["modelValue"]),i("document")?I("",!0):(y(),B("span",Ee,"Por favor ingresa un número válido"))]),_:1})]),t("div",null,[l(c(M),{label:"Nombres completos"},{default:s(()=>[l(c(N),{type:"text",modelValue:r.value.fullname,"onUpdate:modelValue":g[1]||(g[1]=_=>r.value.fullname=_),modelModifiers:{trim:!0},placeholder:"Ingresar nombre completo"},null,8,["modelValue"]),i("fullname")?I("",!0):(y(),B("span",Se,"Por favor ingresa un nombre válido"))]),_:1})])]),t("div",Ue,[t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:G,label:"Empresa socia",modelValue:O.value,"onUpdate:modelValue":g[2]||(g[2]=_=>O.value=_),class:"partercompany-select",placeholder:"Seleccione Empresa"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:H,label:"Tipo vehículo",modelValue:j.value,"onUpdate:modelValue":g[3]||(g[3]=_=>j.value=_),class:"typevehiculo-select",placeholder:"Seleccione Vehículo"},null,8,["modelValue"])]),_:1})])]),t("div",Ae,[t("div",null,[l(c(M),{label:"Celular"},{default:s(()=>[l(c(N),{type:"text",modelValue:r.value.cellphone,"onUpdate:modelValue":g[4]||(g[4]=_=>r.value.cellphone=_),modelModifiers:{trim:!0},placeholder:"Ingrese número de celular"},null,8,["modelValue"]),i("cellphone")?I("",!0):(y(),B("span",Ie,"Por favor ingrese número valido"))]),_:1})]),t("div",null,[l(c(M),{label:"Dirección"},{default:s(()=>[l(c(N),{type:"text",placeholder:"Ingrese dirección",name:"client_direccion",modelValue:r.value.address,"onUpdate:modelValue":g[5]||(g[5]=_=>r.value.address=_),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),{label:"Correo electrónico"},{default:s(()=>[l(c(N),{type:"email",placeholder:"Ingrese el correo electrónico",name:"client_email",modelValue:r.value.email,"onUpdate:modelValue":g[6]||(g[6]=_=>r.value.email=_),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})])]),t("div",Te,[t("div",null,[l(c(M),{label:"Fecha de nacimiento"},{default:s(()=>[l(A,{modelValue:r.value.date_birthday,"onUpdate:modelValue":g[7]||(g[7]=_=>r.value.date_birthday=_),class:"form-control",id:"date_birthday",placeholder:"yyyy, dd M",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"}},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:q,label:"Estado",modelValue:h.value,"onUpdate:modelValue":g[8]||(g[8]=_=>h.value=_),class:"state-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:u,label:"Sexo",modelValue:v.value,"onUpdate:modelValue":g[9]||(g[9]=_=>v.value=_),class:"sexo-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})])]),t("div",Oe,[t("div",je,[l(c(F),{text:"Cancelar",btnClass:"btn-light mr-2",onClick:x(T,["prevent"])}),l(c(F),{type:"submit",text:"Guardar Cambios",btnClass:"btn-dark",onClick:V})])])],32)]),_:1},8,["activeModal"])}}};le();const J=ee().headers(),Pe={data(){return{show3:!1,show4:!1,valorCode:"",showColabardorModal:!1,commission_data:{user_id:null,nro_voucher_external:null,accountbank_id:null,booking_id:null,collaborator_id:null,paymentmethod_id:null,branchoffice_id:null,total_hotel:"0.00",total_tour:"0.00",observation:null,branchoffice_id:1,is_paid:null,total_commission:"0.00"},bank:{description:""},accountBank:{branchoffice_id:0,bank_id:0,typeaccount_id:0,currency_id:0,name:"",number_account:"",cci_account:"",balance:0,headline:"",description:""},currency:[{value:1,label:"SOL"},{value:2,label:"DÓLAR"},{value:3,label:"EURO"}],branchoffices:[{value:1,label:"Oficina Principal"}],typeaccount:[{value:1,label:"CUENTA SIMPLE"},{value:2,label:"CUENTA CORRIENTE"},{value:3,label:"TARJETA DE CRÉDITO"}],paymentMethods:[{value:1,label:"Efectivo"},{value:2,label:"Visa"},{value:3,label:"Cheque"},{value:4,label:"Depósito a cuenta"}],boxesOptions:[{value:1,label:"Caja Principal"}],colaboratorOptions:[],accountOptions:[],banks:[]}},components:{Card:oe,Icon:te,FromGroup:M,Button:F,Dropdown:ne,EditProject2:we,InputGroup:Z,Textinput:N,Select:P,VueSelect:ae,vSelect:ye,TotalTable:ue,Textarea:be,MenuItem:ie,Modal:$,Breadcrumb:re},props:{activeModal:Boolean,code:String,idBooking:String},watch:{"commission_data.total_hotel":function(a,e){this.calculateTotalCommission()},"commission_data.total_tour":function(a,e){this.calculateTotalCommission()},code:function(a,e){this.valorCode=a},idBooking:function(a,e){this.commission_data.booking_id=a},"commission_data.paymentmethod_id":function(a,e){a!=null&&a!==""&&(this.commission_data.paymentmethod_id=parseInt(a))}},emits:["close"],methods:{closeEditModal(){this.$emit("close")},calculateTotalCommission(){const a=parseFloat(this.commission_data.total_hotel),e=parseFloat(this.commission_data.total_tour);isNaN(a)||isNaN(e)||a===null||e===null||a.toString().trim()===""||e.toString().trim()===""?this.commission_data.total_commission="Error: Los valores deben ser numéricos":this.commission_data.total_commission=a+e},openModalBanck(){this.show4=!0},async guardarCambiosAccountBank(){const a=R();try{const e=await E.post("https://thtsystemv2.tech/public/api/v1/accountbanks/create",this.accountBank,{...J});this.fetchAccountBanks(),this.closeModalEditAccountBank(),a.success("¡Cambios guardados en la cuenta bancaria exitosamente!")}catch(e){a.error("Error al guardar cambios en la cuenta bancaria. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en la cuenta bancaria:",e)}},async guardarCambiosBank(){const a=R();try{const e=await E.post("https://thtsystemv2.tech/public/api/v1/banks/create",this.bank,{...J});this.fetchBanks(),this.closeEditModalBank(),a.success("¡Cambios guardados en el banco exitosamente!")}catch(e){a.error("Error al guardar cambios en el banco. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en el banco:",e)}},closeEditModalBank(){this.show4=!1},openModaalBanckAccount(){this.show3=!0},openModalColaborador(){this.showColabardorModal=!0},closeModalEditAccountBank(){this.show3=!1},submitForm(){const a=R();this.commission_data.paymentmethod_id=parseInt(this.commission_data.paymentmethod_id);let e={...this.commission_data};this.commission_data.collaborator_id.value&&(e.collaborator_id=this.commission_data.collaborator_id.value),E.post("https://thtsystemv2.tech/public/api/v1/commisions/create",e,{...J}).then(b=>{this.$emit("commissionProcessed",b),this.closeEditModal(),a.success("¡La comisión se procesó exitosamente!"),this.commission_data.collaborator_id=null,this.commission_data.paymentmethod_id=null,this.commission_data.total_commission="0.00",this.commission_data.total_tour="0.00",this.commission_data.total_hotel="0.00",this.commission_data.observation=null}).catch(b=>{if(console.error("Error al guardar los datos:",b),b.response&&b.response.data&&b.response.data.message){const U=R();this.closeEditModal();const o=b.response.data.message;U.error(o)}else a.error("Ha ocurrido un error al guardar los datos. Por favor, inténtalo de nuevo.")})},async listarColaboradores(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/collaborators/list",J);this.colaboratorOptions=a.data.data.map(e=>({value:e.id,label:e.fullname}))}catch(a){console.error("Error al obtener los datos de los empleados:",a)}},async fetchAccountBanks(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/accountbanks/list",J);this.accountOptions=a.data.data.map(e=>({value:e.id,label:e.name}))}catch(a){console.error("Error fetching departments:",a)}},async fetchBanks(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/banks/list",J);this.banks=a.data.data.map(e=>({value:e.id,label:e.description}))}catch(a){console.error("Error fetching banks:",a)}}},mounted(){this.fetchBanks(),this.listarColaboradores(),this.fetchAccountBanks()},computed:{limitedCustomerOptions(){return this.colaboratorOptions.slice(0,6)}}},Ne={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},De={class:"flex items-center"},Re={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},qe={class:"flex items-center"},Le={class:"text-[32px] leading-10 font-medium text-blue-800"},Fe={class:"grid grid-cols-1"},He={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Ge=t("div",{class:"lg:col-span-1"},null,-1),ze={class:"lg:col-span-3 flex justify-end"},Ye={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},Je={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Xe={class:"flex items-center"},Qe={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},We={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Ze=t("div",{class:"lg:col-span-3"},null,-1),$e={class:"lg:col-span-1 flex justify-end"},el={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},ll={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},ol=t("div",{class:"lg:col-span-3"},null,-1),tl={class:"lg:col-span-1 flex justify-end"};function al(a,e,b,U,o,d){const T=C("vSelect"),r=C("VueSelect"),h=C("FromGroup"),v=C("Select"),O=C("Textinput"),j=C("Button"),q=C("Textarea"),u=C("Modal"),H=C("EditProject2");return y(),B("div",null,[l(u,{title:"Comisionar reserva | "+o.valorCode,label:"Modal title",activeModal:b.activeModal,onClose:d.closeEditModal,sizeClass:"max-w-4xl"},{default:s(()=>[t("form",{name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4",onSubmit:e[11]||(e[11]=x((...n)=>d.submitForm&&d.submitForm(...n),["prevent"]))},[t("div",Ne,[t("div",De,[l(h,{label:"Colaborador",class:"flex-1"},{default:s(()=>[l(r,null,{default:s(()=>[l(T,{options:o.colaboratorOptions,modelValue:o.commission_data.collaborator_id,"onUpdate:modelValue":e[0]||(e[0]=n=>o.commission_data.collaborator_id=n)},null,8,["options","modelValue"])]),_:1})]),_:1}),t("button",{onClick:e[1]||(e[1]=x((...n)=>d.openModalColaborador&&d.openModalColaborador(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),t("div",null,[l(h,{label:"Caja aperturada"},{default:s(()=>[l(v,{options:o.boxesOptions,modelValue:o.commission_data.branchoffice_id,"onUpdate:modelValue":e[2]||(e[2]=n=>o.commission_data.branchoffice_id=n),disabled:"",placeholder:"Seleccionar caja"},null,8,["options","modelValue"])]),_:1})])]),t("div",Re,[t("div",null,[l(h,{label:"Método de pago"},{default:s(()=>[l(v,{modelValue:o.commission_data.paymentmethod_id,"onUpdate:modelValue":e[3]||(e[3]=n=>o.commission_data.paymentmethod_id=n),options:o.paymentMethods,placeholder:"Seleccionar método de pago"},null,8,["modelValue","options"])]),_:1})]),o.commission_data.paymentmethod_id===4?(y(),B(pe,{key:0},[t("div",qe,[l(h,{label:"Cuenta destino",class:"flex-1"},{default:s(()=>[l(v,{options:o.accountOptions,modelValue:o.commission_data.accountbank_id,"onUpdate:modelValue":e[4]||(e[4]=n=>o.commission_data.accountbank_id=n),class:"cuentadestino-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[5]||(e[5]=x((...n)=>d.openModaalBanckAccount&&d.openModaalBanckAccount(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),l(h,{label:"N° de Operación"},{default:s(()=>[l(O,{type:"text",modelValue:o.commission_data.nro_voucher_external,"onUpdate:modelValue":e[6]||(e[6]=n=>o.commission_data.nro_voucher_external=n),placeholder:"Ingrese N° de Operación"},null,8,["modelValue"])]),_:1})],64)):I("",!0),t("div",null,[l(h,{label:"Comisión Hotel"},{default:s(()=>[l(O,{modelValue:o.commission_data.total_hotel,"onUpdate:modelValue":e[7]||(e[7]=n=>o.commission_data.total_hotel=n),type:"text",placeholder:"Comisión Hotel"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(h,{label:"Comisión Tours"},{default:s(()=>[l(O,{modelValue:o.commission_data.total_tour,"onUpdate:modelValue":e[8]||(e[8]=n=>o.commission_data.total_tour=n),type:"text",placeholder:"Comisión Tours"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(h,{label:"TOTAL COMISIÓN",class:"text-center"},{default:s(()=>[t("p",null,[t("span",Le,"S/ "+W(o.commission_data.total_commission),1)])]),_:1})])]),t("div",Fe,[t("div",null,[l(h,{label:"Observación"},{default:s(()=>[l(O,{modelValue:o.commission_data.observation,"onUpdate:modelValue":e[9]||(e[9]=n=>o.commission_data.observation=n),type:"textarea",placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),t("div",He,[Ge,t("div",ze,[l(j,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[10]||(e[10]=x(n=>d.closeEditModal(),["prevent"]))}),l(j,{type:"submit",text:"Procesar Comisión",btnClass:"btn-dark"})])])],32),l(u,{title:"Registrar cuenta bancaria",label:"Modal title",activeModal:o.show3,onClose:d.closeModalEditAccountBank},{default:s(()=>[t("form",Ye,[t("div",Je,[t("div",null,[l(h,{label:"Sucursal",class:"block"},{default:s(()=>[l(v,{modelValue:o.accountBank.branchoffice_id,"onUpdate:modelValue":e[12]||(e[12]=n=>o.accountBank.branchoffice_id=n),options:o.branchoffices,required:"",class:"oficinaprincipal-select"},null,8,["modelValue","options"])]),_:1})]),t("div",null,[l(h,{label:"Tipo de cuenta",class:"block"},{default:s(()=>[l(v,{modelValue:o.accountBank.typeaccount_id,"onUpdate:modelValue":e[13]||(e[13]=n=>o.accountBank.typeaccount_id=n),options:o.typeaccount,required:"",class:"typeaccount-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",Ke,[t("div",Xe,[l(h,{label:"Banco",class:"flex-1"},{default:s(()=>[l(v,{options:o.banks,modelValue:o.accountBank.bank_id,"onUpdate:modelValue":e[14]||(e[14]=n=>o.accountBank.bank_id=n),class:"banck-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[15]||(e[15]=x((...n)=>d.openModalBanck&&d.openModalBanck(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),t("div",null,[l(h,{label:"Moneda",class:"block"},{default:s(()=>[l(v,{modelValue:o.accountBank.currency_id,"onUpdate:modelValue":e[16]||(e[16]=n=>o.accountBank.currency_id=n),options:o.currency,required:"",class:"money-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",null,[l(h,{label:"Nombre cuenta",class:"block"},{default:s(()=>[l(O,{modelValue:o.accountBank.name,"onUpdate:modelValue":e[17]||(e[17]=n=>o.accountBank.name=n),placeholder:"Nombre cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",Qe,[t("div",null,[l(h,{label:"N° de cuenta",class:"block"},{default:s(()=>[l(O,{modelValue:o.accountBank.number_account,"onUpdate:modelValue":e[18]||(e[18]=n=>o.accountBank.number_account=n),placeholder:"N° de cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(h,{label:"N° CCI (Código interbancario)",class:"block"},{default:s(()=>[l(O,{modelValue:o.accountBank.cci_account,"onUpdate:modelValue":e[19]||(e[19]=n=>o.accountBank.cci_account=n),placeholder:"N° CCI",required:""},null,8,["modelValue"])]),_:1})])]),t("div",null,[l(h,{label:"Titular cuenta",class:"block"},{default:s(()=>[l(O,{modelValue:o.accountBank.headline,"onUpdate:modelValue":e[20]||(e[20]=n=>o.accountBank.headline=n),placeholder:"Titular cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(h,{label:"Descripción",class:"block"},{default:s(()=>[l(q,{modelValue:o.accountBank.description,"onUpdate:modelValue":e[21]||(e[21]=n=>o.accountBank.description=n),placeholder:"Descripción"},null,8,["modelValue"])]),_:1})]),t("div",We,[Ze,t("div",$e,[l(j,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:x(d.closeModalEditAccountBank,["prevent"])},null,8,["onClick"]),l(j,{type:"submit",text:"Guardar Cambios",onClick:x(d.guardarCambiosAccountBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])]),l(u,{title:"Registrar banco",label:"Modal title",activeModal:o.show4,onClose:e[23]||(e[23]=n=>o.show4=!1)},{default:s(()=>[t("form",el,[l(O,{modelValue:o.bank.description,"onUpdate:modelValue":e[22]||(e[22]=n=>o.bank.description=n),label:"Nombre",name:"pn",type:"text",placeholder:"Ingresar nombre "},null,8,["modelValue"]),t("div",ll,[ol,t("div",tl,[l(j,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:x(d.closeEditModalBank,["prevent"])},null,8,["onClick"]),l(j,{type:"submit",text:"Guardar Cambios",onClick:x(d.guardarCambiosBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])])]),_:1},8,["activeModal"])]),_:1},8,["activeModal","onClose"]),l(H,{activeModal:o.showColabardorModal,title:"Registrar nuevo Colaborador",onUpdateColaboradorList:d.listarColaboradores,onClose:e[24]||(e[24]=n=>o.showColabardorModal=!1)},null,8,["activeModal","onUpdateColaboradorList"])]),_:1},8,["title","activeModal","onClose"])])}const Yo=se(Pe,[["render",al]]),nl={name:"client_form",id:"client_form",autocomplete:"off",class:"mx-auto space-y-4"},sl={class:"grid grid-cols-3 lg:grid-cols-3 gap-4"},il={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},cl={class:"lg:col-span-3"},dl=t("div",{class:"lg:hidden"},null,-1),rl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},ul={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},ml={class:"lg:col-span-3"},pl=t("div",{class:"lg:hidden"},null,-1),bl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},hl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},vl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},_l=t("div",{class:"lg:col-span-1"},null,-1),fl={class:"lg:col-span-3 flex justify-end"},he={__name:"ClientAddModal",props:{activeModal:Boolean},emits:["close","updateClientList"],setup(a,{emit:e}){le();const b=ee().headers(),U=R(),o=a,d=e,T=()=>{d("close")},r=w([]),h=w([]),v=w([]),O=async()=>{try{const f=await E.get("https://thtsystemv2.tech/public/api/v1/ubigeo/departments",b);r.value=f.data.data.map(m=>({value:m.id,label:m.name}))}catch(f){console.error("Error fetching departments:",f)}},j=[{value:1,label:"Natural"},{value:2,label:"Jurídico"}],q=[{value:1,label:"DNI"},{value:2,label:"RUC"},{value:3,label:"PASAPORTE"}],u=[{id:1,label:"Soltero"},{id:2,label:"Casado"},{id:2,label:"Viudo"},{id:2,label:"Divorciado"}],H=[{id:1,label:"Masculino"},{id:2,label:"Femenino"}],n=w({typedocument_id:"",department_id:"",province_id:"",district_id:"",type_client:"",fullname:"",document:"",tradename:"",address:"",email:"",telephone:"",cellphone:"",date_birthday:"",sex:"",status:"",typeDocument:""}),i=w(j[0].value),V=w(q[0].value);let G=w(null),z=w(null),S=w(null),g=w(null),A=w(null);const _=()=>{const f=document.querySelector(".typecliente-select select");if(f){const k=f.selectedIndex,p=k.toString();f.options[k].text,n.value.type_client=p}const m=document.querySelector(".typedocument-select select");if(f){const k=m.selectedIndex,p=m.options[k].text;n.value.typedocument_id=k,n.value.typeDocument=p}E.post("https://thtsystemv2.tech/public/api/v1/clients/create",n.value,{...b}).then(k=>{d("updateClientList",k.data),T(),U.success(k.data.message)}).catch(k=>{console.error("Error al guardar los datos:",k)})},L=()=>{E.post("https://thtsystemv2.tech/public/api/v1/getDniData",{dni:n.value.document}).then(f=>{n.value.fullname=f.data.data.nombre_completo}).catch(f=>{console.error("Error al obtener datos del DNI:",f)})},ve=async()=>{try{const f=await E.get(`https://thtsystemv2.tech/public/api/v1/ubigeo/provinces/${n.value.department_id}`,b);v.value=f.data.data.map(m=>({value:m.id,label:m.name}))}catch(f){console.error("Error fetching provinces:",f)}},_e=async()=>{try{const f=await E.get(`https://thtsystemv2.tech/public/api/v1/ubigeo/districts/${n.value.province_id}`,b);h.value=f.data.data.map(m=>({value:m.id,label:m.name}))}catch(f){console.error("Error fetching provinces:",f)}};D(()=>A.value,(f,m)=>{const k=document.querySelector(".sexo-select select");if(k){const p=k.selectedIndex,Y=k.options[p].text;n.value.sex=Y}}),D(()=>g.value,(f,m)=>{const k=document.querySelector(".state-select select");if(k){const p=k.selectedIndex,Y=k.options[p].text;n.value.status=Y}}),D(()=>S.value,(f,m)=>{if(document.querySelector(".district-select select")){const p=f.toString().padStart(6,"0");n.value.district_id=p}}),D(()=>z.value,(f,m)=>{if(document.querySelector(".province-select select")){const p=f.toString().padStart(4,"0");n.value.province_id=p}}),D(()=>G.value,(f,m)=>{if(document.querySelector(".department-select select")){const p=f.toString().padStart(2,"0");n.value.department_id=p}});const ce=w("N° DNI"),de=w("RENIEC");return D(()=>V.value,f=>{const m=document.querySelector(".typedocument-select select");if(m){const k=m.selectedIndex,p=m.options[k],Y=m.options[k].text;n.value.typedocument_id=k,n.value.typeDocument=Y,ce.value=`N° ${p.textContent}`,de.value=f==="1"?"RENIEC":f==="2"?"SUNAT":"Validar"}}),D(()=>i.value,(f,m)=>{const k=document.querySelector(".typecliente-select select");if(k){const p=k.selectedIndex,Y=p.toString();k.options[p].text,n.value.type_client=Y}}),fe(()=>{O()}),(f,m)=>{const k=C("flat-pickr");return y(),B("div",null,[l(c($),{activeModal:o.activeModal,onClose:T,title:"Registrar nuevo Cliente",sizeClass:"max-w-4xl",centered:""},{default:s(()=>[t("form",nl,[t("div",sl,[t("div",null,[l(c(M),{label:"Tipo de cliente"},{default:s(()=>[l(c(P),{options:j,modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=p=>i.value=p),class:"typecliente-select",placeholder:"Seleccione Cliente"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),{label:"Tipo documento"},{default:s(()=>[l(c(P),{options:q,modelValue:V.value,"onUpdate:modelValue":m[1]||(m[1]=p=>V.value=p),class:"typedocument-select"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),{label:"N° Documento"},{default:s(()=>[l(c(Z),{type:"text",placeholder:ce.value,modelValue:n.value.document,"onUpdate:modelValue":m[2]||(m[2]=p=>n.value.document=p)},{append:s(()=>[l(c(F),{text:de.value,btnClass:"btn-outline-dark",onClick:x(L,["prevent"])},null,8,["text"])]),_:1},8,["placeholder","modelValue"])]),_:1})])]),t("div",il,[t("div",cl,[l(c(M),{label:"Nombre ó Razón Social"},{default:s(()=>[l(c(N),{type:"text",id:"client_fullname",modelValue:n.value.fullname,"onUpdate:modelValue":m[3]||(m[3]=p=>n.value.fullname=p),modelModifiers:{trim:!0},placeholder:"Ingrese Nombre ó Razón Social "},null,8,["modelValue"])]),_:1})]),dl]),t("div",rl,[t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:r.value,label:"Departamento",modelValue:c(G),"onUpdate:modelValue":m[4]||(m[4]=p=>Q(G)?G.value=p:G=p),class:"department-select",onChange:ve},null,8,["options","modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:v.value,label:"Provincias",modelValue:c(z),"onUpdate:modelValue":m[5]||(m[5]=p=>Q(z)?z.value=p:z=p),class:"province-select",onChange:_e,placeholder:""},null,8,["options","modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:h.value,label:"Distritos",modelValue:c(S),"onUpdate:modelValue":m[6]||(m[6]=p=>Q(S)?S.value=p:S=p),class:"district-select",placeholder:""},null,8,["options","modelValue"])]),_:1})])]),t("div",ul,[t("div",ml,[l(c(M),{label:"Dirección"},{default:s(()=>[l(c(N),{type:"text",modelValue:n.value.address,"onUpdate:modelValue":m[7]||(m[7]=p=>n.value.address=p),modelModifiers:{trim:!0},placeholder:"Ingrese Direción"},null,8,["modelValue"])]),_:1})]),pl]),t("div",bl,[t("div",null,[l(c(M),{label:"Celular"},{default:s(()=>[l(c(N),{type:"text",modelValue:n.value.cellphone,"onUpdate:modelValue":m[8]||(m[8]=p=>n.value.cellphone=p),modelModifiers:{trim:!0},placeholder:"Ingrese N° de celular"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),{label:"Teléfono fijo"},{default:s(()=>[l(c(N),{type:"text",modelValue:n.value.telephone,"onUpdate:modelValue":m[9]||(m[9]=p=>n.value.telephone=p),modelModifiers:{trim:!0},placeholder:"Ingrese N° de telefono fijo"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),{label:"Correo electrónico"},{default:s(()=>[l(c(N),{type:"email",modelValue:n.value.email,"onUpdate:modelValue":m[10]||(m[10]=p=>n.value.email=p),modelModifiers:{trim:!0},placeholder:"Ingrese correo electrónico"},null,8,["modelValue"])]),_:1})])]),t("div",hl,[t("div",null,[l(c(M),{label:"Fecha de nacimiento"},{default:s(()=>[l(k,{modelValue:n.value.date_birthday,"onUpdate:modelValue":m[11]||(m[11]=p=>n.value.date_birthday=p),class:"form-control",id:"date_birthday",placeholder:"yyyy, dd M",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"}},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:u,label:"Estado",modelValue:c(g),"onUpdate:modelValue":m[12]||(m[12]=p=>Q(g)?g.value=p:g=p),class:"state-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(c(M),null,{default:s(()=>[l(c(P),{options:H,label:"Sexo",modelValue:c(A),"onUpdate:modelValue":m[13]||(m[13]=p=>Q(A)?A.value=p:A=p),class:"sexo-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})])]),t("div",vl,[_l,t("div",fl,[l(c(F),{text:"Cancelar",btnClass:"btn-light mr-2",onClick:x(T,["prevent"])}),l(c(F),{type:"submit",text:"Guardar Cambios",btnClass:"btn-dark",onClick:x(_,["prevent"])})])])])]),_:1},8,["activeModal"])])}}};le();const K=ee().headers(),gl={data(){return{show3:!1,show4:!1,showEditModal:!1,branchoffice_id:1,income:{totalAPagar:0,totalRestante:0,receptor_module:null,receptor_fullname:null,receptor_document:null,is_paycredit:null,available_edit:null,user_id:null,concept_id:null,valor_en_dolares:null,paymentmethod_id:null,currency_id:null,voucher_id:null,client_id:null,provider_id:null,employee_id:null,accountbank_id:null,date_movement:null,amount:null,text_amount:null,gloss:"",reference_operation:null,nro_voucher:null,serie:null,correlative:null,billing_external_id:null,billing_hash:null,motive_cancelled:null,billing_cancelled:null,date_repayment:null,repaymentmovement_id:null,dischargedocument_id:null,is_voucher_external:null,voucher_external:null,nro_voucher_external:null,booking_id:null,commission_id:null,observation:null,is_visible:null},paymentMethods:[{value:1,label:"Efectivo"},{value:2,label:"Visa"},{value:3,label:"Cheque"},{value:4,label:"Depósito a cuenta"},{value:5,label:"Dólar"}],amountInSoles:null,clienteOptions:[{value:1,label:"Cliente 1"},{value:2,label:"Cliente 2"},{value:3,label:"Cliente 3"}],branchboxOptions:[{value:1,label:"Caja 1"},{value:2,label:"Caja 2"},{value:3,label:"Caja 3"}],branchoffices:[{value:1,label:"Oficina Principal"}],typeaccount:[{value:1,label:"CUENTA SIMPLE"},{value:2,label:"CUENTA CORRIENTE"},{value:3,label:"TARJETA DE CRÉDITO"}],currency:[{value:1,label:"SOL"},{value:2,label:"DÓLAR"},{value:3,label:"EURO"}],bank:{description:""},accountBank:{branchoffice_id:0,bank_id:0,typeaccount_id:0,currency_id:0,name:"",number_account:"",cci_account:"",balance:0,headline:"",description:""},boxesOptions:[{value:1,label:"Caja Principal"}],banks:[],valorCode:"",accountOptions:[],customerOptions:[]}},components:{Card:oe,Icon:te,FromGroup:M,Button:F,Dropdown:ne,EditProject:he,InputGroup:Z,Textinput:N,Select:P,VueSelect:ae,Textarea:be,TotalTable:ue,MenuItem:ie,Modal:$,Breadcrumb:re},props:{activeModal:Boolean,idCliente:String,totalBooking:String,code:String,idBooking:String},emits:["close"],methods:{closeEditModal(){this.$emit("close")},openModal(){this.showEditModal=!0},openModalBanck(){this.show4=!0},closeEditModalBank(){this.show4=!1},openModaalBanckAccount(){this.show3=!0},closeModalEditAccountBank(){this.show3=!1},async guardarCambiosAccountBank(){const a=R();try{const e=await E.post("https://thtsystemv2.tech/public/api/v1/accountbanks/create",this.accountBank,{...K});this.fetchAccountBanks(),this.closeModalEditAccountBank(),a.success("¡Cambios guardados en la cuenta bancaria exitosamente!")}catch(e){a.error("Error al guardar cambios en la cuenta bancaria. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en la cuenta bancaria:",e)}},async guardarCambiosBank(){const a=R();try{const e=await E.post("https://thtsystemv2.tech/public/api/v1/banks/create",this.bank,{...K});this.fetchBanks(),this.closeEditModalBank(),a.success("¡Cambios guardados en el banco exitosamente!")}catch(e){a.error("Error al guardar cambios en el banco. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en el banco:",e)}},async fetchBanks(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/banks/list",K);this.banks=a.data.data.map(e=>({value:e.id,label:e.description}))}catch(a){console.error("Error fetching banks:",a)}},submitForm(){this.income.paymentmethod_id===5&&(this.income.amount=this.amountInSoles),this.income.paymentmethod_id=parseInt(this.income.paymentmethod_id),E.post("https://thtsystemv2.tech/public/api/v1/moneys/create-booking-income",this.income,{...K}).then(a=>{const e=R();this.$emit("income-submitted",this.income),this.$emit("form-submitted",a.data),this.closeEditModal(),e.success(a.data.message),this.income.amount=null,this.income.paymentmethod_id=null,this.income.observation=null}).catch(a=>{if(console.error("Error al guardar los datos:",a),a.response&&a.response.data&&a.response.data.message){const e=R();this.closeEditModal();const b=a.response.data.message;e.error(b)}else toast.error("Ha ocurrido un error al guardar los datos. Por favor, inténtalo de nuevo.")})},async fetchAccountBanks(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/accountbanks/list",K);this.accountOptions=a.data.data.map(e=>({value:e.id,label:e.name}))}catch(a){console.error("Error fetching departments:",a)}},async fetchClients(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/clients/list",K);this.customerOptions=a.data.data.map(e=>({value:e.id,label:e.fullname}))}catch(a){console.error("Error fetching departments:",a)}},convertToSoles(){fetch("https://apilayer.net/api/live?access_key=eb6c32500a43070cccb3a47c70c56eb8&currencies=PEN&source=USD&format=1").then(b=>b.json()).then(b=>{if(b.success){const U=b.quotes.USDPEN,o=this.income.amount;this.income.valor_en_dolares=o;const d=(o*U).toFixed(2);this.amountInSoles=d,console.log(`Monto convertido: S/ ${d}`),this.income.totalRestante=(this.income.totalAPagar-d).toFixed(2)}else console.error("Error en la conversión:",b.error)}).catch(b=>{console.error("Error al realizar la llamada a la API:",b)})}},mounted(){this.fetchAccountBanks(),this.fetchClients(),this.fetchBanks()},watch:{"income.amount":function(a,e){this.income.paymentmethod_id!==5&&(this.income.totalRestante=this.income.totalAPagar-a)},idCliente:function(a,e){this.fetchClients(),this.income.client_id=a},totalBooking:function(a,e){const b=parseInt(a.replace(",",""),10);this.income.totalAPagar=b},code:function(a,e){this.valorCode=a},idBooking:function(a,e){this.income.booking_id=a},"income.paymentmethod_id":function(a,e){console.log(a),a!=null&&a!==""&&(this.income.paymentmethod_id=parseInt(a))}},computed:{limitedCustomerOptions(){return this.customerOptions.slice(0,6)}}},kl={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Vl={class:"flex items-center"},yl={key:0,class:"text-red-600"},Cl={key:0,class:"text-red-600"},xl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},Ml={key:0,class:"text-red-600"},Bl={class:"flex items-center"},El={class:"text-[32px] leading-10 font-medium text-blue-800"},Sl={key:0,class:"text-red-600"},Ul={key:1},Al={class:"text-[32px] leading-10 font-medium text-green-800"},Il={class:"text-[32px] leading-10 font-medium text-red-800"},Tl={class:"grid grid-cols-1"},Ol={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},jl=t("div",{class:"lg:col-span-1"},null,-1),wl={class:"lg:col-span-3 flex justify-end"},Pl={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},Nl={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Dl={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Rl={class:"flex items-center"},ql={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ll={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Fl=t("div",{class:"lg:col-span-3"},null,-1),Hl={class:"lg:col-span-1 flex justify-end"},Gl={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},zl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Yl=t("div",{class:"lg:col-span-3"},null,-1),Jl={class:"lg:col-span-1 flex justify-end"};function Kl(a,e,b,U,o,d){const T=C("Select"),r=C("FromGroup"),h=C("Textinput"),v=C("Button"),O=C("Textarea"),j=C("Modal"),q=C("EditProject");return y(),B("div",null,[l(j,{title:"Amortizar reserva | "+o.valorCode,label:"Modal title",activeModal:b.activeModal,onClose:d.closeEditModal,sizeClass:"max-w-4xl"},{default:s(()=>[t("form",{name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4",onSubmit:e[22]||(e[22]=x((...u)=>d.submitForm&&d.submitForm(...u),["prevent"]))},[t("div",kl,[t("div",null,[t("div",Vl,[l(r,{label:"Clientes",class:"flex-1"},{default:s(()=>[l(T,{options:d.limitedCustomerOptions,modelValue:o.income.client_id,"onUpdate:modelValue":e[0]||(e[0]=u=>o.income.client_id=u),class:"client-select",placeholder:"Cliente Reponsable"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[1]||(e[1]=x((...u)=>d.openModal&&d.openModal(...u),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),o.income.client_id?I("",!0):(y(),B("span",yl,"¡Selecciona un cliente!"))]),t("div",null,[l(r,{label:"Caja aperturada"},{default:s(()=>[l(T,{modelValue:o.branchoffice_id,"onUpdate:modelValue":e[2]||(e[2]=u=>o.branchoffice_id=u),options:o.boxesOptions,disabled:"",placeholder:"Seleccionar caja"},null,8,["modelValue","options"])]),_:1}),o.branchoffice_id?I("",!0):(y(),B("span",Cl,"¡Selecciona una caja!"))])]),t("div",xl,[t("div",null,[l(r,{label:"Método de pago"},{default:s(()=>[l(T,{modelValue:o.income.paymentmethod_id,"onUpdate:modelValue":e[3]||(e[3]=u=>o.income.paymentmethod_id=u),options:o.paymentMethods,placeholder:"Seleccionar método de pago"},null,8,["modelValue","options"])]),_:1}),o.income.paymentmethod_id?I("",!0):(y(),B("span",Ml,"¡Selecciona un método de pago!"))]),o.income.paymentmethod_id===4?(y(),B(pe,{key:0},[t("div",Bl,[l(r,{label:"Cuenta destino",class:"flex-1"},{default:s(()=>[l(T,{options:o.accountOptions,modelValue:o.income.accountbank_id,"onUpdate:modelValue":e[4]||(e[4]=u=>o.income.accountbank_id=u),class:"cuentadestino-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[5]||(e[5]=x((...u)=>d.openModaalBanckAccount&&d.openModaalBanckAccount(...u),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),l(r,{label:"N° de Operación"},{default:s(()=>[l(h,{type:"text",modelValue:o.income.nro_voucher_external,"onUpdate:modelValue":e[6]||(e[6]=u=>o.income.nro_voucher_external=u),placeholder:"Ingrese N° de Operación"},null,8,["modelValue"])]),_:1})],64)):I("",!0),t("div",null,[l(r,{label:"TOTAL A PAGAR",class:"text-center"},{default:s(()=>[t("span",El,"S/ "+W(o.income.totalAPagar),1)]),_:1})]),t("div",null,[l(r,{label:"Monto"},{default:s(()=>[l(h,{modelValue:o.income.amount,"onUpdate:modelValue":e[7]||(e[7]=u=>o.income.amount=u),type:"text",placeholder:"Comisión Tours"},null,8,["modelValue"])]),_:1}),o.income.amount?I("",!0):(y(),B("span",Sl,"¡Ingresa un monto!")),o.income.paymentmethod_id===5?(y(),me(v,{key:1,onClick:x(d.convertToSoles,["prevent"]),text:"Convertir a soles",btnClass:"btn-dark btn-md"},null,8,["onClick"])):I("",!0)]),o.amountInSoles?(y(),B("div",Ul,[l(r,{label:"Monto en soles",class:"text-center"},{default:s(()=>[t("span",Al," S/ "+W(o.amountInSoles),1)]),_:1})])):I("",!0),t("div",null,[l(r,{label:"TOTAL RESTANTE",class:"text-center"},{default:s(()=>[t("span",Il,"S/ "+W(o.income.totalRestante),1)]),_:1})])]),t("div",Tl,[t("div",null,[l(r,{label:"Observación"},{default:s(()=>[l(h,{modelValue:o.income.observation,"onUpdate:modelValue":e[8]||(e[8]=u=>o.income.observation=u),type:"textarea",placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),t("div",Ol,[jl,t("div",wl,[l(v,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[9]||(e[9]=x(u=>d.closeEditModal(),["prevent"]))}),l(v,{type:"submit",text:"Amortizar reserva",btnClass:"btn-dark"})])]),l(j,{title:"Registrar cuenta bancaria",label:"Modal title",activeModal:o.show3,onClose:d.closeModalEditAccountBank},{default:s(()=>[t("form",Pl,[t("div",Nl,[t("div",null,[l(r,{label:"Sucursal",class:"block"},{default:s(()=>[l(T,{modelValue:o.accountBank.branchoffice_id,"onUpdate:modelValue":e[10]||(e[10]=u=>o.accountBank.branchoffice_id=u),options:o.branchoffices,required:"",class:"oficinaprincipal-select"},null,8,["modelValue","options"])]),_:1})]),t("div",null,[l(r,{label:"Tipo de cuenta",class:"block"},{default:s(()=>[l(T,{modelValue:o.accountBank.typeaccount_id,"onUpdate:modelValue":e[11]||(e[11]=u=>o.accountBank.typeaccount_id=u),options:o.typeaccount,required:"",class:"typeaccount-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",Dl,[t("div",Rl,[l(r,{label:"Banco",class:"flex-1"},{default:s(()=>[l(T,{options:o.banks,modelValue:o.accountBank.bank_id,"onUpdate:modelValue":e[12]||(e[12]=u=>o.accountBank.bank_id=u),class:"banck-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[13]||(e[13]=x((...u)=>d.openModalBanck&&d.openModalBanck(...u),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),t("div",null,[l(r,{label:"Moneda",class:"block"},{default:s(()=>[l(T,{modelValue:o.accountBank.currency_id,"onUpdate:modelValue":e[14]||(e[14]=u=>o.accountBank.currency_id=u),options:o.currency,required:"",class:"money-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",null,[l(r,{label:"Nombre cuenta",class:"block"},{default:s(()=>[l(h,{modelValue:o.accountBank.name,"onUpdate:modelValue":e[15]||(e[15]=u=>o.accountBank.name=u),placeholder:"Nombre cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",ql,[t("div",null,[l(r,{label:"N° de cuenta",class:"block"},{default:s(()=>[l(h,{modelValue:o.accountBank.number_account,"onUpdate:modelValue":e[16]||(e[16]=u=>o.accountBank.number_account=u),placeholder:"N° de cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(r,{label:"N° CCI (Código interbancario)",class:"block"},{default:s(()=>[l(h,{modelValue:o.accountBank.cci_account,"onUpdate:modelValue":e[17]||(e[17]=u=>o.accountBank.cci_account=u),placeholder:"N° CCI",required:""},null,8,["modelValue"])]),_:1})])]),t("div",null,[l(r,{label:"Titular cuenta",class:"block"},{default:s(()=>[l(h,{modelValue:o.accountBank.headline,"onUpdate:modelValue":e[18]||(e[18]=u=>o.accountBank.headline=u),placeholder:"Titular cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(r,{label:"Descripción",class:"block"},{default:s(()=>[l(O,{modelValue:o.accountBank.description,"onUpdate:modelValue":e[19]||(e[19]=u=>o.accountBank.description=u),placeholder:"Descripción"},null,8,["modelValue"])]),_:1})]),t("div",Ll,[Fl,t("div",Hl,[l(v,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:x(d.closeModalEditAccountBank,["prevent"])},null,8,["onClick"]),l(v,{type:"submit",text:"Guardar Cambios",onClick:x(d.guardarCambiosAccountBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])]),l(j,{title:"Registrar banco",label:"Modal title",activeModal:o.show4,onClose:e[21]||(e[21]=u=>o.show4=!1)},{default:s(()=>[t("form",Gl,[l(h,{modelValue:o.bank.description,"onUpdate:modelValue":e[20]||(e[20]=u=>o.bank.description=u),label:"Nombre",name:"pn",type:"text",placeholder:"Ingresar nombre "},null,8,["modelValue"]),t("div",zl,[Yl,t("div",Jl,[l(v,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:x(d.closeEditModalBank,["prevent"])},null,8,["onClick"]),l(v,{type:"submit",text:"Guardar Cambios",onClick:x(d.guardarCambiosBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])])]),_:1},8,["activeModal"])]),_:1},8,["activeModal","onClose"])],32),l(q,{activeModal:o.showEditModal,onClose:e[23]||(e[23]=u=>o.showEditModal=!1),title:"Actualizar Registro de Colaborador",onUpdateClientList:d.fetchClients},null,8,["activeModal","onUpdateClientList"])]),_:1},8,["title","activeModal","onClose"])])}const Jo=se(gl,[["render",Kl]]),X=ee().headers(),Xl={components:{Dropdown:ne,Select:P,Button:F,FromGroup:M,EditProject:he,Textinput:N,Modal:$,Checkbox:Ce,InputGroup:Z,Icon:te,VueSelect:ae,MenuItem:ie,Card:oe,ProgressBar:xe},data(){return{idBookingg:null,advancedTable:Me,searchTerm:"",tellephonAndCellphone:"",selectedAsignHotel:!1,selectedHotel:!1,showEditModal:!1,store:null,customerOptions:[],hotelOptions:[],projects:[],actions:[{name:"edit",icon:"heroicons:pencil-square",doit:a=>{this.openModalEdit(a)}},{name:"delete",icon:"heroicons-outline:trash",doit:a=>{this.removeProject(a)}}],columnsReservaHotelExpense:[{label:"Habitacion",field:"habitacion"},{label:"N° PAX	",field:"pasajeross"},{label:"Cant. HAB",field:"cantidad"},{label:"Check-In",field:"checkin"},{label:"Check-out",field:"checkout"},{label:"#Noches",field:"noches"},{label:"Precio",field:"precio"},{label:"Descuento",field:"descuento"},{label:"Adicional",field:"adicional"},{label:"Observación",field:"observacion"},{label:"Subtotal",field:"subtotal"},{label:"",field:"action"}],bookinghotel:{id:null,hotel_id:null,booking_id:null,client_id:null,collaborator_id:null,code:null,correlative:null,reference_voucher:null,is_external:null,total:null,observation:null,created_at:null,updated_at:null,deleted_at:null,hotel_description:null,client_fullname:null,client_document:null,client_cellphone:null,client_telephone:null},bedroomOptions:[{value:1,label:"HAB. SIMPLE"},{value:2,label:"HAB. SIMPLE (AC)"},{value:3,label:"HAB. MATRIMONIAL"},{value:4,label:"HAB. MATRIMONIAL (AC)"},{value:5,label:"HAB. DOBLE"},{value:6,label:"HAB. DOBLE (AC)"},{value:7,label:"HAB. TRIPLE"},{value:8,label:"HAB. TRIPLE (AC)"},{value:9,label:"HAB. GRUPAL"},{value:10,label:"HAB. GRUPAL (AC)"}]}},props:{activeModal:Boolean,code:String,idCliente:String,idBooking:String},emits:["close"],created(){this.fetchHotels(),this.fetchClients()},watch:{selectedAsignHotel(a,e){if(a!==e){const b=this.projects.findIndex(U=>U.id===a);b===-1?E.get(`https://thtsystemv2.tech/public/api/v1/typebedrooms/description/${a}`,X).then(U=>{const o={id:a,description:U.data.data};this.projects.push(o),this.calculateTotal(this.projects.length-1)}):E.get(`https://thtsystemv2.tech/public/api/v1/typebedrooms/description/${a}`,X).then(U=>{this.projects[b].description=U.data.data,this.calculateTotal(b)})}},"bookinghotel.client_id"(a,e){E.get(`https://thtsystemv2.tech/public/api/v1/clients/cellphone&telephone/${a}`,X).then(b=>{this.tellephonAndCellphone=b.data.contact_numbers}).catch(b=>{console.error("Error al obtener la descripción del tour:",b)})},projects:{deep:!0,handler(a,e){this.calculateTotalForAllProjects()}},code:function(a,e){this.bookinghotel.booking_id=a},idCliente:function(a,e){this.fetchClients(),this.bookinghotel.client_id=a},idBooking:function(a,e){this.idBookingg=a}},methods:{closeEditModal(){this.$emit("close")},updateNights(a){const e=new Date(this.projects[a].date_checkin),U=new Date(this.projects[a].date_checkout).getTime()-e.getTime(),o=Math.ceil(U/(1e3*3600*24));this.projects[a].nights=o},calculateTotalForAllProjects(){let a=0;this.projects.forEach(e=>{const b=e.price||0,U=e.nights||0,o=e.quantity||1;e.subtotal=b*U*o,a+=b*U*o}),this.bookinghotel.total=a},calculateTotal(a){const e=this.projects[a],b=e.price||0,U=e.nights||0,o=e.quantity||1;e.total=b*U*o,this.calculateTotalForAllProjects()},saveReservaHotel(){const a={hotel_id:this.bookinghotel.hotel_id,client_id:this.bookinghotel.client_id,booking_id:this.idBookingg,collaborator_id:this.bookinghotel.collaborator_id,code:this.bookinghotel.code,correlative:this.bookinghotel.correlative,reference_voucher:this.bookinghotel.reference_voucher,is_external:this.bookinghotel.is_external,observation:this.bookinghotel.observation,total:this.bookinghotel.total,detailbedrooms:this.projects.map(e=>({typebedroom_id:e.id,date_checkin:e.date_checkin,date_checkout:e.date_checkout,quantity:e.quantity,guests:e.guests,nights:e.nights,price:e.price,additional:e.additional,discount:e.discount,observation:e.observation}))};E.post("https://thtsystemv2.tech/public/api/v1/hotelsbookings/create-normally",a,{...X}).then(e=>{this.$emit("postComplete",e.data);const b=R();this.closeEditModal(),b.success(e.data.message)}).catch(e=>{console.error("Error al enviar los datos al backend:",e)})},openModal(){this.showEditModal=!0},deleteProject(a){this.projects.splice(a,1)},async fetchHotels(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/hotels/list",X);this.hotelOptions=a.data.data.map(e=>({value:e.id,label:e.tradename}))}catch(a){console.error("Error al obtener los datos de los colaboradores:",a)}},async fetchClients(){try{const a=await E.get("https://thtsystemv2.tech/public/api/v1/clients/list",X);this.customerOptions=a.data.data.map(e=>({value:e.id,label:e.fullname}))}catch(a){console.error("Error fetching departments:",a)}}},computed:{limitedCustomerOptions(){return this.customerOptions.slice(0,6)}}},Ql=a=>(ke("data-v-efb78002"),a=a(),Ve(),a),Wl={name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4"},Zl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},$l={class:"flex items-center"},eo={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},lo={class:"flex items-center"},oo={class:"flex-grow mr-2"},to={class:"grid grid-cols-1"},ao={class:"flex flex-col"},no={key:0},so={class:"flex space-x-3 items-center text-left rtl:space-x-reverse"},io={key:1},co={key:2,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},ro={key:3,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},uo={key:4,class:"block w-full"},mo={key:5},po={key:6},bo={key:7},ho={key:8},vo={key:9},_o={key:10},fo={key:11,class:"action-btn text-end mr-3"},go=["onClick"],ko={class:"mt-5 self-end"},Vo={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},yo=Ql(()=>t("div",{class:"lg:col-span-1"},null,-1)),Co={class:"lg:col-span-3 flex justify-end"};function xo(a,e,b,U,o,d){const T=C("InputGroup"),r=C("FromGroup"),h=C("Select"),v=C("Textinput"),O=C("flat-pickr"),j=C("Icon"),q=C("vue-good-table"),u=C("Button"),H=C("EditProject"),n=C("Modal");return y(),B("div",null,[l(n,{title:"Registrar reserva de hotel",label:"Modal title",activeModal:b.activeModal,onClose:d.closeEditModal,sizeClass:"max-w-8xl"},{default:s(()=>[t("form",Wl,[t("div",Zl,[t("div",null,[l(r,{label:"Asociar reserva"},{default:s(()=>[l(T,{type:"tel",modelValue:o.bookinghotel.booking_id,"onUpdate:modelValue":e[0]||(e[0]=i=>o.bookinghotel.booking_id=i),placeholder:"Reserva"},null,8,["modelValue"])]),_:1})]),t("div",null,[t("div",$l,[l(r,{label:"Cliente Responsable",class:"flex-1"},{default:s(()=>[l(h,{options:d.limitedCustomerOptions,modelValue:o.bookinghotel.client_id,"onUpdate:modelValue":e[1]||(e[1]=i=>o.bookinghotel.client_id=i),class:"client-select"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[2]||(e[2]=x((...i)=>d.openModal&&d.openModal(...i),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")])]),t("div",null,[l(r,{label:"Número teléfono"},{default:s(()=>[l(T,{type:"tel",modelValue:o.tellephonAndCellphone,"onUpdate:modelValue":e[3]||(e[3]=i=>o.tellephonAndCellphone=i),placeholder:"Número de teléfono"},null,8,["modelValue"])]),_:1})])]),t("div",eo,[t("div",null,[l(r,{label:"Búsqueda de hotel"},{default:s(()=>[l(h,{options:o.hotelOptions,modelValue:o.bookinghotel.hotel_id,"onUpdate:modelValue":e[4]||(e[4]=i=>o.bookinghotel.hotel_id=i),placeholder:"Buscar hotel"},null,8,["options","modelValue"])]),_:1})]),t("div",null,[l(r,{label:"Asignar habitación"},{default:s(()=>[t("div",lo,[t("div",oo,[l(h,{options:o.bedroomOptions,modelValue:o.selectedAsignHotel,"onUpdate:modelValue":e[5]||(e[5]=i=>o.selectedAsignHotel=i),placeholder:"Seleccionar Hotel",class:"w-full"},null,8,["options","modelValue"])])])]),_:1})]),t("div",null,[l(r,{label:"N° ref. comprobante"},{default:s(()=>[l(v,{type:"text",modelValue:o.bookinghotel.reference_voucher,"onUpdate:modelValue":e[6]||(e[6]=i=>o.bookinghotel.reference_voucher=i),placeholder:"Número de referencia del comprobante"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(r,{label:"Observaciones"},{default:s(()=>[l(v,{type:"text",modelValue:o.bookinghotel.observation,"onUpdate:modelValue":e[7]||(e[7]=i=>o.bookinghotel.observation=i),placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),t("div",to,[t("div",ao,[l(q,{class:"-mx-6 mb-5",columns:o.columnsReservaHotelExpense,styleClass:" vgt-table  table-head   v-middle striped lesspadding2 listview",rows:this.projects,"sort-options":{enabled:!1}},{"table-row":s(i=>[i.column.field=="habitacion"?(y(),B("span",no,[t("div",so,W(i.row.description),1)])):I("",!0),i.column.field=="pasajeross"?(y(),B("span",io,[l(v,{type:"text",placeholder:"N° pax",modelValue:o.projects[i.index].guests,"onUpdate:modelValue":V=>o.projects[i.index].guests=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),i.column.field=="cantidad"?(y(),B("span",co,[l(v,{type:"text",placeholder:"Cant. HAB",modelValue:o.projects[i.index].quantity,"onUpdate:modelValue":V=>o.projects[i.index].quantity=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),i.column.field=="checkin"?(y(),B("span",ro,[l(O,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:o.projects[i.index].date_checkin,"onUpdate:modelValue":V=>o.projects[i.index].date_checkin=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),i.column.field=="checkout"?(y(),B("span",uo,[l(O,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:o.projects[i.index].date_checkout,"onUpdate:modelValue":V=>o.projects[i.index].date_checkout=V,onChange:V=>d.updateNights(i.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):I("",!0),i.column.field=="noches"?(y(),B("span",mo,[l(v,{type:"text",placeholder:"#Noches",modelValue:o.projects[i.index].nights,"onUpdate:modelValue":V=>o.projects[i.index].nights=V,onChange:V=>d.calculateTotal(i.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):I("",!0),i.column.field=="precio"?(y(),B("span",po,[l(v,{type:"text",placeholder:"Precio",modelValue:o.projects[i.index].price,"onUpdate:modelValue":V=>o.projects[i.index].price=V,onChange:V=>d.calculateTotal(i.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):I("",!0),i.column.field=="descuento"?(y(),B("span",bo,[l(v,{type:"text",placeholder:"Descuento",modelValue:o.projects[i.index].discount,"onUpdate:modelValue":V=>o.projects[i.index].discount=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),ge(),i.column.field=="adicional"?(y(),B("span",ho,[l(v,{type:"text",placeholder:"Adicional",modelValue:o.projects[i.index].additional,"onUpdate:modelValue":V=>o.projects[i.index].additional=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),i.column.field=="observacion"?(y(),B("span",vo,[l(v,{type:"text",placeholder:"Observacion",modelValue:o.projects[i.index].observation,"onUpdate:modelValue":V=>o.projects[i.index].observation=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),i.column.field=="subtotal"?(y(),B("span",_o,[l(v,{type:"text",placeholder:"Subtotal",modelValue:o.projects[i.index].subtotal,"onUpdate:modelValue":V=>o.projects[i.index].subtotal=V},null,8,["modelValue","onUpdate:modelValue"])])):I("",!0),i.column.field=="action"?(y(),B("div",fo,[t("div",{class:"text-xl",onClick:V=>d.deleteProject(i.index)},[l(j,{icon:"heroicons-outline:trash",class:"text-danger-500"})],8,go)])):I("",!0)]),_:1},8,["columns","rows"]),t("div",ko,[l(T,{label:"T. RESERVA S/.",class:"append",name:"hi_Fullname",type:"number",placeholder:"",modelValue:o.bookinghotel.total,"onUpdate:modelValue":e[8]||(e[8]=i=>o.bookinghotel.total=i),horizontal:"",appendIcon:"heroicons-outline:cash",classInput:"text-right"},null,8,["modelValue"])])])]),t("div",Vo,[yo,t("div",Co,[l(u,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[9]||(e[9]=x(i=>d.closeEditModal(),["prevent"]))}),l(u,{type:"submit",text:"Guardar Reserva",btnClass:"btn-dark",onClick:e[10]||(e[10]=x(i=>d.saveReservaHotel(),["prevent"]))})])])]),l(H,{activeModal:o.showEditModal,onClose:e[11]||(e[11]=i=>o.showEditModal=!1),title:"Actualizar Registro de Colaborador",onUpdateClientList:d.fetchClients},null,8,["activeModal","onUpdateClientList"])]),_:1},8,["activeModal","onClose"])])}const Ko=se(Xl,[["render",xo],["__scopeId","data-v-efb78002"]]);export{Jo as A,Yo as C,Ko as E,he as _};
