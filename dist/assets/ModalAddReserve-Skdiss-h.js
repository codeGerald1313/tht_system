import{C as oe}from"./index-Hsd0Z0_R.js";import{B as re}from"./index-B_wjOnuw.js";import{I as te}from"./index-BcFOD9Ey.js";import{F as x}from"./index-I9bOp0dW.js";import{I as W}from"./index-DCC49QXr.js";import{V as ae}from"./VueSelect-DI5dOEtm.js";import{T as ue}from"./TotalTable-Da2l-zhh.js";import{M as Z}from"./index-MSlXG-Ka.js";import{S as N}from"./index-DPFbVGd7.js";import{T as P}from"./index-BTHsGrD3.js";import{D as ne}from"./index-DFq5MbAK.js";import{b as D,u as $,q as T,G as R,c as E,o as M,l as ge,h as s,f as t,w as A,e as l,j as d,d as B,p as w,J as S,F as me,t as ee,H as _e,I as Q,i as fe,z as ke,A as Ve}from"./index-BLl1OigC.js";import{B as H}from"./index-DCMPjbua.js";import{u as le}from"./project-DZP6XSnf.js";import{T as pe}from"./index-CwPxZwdQ.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as ie}from"./menu-CM83wd2-.js";import{C as ye}from"./index-lgafHr2M.js";import{P as Ce}from"./index-C66Q9vME.js";import{a as xe}from"./basic-tablle-data-AN7MRnVF.js";const Me={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ee={key:0,class:"text-red-500"},Be={key:0,class:"text-red-500"},Se={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ae={class:"grid lg:grid-cols-3 gap-4"},Ue={key:0,class:"text-red-500"},Ie={class:"grid lg:grid-cols-3 gap-4"},we={class:"form-group col-lg-12 form__footerBtn"},Te={class:"text-right mt-6"},Oe={__name:"CollaboratorAddModalCommision",props:{activeModal:Boolean},emits:["close","updateColaboradorList"],setup(a,{emit:e}){le();const b=D(),I=$().headers(),o=a,u=e,k=()=>{u("close")},i=T({partnercompany_id:"",vehicletype_id:"",fullname:"",document:"",cellphone:"",email:"",address:"",date_birthday:"",sex:"",status:"",partnercompany:"",vehicletype:""}),V=T(null),_=T(null),j=T(null),O=T(null),L=[{label:"Seleccione"},{label:"Soltero"},{label:"Casado"},{label:"Otros"}],n=[{label:"Seleccione"},{label:"Masculino"},{label:"Femenino"},{label:"Otros"}],K=[{label:"Mototaxi",value:"Mototaxi"},{label:"Auto",value:"Auto"},{label:"H350",value:"H350"},{label:"Techo Alto",value:"Techo Alto"}],p=C=>!!i.value[C],c=C=>p(C),y=()=>{S.post("https://thtbackend-production.up.railway.app/api/v1/collaborators/create",i.value,{...I}).then(C=>{console.log("Datos guardados exitosamente:",C.data),u("updateColaboradorList"),k(),b.success(C.data.message)}).catch(C=>{console.error("Error al guardar los datos:",C)})},G=[{label:"GUAROS GROUP",value:"GUAROS GROUP"}],z=()=>{S.get(`https://thtbackend-production.up.railway.app/api/v1/apidni/${i.value.document}`).then(C=>{console.log("Respuesta de la API DNI:",C.data),i.value.fullname=`${C.data.nombres} ${C.data.apellidoPaterno} ${C.data.apellidoMaterno}`}).catch(C=>{console.error("Error al obtener datos del DNI:",C)})};return R(()=>V.value,(C,g)=>{const U=document.querySelector(".state-select select");if(U){const v=U.selectedIndex,q=U.options[v].text;i.value.status=q,console.log("Label seleccionado:",i.value.status)}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>_.value,(C,g)=>{const U=document.querySelector(".sexo-select select");if(U){const v=U.selectedIndex,q=U.options[v].text;i.value.sex=q,console.log("Label seleccionado:",i.value.sex)}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>j.value,(C,g)=>{const U=document.querySelector(".partercompany-select select");if(U){const v=U.selectedIndex,q=U.options[v].text;i.value.partnercompany_id=v,i.value.partnercompany=q,console.log("Label seleccionado:",i.value.partnercompany_id,i.value.partnercompany)}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>O.value,(C,g)=>{const U=document.querySelector(".typevehiculo-select select");if(U){const v=U.selectedIndex,q=U.options[v].text;i.value.vehicletype_id=v,i.value.vehicletype=q,console.log("Label seleccionado:",i.value.vehicletype_id,i.value.vehicletype)}else console.log("No se ha seleccionado ninguna opción.")}),(C,g)=>{const U=E("flat-pickr");return M(),ge(d(Z),{activeModal:o.activeModal,onClose:k,title:"Registrar nuevo Colaborador",sizeClass:"max-w-5xl",centered:""},{default:s(()=>[t("form",{onSubmit:g[10]||(g[10]=A((...v)=>C.addProject&&C.addProject(...v),["prevent"])),class:"space-y-4 col-span-3"},[t("div",Me,[t("div",null,[l(d(x),{label:"N° Documento"},{default:s(()=>[l(d(W),{type:"text",placeholder:"DNI",modelValue:i.value.document,"onUpdate:modelValue":g[0]||(g[0]=v=>i.value.document=v)},{append:s(()=>[l(d(H),{text:"RENIEC",btnClass:"btn-outline-dark ",onClick:A(z,["prevent"])})]),_:1},8,["modelValue"]),c("document")?w("",!0):(M(),B("span",Ee,"Por favor ingresa un número válido"))]),_:1})]),t("div",null,[l(d(x),{label:"Nombres completos"},{default:s(()=>[l(d(P),{type:"text",modelValue:i.value.fullname,"onUpdate:modelValue":g[1]||(g[1]=v=>i.value.fullname=v),modelModifiers:{trim:!0},placeholder:"Ingresar nombre completo"},null,8,["modelValue"]),c("fullname")?w("",!0):(M(),B("span",Be,"Por favor ingresa un nombre válido"))]),_:1})])]),t("div",Se,[t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:G,label:"Empresa socia",modelValue:j.value,"onUpdate:modelValue":g[2]||(g[2]=v=>j.value=v),class:"partercompany-select",placeholder:"Seleccione Empresa"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:K,label:"Tipo vehículo",modelValue:O.value,"onUpdate:modelValue":g[3]||(g[3]=v=>O.value=v),class:"typevehiculo-select",placeholder:"Seleccione Vehículo"},null,8,["modelValue"])]),_:1})])]),t("div",Ae,[t("div",null,[l(d(x),{label:"Celular"},{default:s(()=>[l(d(P),{type:"text",modelValue:i.value.cellphone,"onUpdate:modelValue":g[4]||(g[4]=v=>i.value.cellphone=v),modelModifiers:{trim:!0},placeholder:"Ingrese número de celular"},null,8,["modelValue"]),c("cellphone")?w("",!0):(M(),B("span",Ue,"Por favor ingrese número valido"))]),_:1})]),t("div",null,[l(d(x),{label:"Dirección"},{default:s(()=>[l(d(P),{type:"text",placeholder:"Ingrese dirección",name:"client_direccion",modelValue:i.value.address,"onUpdate:modelValue":g[5]||(g[5]=v=>i.value.address=v),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),{label:"Correo electrónico"},{default:s(()=>[l(d(P),{type:"email",placeholder:"Ingrese el correo electrónico",name:"client_email",modelValue:i.value.email,"onUpdate:modelValue":g[6]||(g[6]=v=>i.value.email=v),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})])]),t("div",Ie,[t("div",null,[l(d(x),{label:"Fecha de nacimiento"},{default:s(()=>[l(U,{modelValue:i.value.date_birthday,"onUpdate:modelValue":g[7]||(g[7]=v=>i.value.date_birthday=v),class:"form-control",id:"date_birthday",placeholder:"yyyy, dd M",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"}},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:L,label:"Estado",modelValue:V.value,"onUpdate:modelValue":g[8]||(g[8]=v=>V.value=v),class:"state-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:n,label:"Sexo",modelValue:_.value,"onUpdate:modelValue":g[9]||(g[9]=v=>_.value=v),class:"sexo-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})])]),t("div",we,[t("div",Te,[l(d(H),{text:"Cancelar",btnClass:"btn-light mr-2",onClick:k}),l(d(H),{type:"submit",text:"Guardar Cambios",btnClass:"btn-dark",onClick:y})])])],32)]),_:1},8,["activeModal"])}}};le();const J=$().headers(),Ne={data(){return{show3:!1,show4:!1,valorCode:"",showColabardorModal:!1,commission_data:{user_id:null,nro_voucher_external:null,accountbank_id:null,booking_id:null,collaborator_id:null,paymentmethod_id:null,branchoffice_id:null,total_hotel:"0.00",total_tour:"0.00",observation:null,branchoffice_id:1,is_paid:null,total_commission:"0.00"},bank:{description:""},accountBank:{branchoffice_id:0,bank_id:0,typeaccount_id:0,currency_id:0,name:"",number_account:"",cci_account:"",balance:0,headline:"",description:""},currency:[{value:1,label:"SOL"},{value:2,label:"DÓLAR"},{value:3,label:"EURO"}],branchoffices:[{value:1,label:"Oficina Principal"}],typeaccount:[{value:1,label:"CUENTA SIMPLE"},{value:2,label:"CUENTA CORRIENTE"},{value:3,label:"TARJETA DE CRÉDITO"}],paymentMethods:[{value:1,label:"Efectivo"},{value:2,label:"Visa"},{value:3,label:"Cheque"},{value:4,label:"Depósito a cuenta"}],boxesOptions:[{value:1,label:"Caja Principal"}],colaboratorOptions:[],accountOptions:[],banks:[]}},components:{Card:oe,Icon:te,FromGroup:x,Button:H,Dropdown:ne,EditProject2:Oe,InputGroup:W,Textinput:P,Select:N,VueSelect:ae,TotalTable:ue,Textarea:pe,MenuItem:ie,Modal:Z,Breadcrumb:re},props:{activeModal:Boolean,code:String,idBooking:String},watch:{"commission_data.total_hotel":function(a,e){this.calculateTotalCommission()},"commission_data.total_tour":function(a,e){this.calculateTotalCommission()},code:function(a,e){this.valorCode=a},idBooking:function(a,e){this.commission_data.booking_id=a,console.log("El valor idBooking es",a)},"commission_data.paymentmethod_id":function(a,e){a!=null&&a!==""&&(this.commission_data.paymentmethod_id=parseInt(a))}},emits:["close"],methods:{closeEditModal(){this.$emit("close")},calculateTotalCommission(){const a=parseFloat(this.commission_data.total_hotel),e=parseFloat(this.commission_data.total_tour);isNaN(a)||isNaN(e)||a===null||e===null||a.toString().trim()===""||e.toString().trim()===""?this.commission_data.total_commission="Error: Los valores deben ser numéricos":this.commission_data.total_commission=a+e},openModalBanck(){this.show4=!0},async guardarCambiosAccountBank(){const a=D();try{const e=await S.post("https://thtbackend-production.up.railway.app/api/v1/accountbanks/create",this.accountBank,{...J});this.fetchAccountBanks(),this.closeModalEditAccountBank(),a.success("¡Cambios guardados en la cuenta bancaria exitosamente!"),console.log("Respuesta de la solicitud POST para guardar cambios en la cuenta bancaria:",e.data)}catch(e){a.error("Error al guardar cambios en la cuenta bancaria. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en la cuenta bancaria:",e)}},async guardarCambiosBank(){const a=D();try{const e=await S.post("https://thtbackend-production.up.railway.app/api/v1/banks/create",this.bank,{...J});this.fetchBanks(),this.closeEditModalBank(),a.success("¡Cambios guardados en el banco exitosamente!"),console.log("Respuesta de la solicitud POST para guardar cambios en el banco:",e.data)}catch(e){a.error("Error al guardar cambios en el banco. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en el banco:",e)}},closeEditModalBank(){this.show4=!1},openModaalBanckAccount(){this.show3=!0},openModalColaborador(){this.showColabardorModal=!0},closeModalEditAccountBank(){this.show3=!1},submitForm(){const a=D();this.commission_data.paymentmethod_id=parseInt(this.commission_data.paymentmethod_id),console.log(this.commission_data),S.post("https://thtbackend-production.up.railway.app/api/v1/commisions/create",this.commission_data,{...J}).then(e=>{this.$emit("commissionProcessed",e),this.closeEditModal(),a.success("¡La comisión se procesó exitosamente!")}).catch(e=>{if(console.error("Error al guardar los datos:",e),e.response&&e.response.data&&e.response.data.message){const b=D();this.closeEditModal();const I=e.response.data.message;b.error(I)}else a.error("Ha ocurrido un error al guardar los datos. Por favor, inténtalo de nuevo.")})},async listarColaboradores(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/collaborators/list",J);this.colaboratorOptions=a.data.data.map(e=>({value:e.id,label:e.fullname}))}catch(a){console.error("Error al obtener los datos de los empleados:",a)}},async fetchAccountBanks(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/accountbanks/list",J);this.accountOptions=a.data.data.map(e=>({value:e.id,label:e.name}))}catch(a){console.error("Error fetching departments:",a)}},async fetchBanks(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/banks/list",J);this.banks=a.data.data.map(e=>({value:e.id,label:e.description}))}catch(a){console.error("Error fetching banks:",a)}}},mounted(){this.fetchBanks(),this.listarColaboradores(),this.fetchAccountBanks()},computed:{limitedCustomerOptions(){return this.colaboratorOptions.slice(0,6)}}},je={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Pe={class:"flex items-center"},Re={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},De={class:"flex items-center"},Le={class:"text-[32px] leading-10 font-medium text-blue-800"},qe={class:"grid grid-cols-1"},He={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Fe=t("div",{class:"lg:col-span-1"},null,-1),Ge={class:"lg:col-span-3 flex justify-end"},ze={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},Je={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ye={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Xe={class:"flex items-center"},Ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Qe={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},We=t("div",{class:"lg:col-span-3"},null,-1),Ze={class:"lg:col-span-1 flex justify-end"},$e={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},el={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},ll=t("div",{class:"lg:col-span-3"},null,-1),ol={class:"lg:col-span-1 flex justify-end"};function tl(a,e,b,I,o,u){const k=E("Select"),i=E("FromGroup"),V=E("Textinput"),_=E("Button"),j=E("Textarea"),O=E("Modal"),L=E("EditProject2");return M(),B("div",null,[l(O,{title:"Comisionar reserva | "+o.valorCode,label:"Modal title",activeModal:b.activeModal,onClose:u.closeEditModal,sizeClass:"max-w-4xl"},{default:s(()=>[t("form",{name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4",onSubmit:e[11]||(e[11]=A((...n)=>u.submitForm&&u.submitForm(...n),["prevent"]))},[t("div",je,[t("div",Pe,[l(i,{label:"Colaborador",class:"flex-1"},{default:s(()=>[l(k,{options:u.limitedCustomerOptions,modelValue:o.commission_data.collaborator_id,"onUpdate:modelValue":e[0]||(e[0]=n=>o.commission_data.collaborator_id=n),class:"client-select",placeholder:"Colaborador a comisionar"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[1]||(e[1]=(...n)=>u.openModalColaborador&&u.openModalColaborador(...n)),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),t("div",null,[l(i,{label:"Caja aperturada"},{default:s(()=>[l(k,{options:o.boxesOptions,modelValue:o.commission_data.branchoffice_id,"onUpdate:modelValue":e[2]||(e[2]=n=>o.commission_data.branchoffice_id=n),disabled:"",placeholder:"Seleccionar caja"},null,8,["options","modelValue"])]),_:1})])]),t("div",Re,[t("div",null,[l(i,{label:"Método de pago"},{default:s(()=>[l(k,{modelValue:o.commission_data.paymentmethod_id,"onUpdate:modelValue":e[3]||(e[3]=n=>o.commission_data.paymentmethod_id=n),options:o.paymentMethods,placeholder:"Seleccionar método de pago"},null,8,["modelValue","options"])]),_:1})]),o.commission_data.paymentmethod_id===4?(M(),B(me,{key:0},[t("div",De,[l(i,{label:"Cuenta destino",class:"flex-1"},{default:s(()=>[l(k,{options:o.accountOptions,modelValue:o.commission_data.accountbank_id,"onUpdate:modelValue":e[4]||(e[4]=n=>o.commission_data.accountbank_id=n),class:"cuentadestino-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[5]||(e[5]=A((...n)=>u.openModaalBanckAccount&&u.openModaalBanckAccount(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),l(i,{label:"N° de Operación"},{default:s(()=>[l(V,{type:"text",modelValue:o.commission_data.nro_voucher_external,"onUpdate:modelValue":e[6]||(e[6]=n=>o.commission_data.nro_voucher_external=n),placeholder:"Ingrese N° de Operación"},null,8,["modelValue"])]),_:1})],64)):w("",!0),t("div",null,[l(i,{label:"Comisión Hotel"},{default:s(()=>[l(V,{modelValue:o.commission_data.total_hotel,"onUpdate:modelValue":e[7]||(e[7]=n=>o.commission_data.total_hotel=n),type:"text",placeholder:"Comisión Hotel"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"Comisión Tours"},{default:s(()=>[l(V,{modelValue:o.commission_data.total_tour,"onUpdate:modelValue":e[8]||(e[8]=n=>o.commission_data.total_tour=n),type:"text",placeholder:"Comisión Tours"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"TOTAL COMISIÓN",class:"text-center"},{default:s(()=>[t("p",null,[t("span",Le,"S/ "+ee(o.commission_data.total_commission),1)])]),_:1})])]),t("div",qe,[t("div",null,[l(i,{label:"Observación"},{default:s(()=>[l(V,{modelValue:o.commission_data.observation,"onUpdate:modelValue":e[9]||(e[9]=n=>o.commission_data.observation=n),type:"textarea",placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),t("div",He,[Fe,t("div",Ge,[l(_,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[10]||(e[10]=A(n=>u.closeEditModal(),["prevent"]))}),l(_,{type:"submit",text:"Procesar Comisión",btnClass:"btn-dark"})])])],32),l(O,{title:"Registrar cuenta bancaria",label:"Modal title",activeModal:o.show3,onClose:u.closeModalEditAccountBank},{default:s(()=>[t("form",ze,[t("div",Je,[t("div",null,[l(i,{label:"Sucursal",class:"block"},{default:s(()=>[l(k,{modelValue:o.accountBank.branchoffice_id,"onUpdate:modelValue":e[12]||(e[12]=n=>o.accountBank.branchoffice_id=n),options:o.branchoffices,required:"",class:"oficinaprincipal-select"},null,8,["modelValue","options"])]),_:1})]),t("div",null,[l(i,{label:"Tipo de cuenta",class:"block"},{default:s(()=>[l(k,{modelValue:o.accountBank.typeaccount_id,"onUpdate:modelValue":e[13]||(e[13]=n=>o.accountBank.typeaccount_id=n),options:o.typeaccount,required:"",class:"typeaccount-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",Ye,[t("div",Xe,[l(i,{label:"Banco",class:"flex-1"},{default:s(()=>[l(k,{options:o.banks,modelValue:o.accountBank.bank_id,"onUpdate:modelValue":e[14]||(e[14]=n=>o.accountBank.bank_id=n),class:"banck-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[15]||(e[15]=A((...n)=>u.openModalBanck&&u.openModalBanck(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),t("div",null,[l(i,{label:"Moneda",class:"block"},{default:s(()=>[l(k,{modelValue:o.accountBank.currency_id,"onUpdate:modelValue":e[16]||(e[16]=n=>o.accountBank.currency_id=n),options:o.currency,required:"",class:"money-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",null,[l(i,{label:"Nombre cuenta",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.name,"onUpdate:modelValue":e[17]||(e[17]=n=>o.accountBank.name=n),placeholder:"Nombre cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",Ke,[t("div",null,[l(i,{label:"N° de cuenta",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.number_account,"onUpdate:modelValue":e[18]||(e[18]=n=>o.accountBank.number_account=n),placeholder:"N° de cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"N° CCI (Código interbancario)",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.cci_account,"onUpdate:modelValue":e[19]||(e[19]=n=>o.accountBank.cci_account=n),placeholder:"N° CCI",required:""},null,8,["modelValue"])]),_:1})])]),t("div",null,[l(i,{label:"Titular cuenta",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.headline,"onUpdate:modelValue":e[20]||(e[20]=n=>o.accountBank.headline=n),placeholder:"Titular cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"Descripción",class:"block"},{default:s(()=>[l(j,{modelValue:o.accountBank.description,"onUpdate:modelValue":e[21]||(e[21]=n=>o.accountBank.description=n),placeholder:"Descripción"},null,8,["modelValue"])]),_:1})]),t("div",Qe,[We,t("div",Ze,[l(_,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:A(u.closeModalEditAccountBank,["prevent"])},null,8,["onClick"]),l(_,{type:"submit",text:"Guardar Cambios",onClick:A(u.guardarCambiosAccountBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])]),l(O,{title:"Registrar banco",label:"Modal title",activeModal:o.show4,onClose:e[23]||(e[23]=n=>o.show4=!1)},{default:s(()=>[t("form",$e,[l(V,{modelValue:o.bank.description,"onUpdate:modelValue":e[22]||(e[22]=n=>o.bank.description=n),label:"Nombre",name:"pn",type:"text",placeholder:"Ingresar nombre "},null,8,["modelValue"]),t("div",el,[ll,t("div",ol,[l(_,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:A(u.closeEditModalBank,["prevent"])},null,8,["onClick"]),l(_,{type:"submit",text:"Guardar Cambios",onClick:A(u.guardarCambiosBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])])]),_:1},8,["activeModal"])]),_:1},8,["activeModal","onClose"]),l(L,{activeModal:o.showColabardorModal,title:"Actualizar Registro de Colaborador",onUpdateColaboradorList:u.listarColaboradores,onClose:e[24]||(e[24]=n=>o.showColabardorModal=!1)},null,8,["activeModal","onUpdateColaboradorList"])]),_:1},8,["title","activeModal","onClose"])])}const Ho=se(Ne,[["render",tl]]),al={name:"client_form",id:"client_form",autocomplete:"off",class:"mx-auto space-y-4"},nl={class:"grid grid-cols-3 lg:grid-cols-3 gap-4"},sl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},il={class:"lg:col-span-3"},cl=t("div",{class:"lg:hidden"},null,-1),dl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},rl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},ul={class:"lg:col-span-3"},ml=t("div",{class:"lg:hidden"},null,-1),pl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},bl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},hl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},vl=t("div",{class:"lg:col-span-1"},null,-1),gl={class:"lg:col-span-3 flex justify-end"},be={__name:"ClientAddModal",props:{activeModal:Boolean},emits:["close","updateClientList"],setup(a,{emit:e}){le();const b=$().headers(),I=D(),o=a,u=e,k=()=>{u("close")},i=T([]),V=T([]),_=T([]),j=async()=>{try{const h=await S.get("https://thtbackend-production.up.railway.app/api/v1/ubigeo/departments",b);i.value=h.data.data.map(m=>({value:m.id,label:m.name}))}catch(h){console.error("Error fetching departments:",h)}},O=[{value:1,label:"Natural"},{value:2,label:"Jurídico"}],L=[{value:1,label:"DNI"},{value:2,label:"RUC"},{value:3,label:"PASAPORTE"}],n=[{id:1,label:"Soltero"},{id:2,label:"Casado"},{id:2,label:"Viudo"},{id:2,label:"Divorciado"}],K=[{id:1,label:"Masculino"},{id:2,label:"Femenino"}],p=T({typedocument_id:"",department_id:"",province_id:"",district_id:"",type_client:"",fullname:"",document:"",tradename:"",address:"",email:"",telephone:"",cellphone:"",date_birthday:"",sex:"",status:"",typeDocument:""}),c=T(O[0].value),y=T(L[0].value);let G=T(null),z=T(null),C=T(null),g=T(null),U=T(null);const v=()=>{console.log(p.value);const h=document.querySelector(".typecliente-select select");if(h){const f=h.selectedIndex,r=f.toString();h.options[f].text,p.value.type_client=r,console.log("Label seleccionado:",p.value.type_client),console.log("Índice seleccionado como cadena:",r)}else console.log("No se ha seleccionado ninguna opción.");const m=document.querySelector(".typedocument-select select");if(h){const f=m.selectedIndex,r=m.options[f].text;p.value.typedocument_id=f,p.value.typeDocument=r,console.log("Id & Label seleccionado:",p.value.type_client)}else console.log("No se ha seleccionado ninguna opción.");S.post("https://thtbackend-production.up.railway.app/api/v1/clients/create",p.value,{...b}).then(f=>{console.log("Datos guardados exitosamente:",f.data),u("updateClientList"),k(),I.success(f.data.message)}).catch(f=>{console.error("Error al guardar los datos:",f)})},q=()=>{S.get(`https://thtbackend-production.up.railway.app/api/v1/apidni/${p.value.document}`).then(h=>{console.log("Respuesta de la API DNI:",h.data),p.value.fullname=`${h.data.nombres} ${h.data.apellidoPaterno} ${h.data.apellidoMaterno}`}).catch(h=>{console.error("Error al obtener datos del DNI:",h)})},he=async()=>{try{const h=await S.get(`https://thtbackend-production.up.railway.app/api/v1/ubigeo/provinces/${p.value.department_id}`,b);_.value=h.data.data.map(m=>({value:m.id,label:m.name}))}catch(h){console.error("Error fetching provinces:",h)}},ve=async()=>{try{const h=await S.get(`https://thtbackend-production.up.railway.app/api/v1/ubigeo/districts/${p.value.province_id}`,b);V.value=h.data.data.map(m=>({value:m.id,label:m.name}))}catch(h){console.error("Error fetching provinces:",h)}};R(()=>U.value,(h,m)=>{const f=document.querySelector(".sexo-select select");if(f){const r=f.selectedIndex,F=f.options[r].text;p.value.sex=F,console.log("Label seleccionado:",p.value.sex)}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>g.value,(h,m)=>{const f=document.querySelector(".state-select select");if(f){const r=f.selectedIndex,F=f.options[r].text;p.value.status=F,console.log("Label seleccionado:",p.value.status)}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>C.value,(h,m)=>{if(document.querySelector(".district-select select")){const r=h.toString().padStart(6,"0");console.log("Id seleccionado:",r),p.value.district_id=r}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>z.value,(h,m)=>{if(document.querySelector(".province-select select")){const r=h.toString().padStart(4,"0");console.log("Id seleccionado:",r),p.value.province_id=r}else console.log("No se ha seleccionado ninguna opción.")}),R(()=>G.value,(h,m)=>{if(document.querySelector(".department-select select")){const r=h.toString().padStart(2,"0");console.log("Id seleccionado:",r),p.value.department_id=r}else console.log("No se ha seleccionado ninguna opción.")});const ce=T("N° DNI"),de=T("RENIEC");return R(()=>y.value,h=>{const m=document.querySelector(".typedocument-select select");if(m){const f=m.selectedIndex,r=m.options[f],F=m.options[f].text;p.value.typedocument_id=f,p.value.typeDocument=F,ce.value=`N° ${r.textContent}`,de.value=h==="1"?"RENIEC":h==="2"?"SUNAT":"Validar",console.log(p.value.typeDocument)}else console.log("No se ha encontrado el elemento del selector.")}),R(()=>c.value,(h,m)=>{const f=document.querySelector(".typecliente-select select");if(f){const r=f.selectedIndex,F=r.toString();f.options[r].text,p.value.type_client=F,console.log("Label seleccionado:",p.value.type_client),console.log("Índice seleccionado como cadena:",F)}else console.log("No se ha seleccionado ninguna opción.")}),_e(()=>{j()}),(h,m)=>{const f=E("flat-pickr");return M(),B("div",null,[l(d(Z),{activeModal:o.activeModal,onClose:k,title:"Registrar nuevo Cliente",sizeClass:"max-w-4xl",centered:""},{default:s(()=>[t("form",al,[t("div",nl,[t("div",null,[l(d(x),{label:"Tipo de cliente"},{default:s(()=>[l(d(N),{options:O,modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=r=>c.value=r),class:"typecliente-select",placeholder:"Seleccione Cliente"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),{label:"Tipo documento"},{default:s(()=>[l(d(N),{options:L,modelValue:y.value,"onUpdate:modelValue":m[1]||(m[1]=r=>y.value=r),class:"typedocument-select"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),{label:"N° Documento"},{default:s(()=>[l(d(W),{type:"text",placeholder:ce.value,modelValue:p.value.document,"onUpdate:modelValue":m[2]||(m[2]=r=>p.value.document=r)},{append:s(()=>[l(d(H),{text:de.value,btnClass:"btn-outline-dark",onClick:A(q,["prevent"])},null,8,["text"])]),_:1},8,["placeholder","modelValue"])]),_:1})])]),t("div",sl,[t("div",il,[l(d(x),{label:"Nombre ó Razón Social"},{default:s(()=>[l(d(P),{type:"text",id:"client_fullname",modelValue:p.value.fullname,"onUpdate:modelValue":m[3]||(m[3]=r=>p.value.fullname=r),modelModifiers:{trim:!0},placeholder:"Ingrese Nombre ó Razón Social "},null,8,["modelValue"])]),_:1})]),cl]),t("div",dl,[t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:i.value,label:"Departamento",modelValue:d(G),"onUpdate:modelValue":m[4]||(m[4]=r=>Q(G)?G.value=r:G=r),class:"department-select",onChange:he},null,8,["options","modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:_.value,label:"Provincias",modelValue:d(z),"onUpdate:modelValue":m[5]||(m[5]=r=>Q(z)?z.value=r:z=r),class:"province-select",onChange:ve,placeholder:""},null,8,["options","modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:V.value,label:"Distritos",modelValue:d(C),"onUpdate:modelValue":m[6]||(m[6]=r=>Q(C)?C.value=r:C=r),class:"district-select",placeholder:""},null,8,["options","modelValue"])]),_:1})])]),t("div",rl,[t("div",ul,[l(d(x),{label:"Dirección"},{default:s(()=>[l(d(P),{type:"text",modelValue:p.value.address,"onUpdate:modelValue":m[7]||(m[7]=r=>p.value.address=r),modelModifiers:{trim:!0},placeholder:"Ingrese Direción"},null,8,["modelValue"])]),_:1})]),ml]),t("div",pl,[t("div",null,[l(d(x),{label:"Celular"},{default:s(()=>[l(d(P),{type:"text",modelValue:p.value.cellphone,"onUpdate:modelValue":m[8]||(m[8]=r=>p.value.cellphone=r),modelModifiers:{trim:!0},placeholder:"Ingrese N° de celular"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),{label:"Teléfono fijo"},{default:s(()=>[l(d(P),{type:"text",modelValue:p.value.telephone,"onUpdate:modelValue":m[9]||(m[9]=r=>p.value.telephone=r),modelModifiers:{trim:!0},placeholder:"Ingrese N° de telefono fijo"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),{label:"Correo electrónico"},{default:s(()=>[l(d(P),{type:"email",modelValue:p.value.email,"onUpdate:modelValue":m[10]||(m[10]=r=>p.value.email=r),modelModifiers:{trim:!0},placeholder:"Ingrese correo electrónico"},null,8,["modelValue"])]),_:1})])]),t("div",bl,[t("div",null,[l(d(x),{label:"Fecha de nacimiento"},{default:s(()=>[l(f,{modelValue:p.value.date_birthday,"onUpdate:modelValue":m[11]||(m[11]=r=>p.value.date_birthday=r),class:"form-control",id:"date_birthday",placeholder:"yyyy, dd M",config:{altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"}},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:n,label:"Estado",modelValue:d(g),"onUpdate:modelValue":m[12]||(m[12]=r=>Q(g)?g.value=r:g=r),class:"state-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(d(x),null,{default:s(()=>[l(d(N),{options:K,label:"Sexo",modelValue:d(U),"onUpdate:modelValue":m[13]||(m[13]=r=>Q(U)?U.value=r:U=r),class:"sexo-select",placeholder:"Seleccione"},null,8,["modelValue"])]),_:1})])]),t("div",hl,[vl,t("div",gl,[l(d(H),{text:"Cancelar",btnClass:"btn-light mr-2",onClick:A(k,["prevent"])}),l(d(H),{type:"submit",text:"Guardar Cambios",btnClass:"btn-dark",onClick:A(v,["prevent"])})])])])]),_:1},8,["activeModal"])])}}};le();const Y=$().headers(),_l={data(){return{show3:!1,show4:!1,showEditModal:!1,income:{totalAPagar:0,totalRestante:0,receptor_module:null,receptor_fullname:null,receptor_document:null,is_paycredit:null,available_edit:null,user_id:null,branchoffice_id:1,concept_id:null,paymentmethod_id:null,currency_id:null,voucher_id:null,client_id:null,provider_id:null,employee_id:null,accountbank_id:null,date_movement:null,amount:null,text_amount:null,gloss:"",reference_operation:null,nro_voucher:null,serie:null,correlative:null,billing_external_id:null,billing_hash:null,motive_cancelled:null,billing_cancelled:null,date_repayment:null,repaymentmovement_id:null,dischargedocument_id:null,is_voucher_external:null,voucher_external:null,nro_voucher_external:null,booking_id:null,commission_id:null,observation:null,is_visible:null},paymentMethods:[{value:1,label:"Efectivo"},{value:2,label:"Visa"},{value:3,label:"Cheque"},{value:4,label:"Depósito a cuenta"}],clienteOptions:[{value:1,label:"Cliente 1"},{value:2,label:"Cliente 2"},{value:3,label:"Cliente 3"}],branchboxOptions:[{value:1,label:"Caja 1"},{value:2,label:"Caja 2"},{value:3,label:"Caja 3"}],branchoffices:[{value:1,label:"Oficina Principal"}],typeaccount:[{value:1,label:"CUENTA SIMPLE"},{value:2,label:"CUENTA CORRIENTE"},{value:3,label:"TARJETA DE CRÉDITO"}],currency:[{value:1,label:"SOL"},{value:2,label:"DÓLAR"},{value:3,label:"EURO"}],bank:{description:""},accountBank:{branchoffice_id:0,bank_id:0,typeaccount_id:0,currency_id:0,name:"",number_account:"",cci_account:"",balance:0,headline:"",description:""},boxesOptions:[{value:1,label:"Caja Principal"}],banks:[],valorCode:"",accountOptions:[],customerOptions:[]}},components:{Card:oe,Icon:te,FromGroup:x,Button:H,Dropdown:ne,EditProject:be,InputGroup:W,Textinput:P,Select:N,VueSelect:ae,Textarea:pe,TotalTable:ue,MenuItem:ie,Modal:Z,Breadcrumb:re},props:{activeModal:Boolean,idCliente:String,totalBooking:String,code:String,idBooking:String},emits:["close"],methods:{closeEditModal(){this.$emit("close")},openModal(){this.showEditModal=!0},openModalBanck(){this.show4=!0},closeEditModalBank(){this.show4=!1},openModaalBanckAccount(){this.show3=!0},closeModalEditAccountBank(){this.show3=!1},async guardarCambiosAccountBank(){const a=D();try{const e=await S.post("https://thtbackend-production.up.railway.app/api/v1/accountbanks/create",this.accountBank,{...Y});this.fetchAccountBanks(),this.closeModalEditAccountBank(),a.success("¡Cambios guardados en la cuenta bancaria exitosamente!"),console.log("Respuesta de la solicitud POST para guardar cambios en la cuenta bancaria:",e.data)}catch(e){a.error("Error al guardar cambios en la cuenta bancaria. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en la cuenta bancaria:",e)}},async guardarCambiosBank(){const a=D();try{const e=await S.post("https://thtbackend-production.up.railway.app/api/v1/banks/create",this.bank,{...Y});this.fetchBanks(),this.closeEditModalBank(),a.success("¡Cambios guardados en el banco exitosamente!"),console.log("Respuesta de la solicitud POST para guardar cambios en el banco:",e.data)}catch(e){a.error("Error al guardar cambios en el banco. Por favor, intenta nuevamente."),console.error("Error al enviar la solicitud POST para guardar cambios en el banco:",e)}},async fetchBanks(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/banks/list",Y);this.banks=a.data.data.map(e=>({value:e.id,label:e.description}))}catch(a){console.error("Error fetching banks:",a)}},submitForm(){this.income.paymentmethod_id=parseInt(this.income.paymentmethod_id),console.log(this.income),S.post("https://thtbackend-production.up.railway.app/api/v1/moneys/create-booking-income",this.income,{...Y}).then(a=>{const e=D();this.$emit("form-submitted",a.data),this.closeEditModal(),e.success(a.data.message),console.log("Respuesta del servidor:",a.data)}).catch(a=>{if(console.error("Error al guardar los datos:",a),a.response&&a.response.data&&a.response.data.message){const e=D();this.closeEditModal();const b=a.response.data.message;e.error(b)}else toast.error("Ha ocurrido un error al guardar los datos. Por favor, inténtalo de nuevo.")})},async fetchAccountBanks(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/accountbanks/list",Y);this.accountOptions=a.data.data.map(e=>({value:e.id,label:e.name}))}catch(a){console.error("Error fetching departments:",a)}},async fetchClients(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/clients/list",Y);this.customerOptions=a.data.data.map(e=>({value:e.id,label:e.fullname})),console.log("Chi")}catch(a){console.error("Error fetching departments:",a)}}},mounted(){this.fetchAccountBanks(),this.fetchClients(),this.fetchBanks()},watch:{"income.amount":function(a,e){console.log(a),this.income.totalRestante=this.income.totalAPagar-a},idCliente:function(a,e){this.fetchClients(),this.income.client_id=a},totalBooking:function(a,e){const b=parseInt(a.replace(",",""),10);console.log(b),this.income.totalAPagar=b},code:function(a,e){this.valorCode=a},idBooking:function(a,e){this.income.booking_id=a,console.log("El valor idBooking es",a)},"income.paymentmethod_id":function(a,e){a!=null&&a!==""&&(this.income.paymentmethod_id=parseInt(a))}},computed:{limitedCustomerOptions(){return this.customerOptions.slice(0,6)}}},fl={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},kl={class:"flex items-center"},Vl={key:0,class:"text-red-600"},yl={key:0,class:"text-red-600"},Cl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},xl={key:0,class:"text-red-600"},Ml={class:"flex items-center"},El={class:"text-[32px] leading-10 font-medium text-blue-800"},Bl={key:0,class:"text-red-600"},Sl={class:"text-[32px] leading-10 font-medium text-red-800"},Al={class:"grid grid-cols-1"},Ul={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Il=t("div",{class:"lg:col-span-1"},null,-1),wl={class:"lg:col-span-3 flex justify-end"},Tl={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},Ol={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Nl={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},jl={class:"flex items-center"},Pl={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Rl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Dl=t("div",{class:"lg:col-span-3"},null,-1),Ll={class:"lg:col-span-1 flex justify-end"},ql={name:"banks_form",id:"banks_form",autocomplete:"off",class:"space-y-4"},Hl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},Fl=t("div",{class:"lg:col-span-3"},null,-1),Gl={class:"lg:col-span-1 flex justify-end"};function zl(a,e,b,I,o,u){const k=E("Select"),i=E("FromGroup"),V=E("Textinput"),_=E("Button"),j=E("Textarea"),O=E("Modal"),L=E("EditProject");return M(),B("div",null,[l(O,{title:"Amortizar reserva | "+o.valorCode,label:"Modal title",activeModal:b.activeModal,onClose:u.closeEditModal,sizeClass:"max-w-4xl"},{default:s(()=>[t("form",{name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4",onSubmit:e[22]||(e[22]=A((...n)=>u.submitForm&&u.submitForm(...n),["prevent"]))},[t("div",fl,[t("div",null,[t("div",kl,[l(i,{label:"Clientes",class:"flex-1"},{default:s(()=>[l(k,{options:u.limitedCustomerOptions,modelValue:o.income.client_id,"onUpdate:modelValue":e[0]||(e[0]=n=>o.income.client_id=n),class:"client-select",placeholder:"Cliente Reponsable"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[1]||(e[1]=(...n)=>u.openModal&&u.openModal(...n)),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),o.income.client_id?w("",!0):(M(),B("span",Vl,"¡Selecciona un cliente!"))]),t("div",null,[l(i,{label:"Caja aperturada"},{default:s(()=>[l(k,{modelValue:o.income.branchoffice_id,"onUpdate:modelValue":e[2]||(e[2]=n=>o.income.branchoffice_id=n),options:o.boxesOptions,disabled:"",placeholder:"Seleccionar caja"},null,8,["modelValue","options"])]),_:1}),o.income.branchoffice_id?w("",!0):(M(),B("span",yl,"¡Selecciona una caja!"))])]),t("div",Cl,[t("div",null,[l(i,{label:"Método de pago"},{default:s(()=>[l(k,{modelValue:o.income.paymentmethod_id,"onUpdate:modelValue":e[3]||(e[3]=n=>o.income.paymentmethod_id=n),options:o.paymentMethods,placeholder:"Seleccionar método de pago"},null,8,["modelValue","options"])]),_:1}),o.income.paymentmethod_id?w("",!0):(M(),B("span",xl,"¡Selecciona un método de pago!"))]),o.income.paymentmethod_id===4?(M(),B(me,{key:0},[t("div",Ml,[l(i,{label:"Cuenta destino",class:"flex-1"},{default:s(()=>[l(k,{options:o.accountOptions,modelValue:o.income.accountbank_id,"onUpdate:modelValue":e[4]||(e[4]=n=>o.income.accountbank_id=n),class:"cuentadestino-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[5]||(e[5]=A((...n)=>u.openModaalBanckAccount&&u.openModaalBanckAccount(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),l(i,{label:"N° de Operación"},{default:s(()=>[l(V,{type:"text",modelValue:o.income.nro_voucher_external,"onUpdate:modelValue":e[6]||(e[6]=n=>o.income.nro_voucher_external=n),placeholder:"Ingrese N° de Operación"},null,8,["modelValue"])]),_:1})],64)):w("",!0),t("div",null,[l(i,{label:"TOTAL A PAGAR",class:"text-center"},{default:s(()=>[t("span",El,"S/ "+ee(o.income.totalAPagar),1)]),_:1})]),t("div",null,[l(i,{label:"Monto"},{default:s(()=>[l(V,{modelValue:o.income.amount,"onUpdate:modelValue":e[7]||(e[7]=n=>o.income.amount=n),type:"text",placeholder:"Comisión Tours"},null,8,["modelValue"])]),_:1}),o.income.amount?w("",!0):(M(),B("span",Bl,"¡Ingresa un monto!"))]),t("div",null,[l(i,{label:"TOTAL RESTANTE",class:"text-center"},{default:s(()=>[t("span",Sl,"S/ "+ee(o.income.totalRestante),1)]),_:1})])]),t("div",Al,[t("div",null,[l(i,{label:"Observación"},{default:s(()=>[l(V,{modelValue:o.income.observation,"onUpdate:modelValue":e[8]||(e[8]=n=>o.income.observation=n),type:"textarea",placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),t("div",Ul,[Il,t("div",wl,[l(_,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[9]||(e[9]=A(n=>u.closeEditModal(),["prevent"]))}),l(_,{type:"submit",text:"Amortizar reserva",btnClass:"btn-dark"})])]),l(O,{title:"Registrar cuenta bancaria",label:"Modal title",activeModal:o.show3,onClose:u.closeModalEditAccountBank},{default:s(()=>[t("form",Tl,[t("div",Ol,[t("div",null,[l(i,{label:"Sucursal",class:"block"},{default:s(()=>[l(k,{modelValue:o.accountBank.branchoffice_id,"onUpdate:modelValue":e[10]||(e[10]=n=>o.accountBank.branchoffice_id=n),options:o.branchoffices,required:"",class:"oficinaprincipal-select"},null,8,["modelValue","options"])]),_:1})]),t("div",null,[l(i,{label:"Tipo de cuenta",class:"block"},{default:s(()=>[l(k,{modelValue:o.accountBank.typeaccount_id,"onUpdate:modelValue":e[11]||(e[11]=n=>o.accountBank.typeaccount_id=n),options:o.typeaccount,required:"",class:"typeaccount-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",Nl,[t("div",jl,[l(i,{label:"Banco",class:"flex-1"},{default:s(()=>[l(k,{options:o.banks,modelValue:o.accountBank.bank_id,"onUpdate:modelValue":e[12]||(e[12]=n=>o.accountBank.bank_id=n),class:"banck-select",placeholder:"Seleccione"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[13]||(e[13]=A((...n)=>u.openModalBanck&&u.openModalBanck(...n),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")]),t("div",null,[l(i,{label:"Moneda",class:"block"},{default:s(()=>[l(k,{modelValue:o.accountBank.currency_id,"onUpdate:modelValue":e[14]||(e[14]=n=>o.accountBank.currency_id=n),options:o.currency,required:"",class:"money-select"},null,8,["modelValue","options"])]),_:1})])]),t("div",null,[l(i,{label:"Nombre cuenta",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.name,"onUpdate:modelValue":e[15]||(e[15]=n=>o.accountBank.name=n),placeholder:"Nombre cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",Pl,[t("div",null,[l(i,{label:"N° de cuenta",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.number_account,"onUpdate:modelValue":e[16]||(e[16]=n=>o.accountBank.number_account=n),placeholder:"N° de cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"N° CCI (Código interbancario)",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.cci_account,"onUpdate:modelValue":e[17]||(e[17]=n=>o.accountBank.cci_account=n),placeholder:"N° CCI",required:""},null,8,["modelValue"])]),_:1})])]),t("div",null,[l(i,{label:"Titular cuenta",class:"block"},{default:s(()=>[l(V,{modelValue:o.accountBank.headline,"onUpdate:modelValue":e[18]||(e[18]=n=>o.accountBank.headline=n),placeholder:"Titular cuenta",required:""},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"Descripción",class:"block"},{default:s(()=>[l(j,{modelValue:o.accountBank.description,"onUpdate:modelValue":e[19]||(e[19]=n=>o.accountBank.description=n),placeholder:"Descripción"},null,8,["modelValue"])]),_:1})]),t("div",Rl,[Dl,t("div",Ll,[l(_,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:A(u.closeModalEditAccountBank,["prevent"])},null,8,["onClick"]),l(_,{type:"submit",text:"Guardar Cambios",onClick:A(u.guardarCambiosAccountBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])]),l(O,{title:"Registrar banco",label:"Modal title",activeModal:o.show4,onClose:e[21]||(e[21]=n=>o.show4=!1)},{default:s(()=>[t("form",ql,[l(V,{modelValue:o.bank.description,"onUpdate:modelValue":e[20]||(e[20]=n=>o.bank.description=n),label:"Nombre",name:"pn",type:"text",placeholder:"Ingresar nombre "},null,8,["modelValue"]),t("div",Hl,[Fl,t("div",Gl,[l(_,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:A(u.closeEditModalBank,["prevent"])},null,8,["onClick"]),l(_,{type:"submit",text:"Guardar Cambios",onClick:A(u.guardarCambiosBank,["prevent"]),btnClass:"btn-dark"},null,8,["onClick"])])])])]),_:1},8,["activeModal"])]),_:1},8,["activeModal","onClose"])],32),l(L,{activeModal:o.showEditModal,onClose:e[23]||(e[23]=n=>o.showEditModal=!1),title:"Actualizar Registro de Colaborador",onUpdateClientList:u.fetchClients},null,8,["activeModal","onUpdateClientList"])]),_:1},8,["title","activeModal","onClose"])])}const Fo=se(_l,[["render",zl]]),X=$().headers(),Jl={components:{Dropdown:ne,Select:N,Button:H,FromGroup:x,EditProject:be,Textinput:P,Modal:Z,Checkbox:ye,InputGroup:W,Icon:te,VueSelect:ae,MenuItem:ie,Card:oe,ProgressBar:Ce},data(){return{idBookingg:null,advancedTable:xe,searchTerm:"",tellephonAndCellphone:"",selectedAsignHotel:!1,selectedHotel:!1,showEditModal:!1,store:null,customerOptions:[],hotelOptions:[],projects:[],actions:[{name:"edit",icon:"heroicons:pencil-square",doit:a=>{this.openModalEdit(a)}},{name:"delete",icon:"heroicons-outline:trash",doit:a=>{this.removeProject(a)}}],columnsReservaHotelExpense:[{label:"Habitacion",field:"habitacion"},{label:"N° PAX	",field:"pasajeross"},{label:"Cant. HAB",field:"cantidad"},{label:"Check-In",field:"checkin"},{label:"Check-out",field:"checkout"},{label:"#Noches",field:"noches"},{label:"Precio",field:"precio"},{label:"Descuento",field:"descuento"},{label:"Adicional",field:"adicional"},{label:"Observación",field:"observacion"},{label:"Subtotal",field:"subtotal"},{label:"",field:"action"}],bookinghotel:{id:null,hotel_id:null,booking_id:null,client_id:null,collaborator_id:null,code:null,correlative:null,reference_voucher:null,is_external:null,total:null,observation:null,created_at:null,updated_at:null,deleted_at:null,hotel_description:null,client_fullname:null,client_document:null,client_cellphone:null,client_telephone:null},bedroomOptions:[{value:1,label:"HAB. SIMPLE"},{value:2,label:"HAB. SIMPLE (AC)"},{value:3,label:"HAB. MATRIMONIAL"},{value:4,label:"HAB. MATRIMONIAL (AC)"},{value:5,label:"HAB. DOBLE"},{value:6,label:"HAB. DOBLE (AC)"},{value:7,label:"HAB. TRIPLE"},{value:8,label:"HAB. TRIPLE (AC)"},{value:9,label:"HAB. GRUPAL"},{value:10,label:"HAB. GRUPAL (AC)"}]}},props:{activeModal:Boolean,code:String,idCliente:String,idBooking:String},emits:["close"],created(){this.fetchHotels(),this.fetchClients()},watch:{selectedAsignHotel(a,e){if(a!==e){const b=this.projects.findIndex(I=>I.id===a);b===-1?S.get(`https://thtbackend-production.up.railway.app/api/v1/typebedrooms/description/${a}`,X).then(I=>{const o={id:a,description:I.data.data};this.projects.push(o),this.calculateTotal(this.projects.length-1)}):S.get(`https://thtbackend-production.up.railway.app/api/v1/typebedrooms/description/${a}`,X).then(I=>{this.projects[b].description=I.data.data,this.calculateTotal(b)})}},"bookinghotel.client_id"(a,e){S.get(`https://thtbackend-production.up.railway.app/api/v1/clients/cellphone&telephone/${a}`,X).then(b=>{console.log(b),this.tellephonAndCellphone=b.data.contact_numbers}).catch(b=>{console.error("Error al obtener la descripción del tour:",b)})},projects:{deep:!0,handler(a,e){this.calculateTotalForAllProjects()}},code:function(a,e){this.bookinghotel.booking_id=a,console.log("El valor del code es",a)},idCliente:function(a,e){this.fetchClients(),this.bookinghotel.client_id=a,console.log("El valor del idCliente es",a)},idBooking:function(a,e){this.idBookingg=a,console.log("El valor idBooking es",a)}},methods:{closeEditModal(){this.$emit("close")},updateNights(a){const e=new Date(this.projects[a].date_checkin),I=new Date(this.projects[a].date_checkout).getTime()-e.getTime(),o=Math.ceil(I/(1e3*3600*24));this.projects[a].nights=o},calculateTotalForAllProjects(){let a=0;this.projects.forEach(e=>{const b=e.price||0,I=e.nights||0,o=e.quantity||1;e.subtotal=b*I*o,a+=b*I*o}),this.bookinghotel.total=a},calculateTotal(a){const e=this.projects[a],b=e.price||0,I=e.nights||0,o=e.quantity||1;e.total=b*I*o,this.calculateTotalForAllProjects()},saveReservaHotel(){const a={hotel_id:this.bookinghotel.hotel_id,client_id:this.bookinghotel.client_id,booking_id:this.idBookingg,collaborator_id:this.bookinghotel.collaborator_id,code:this.bookinghotel.code,correlative:this.bookinghotel.correlative,reference_voucher:this.bookinghotel.reference_voucher,is_external:this.bookinghotel.is_external,observation:this.bookinghotel.observation,total:this.bookinghotel.total,detailbedrooms:this.projects.map(e=>({typebedroom_id:e.id,date_checkin:e.date_checkin,date_checkout:e.date_checkout,quantity:e.quantity,guests:e.guests,nights:e.nights,price:e.price,additional:e.additional,discount:e.discount,observation:e.observation}))};console.log(a),S.post("https://thtbackend-production.up.railway.app/api/v1/hotelsbookings/create",a,{...X}).then(e=>{this.$emit("postComplete",e.data);const b=D();this.closeEditModal(),b.success(e.data.message)}).catch(e=>{console.error("Error al enviar los datos al backend:",e)})},openModal(){this.showEditModal=!0},deleteProject(a){this.projects.splice(a,1),console.log(this.projects)},async fetchHotels(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/hotels/list",X);console.log(a),this.hotelOptions=a.data.data.map(e=>({value:e.id,label:e.tradename}))}catch(a){console.error("Error al obtener los datos de los colaboradores:",a)}},async fetchClients(){try{const a=await S.get("https://thtbackend-production.up.railway.app/api/v1/clients/list",X);this.customerOptions=a.data.data.map(e=>({value:e.id,label:e.fullname}))}catch(a){console.error("Error fetching departments:",a)}}},computed:{limitedCustomerOptions(){return this.customerOptions.slice(0,6)}}},Yl=a=>(ke("data-v-f6a8d822"),a=a(),Ve(),a),Xl={name:"book_form",id:"book_form",autocomplete:"off",class:"mx-auto space-y-4"},Kl={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ql={class:"flex items-center"},Wl={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},Zl={class:"flex items-center"},$l={class:"flex-grow mr-2"},eo={class:"grid grid-cols-1"},lo={class:"flex flex-col"},oo={key:0},to={class:"flex space-x-3 items-center text-left rtl:space-x-reverse"},ao={key:1},no={key:2,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},so={key:3,class:"text-slate-500 dark:text-slate-400 block min-w-[108px]"},io={key:4,class:"block w-full"},co={key:5},ro={key:6},uo={key:7},mo={key:8},po={key:9},bo={key:10},ho={key:11,class:"action-btn text-end mr-3"},vo=["onClick"],go={class:"mt-5 self-end"},_o={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 mt-4"},fo=Yl(()=>t("div",{class:"lg:col-span-1"},null,-1)),ko={class:"lg:col-span-3 flex justify-end"};function Vo(a,e,b,I,o,u){const k=E("InputGroup"),i=E("FromGroup"),V=E("Select"),_=E("Textinput"),j=E("flat-pickr"),O=E("Icon"),L=E("vue-good-table"),n=E("Button"),K=E("EditProject"),p=E("Modal");return M(),B("div",null,[l(p,{title:"Registrar reserva de hotel",label:"Modal title",activeModal:b.activeModal,onClose:u.closeEditModal,sizeClass:"max-w-8xl"},{default:s(()=>[t("form",Xl,[t("div",Kl,[t("div",null,[l(i,{label:"Asociar reserva"},{default:s(()=>[l(k,{type:"tel",modelValue:o.bookinghotel.booking_id,"onUpdate:modelValue":e[0]||(e[0]=c=>o.bookinghotel.booking_id=c),placeholder:"Reserva"},null,8,["modelValue"])]),_:1})]),t("div",null,[t("div",Ql,[l(i,{label:"Cliente Responsable",class:"flex-1"},{default:s(()=>[l(V,{options:u.limitedCustomerOptions,modelValue:o.bookinghotel.client_id,"onUpdate:modelValue":e[1]||(e[1]=c=>o.bookinghotel.client_id=c),class:"client-select"},null,8,["options","modelValue"])]),_:1}),t("button",{onClick:e[2]||(e[2]=A((...c)=>u.openModal&&u.openModal(...c),["prevent"])),class:"ml-2 mt-7 p-2 btn-outline-dark"},"+")])]),t("div",null,[l(i,{label:"Número teléfono"},{default:s(()=>[l(k,{type:"tel",modelValue:o.tellephonAndCellphone,"onUpdate:modelValue":e[3]||(e[3]=c=>o.tellephonAndCellphone=c),placeholder:"Número de teléfono"},null,8,["modelValue"])]),_:1})])]),t("div",Wl,[t("div",null,[l(i,{label:"Búsqueda de hotel"},{default:s(()=>[l(V,{options:o.hotelOptions,modelValue:o.bookinghotel.hotel_id,"onUpdate:modelValue":e[4]||(e[4]=c=>o.bookinghotel.hotel_id=c),placeholder:"Buscar hotel"},null,8,["options","modelValue"])]),_:1})]),t("div",null,[l(i,{label:"Asignar habitación"},{default:s(()=>[t("div",Zl,[t("div",$l,[l(V,{options:o.bedroomOptions,modelValue:o.selectedAsignHotel,"onUpdate:modelValue":e[5]||(e[5]=c=>o.selectedAsignHotel=c),placeholder:"Seleccionar Hotel",class:"w-full"},null,8,["options","modelValue"])])])]),_:1})]),t("div",null,[l(i,{label:"N° ref. comprobante"},{default:s(()=>[l(_,{type:"text",modelValue:o.bookinghotel.reference_voucher,"onUpdate:modelValue":e[6]||(e[6]=c=>o.bookinghotel.reference_voucher=c),placeholder:"Número de referencia del comprobante"},null,8,["modelValue"])]),_:1})]),t("div",null,[l(i,{label:"Observaciones"},{default:s(()=>[l(_,{type:"text",modelValue:o.bookinghotel.observation,"onUpdate:modelValue":e[7]||(e[7]=c=>o.bookinghotel.observation=c),placeholder:"Observaciones"},null,8,["modelValue"])]),_:1})])]),t("div",eo,[t("div",lo,[l(L,{class:"-mx-6 mb-5",columns:o.columnsReservaHotelExpense,styleClass:" vgt-table  table-head   v-middle striped lesspadding2 listview",rows:this.projects,"sort-options":{enabled:!1}},{"table-row":s(c=>[c.column.field=="habitacion"?(M(),B("span",oo,[t("div",to,ee(c.row.description),1)])):w("",!0),c.column.field=="pasajeross"?(M(),B("span",ao,[l(_,{type:"text",placeholder:"N° pax",modelValue:o.projects[c.index].guests,"onUpdate:modelValue":y=>o.projects[c.index].guests=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),c.column.field=="cantidad"?(M(),B("span",no,[l(_,{type:"text",placeholder:"Cant. HAB",modelValue:o.projects[c.index].quantity,"onUpdate:modelValue":y=>o.projects[c.index].quantity=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),c.column.field=="checkin"?(M(),B("span",so,[l(j,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:o.projects[c.index].date_checkin,"onUpdate:modelValue":y=>o.projects[c.index].date_checkin=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),c.column.field=="checkout"?(M(),B("span",io,[l(j,{class:"form-control",id:"d1",placeholder:"yyyy, dd M",modelValue:o.projects[c.index].date_checkout,"onUpdate:modelValue":y=>o.projects[c.index].date_checkout=y,onChange:y=>u.updateNights(c.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):w("",!0),c.column.field=="noches"?(M(),B("span",co,[l(_,{type:"text",placeholder:"#Noches",modelValue:o.projects[c.index].nights,"onUpdate:modelValue":y=>o.projects[c.index].nights=y,onChange:y=>u.calculateTotal(c.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):w("",!0),c.column.field=="precio"?(M(),B("span",ro,[l(_,{type:"text",placeholder:"Precio",modelValue:o.projects[c.index].price,"onUpdate:modelValue":y=>o.projects[c.index].price=y,onChange:y=>u.calculateTotal(c.index)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):w("",!0),c.column.field=="descuento"?(M(),B("span",uo,[l(_,{type:"text",placeholder:"Descuento",modelValue:o.projects[c.index].discount,"onUpdate:modelValue":y=>o.projects[c.index].discount=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),fe(),c.column.field=="adicional"?(M(),B("span",mo,[l(_,{type:"text",placeholder:"Adicional",modelValue:o.projects[c.index].additional,"onUpdate:modelValue":y=>o.projects[c.index].additional=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),c.column.field=="observacion"?(M(),B("span",po,[l(_,{type:"text",placeholder:"Observacion",modelValue:o.projects[c.index].observation,"onUpdate:modelValue":y=>o.projects[c.index].observation=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),c.column.field=="subtotal"?(M(),B("span",bo,[l(_,{type:"text",placeholder:"Subtotal",modelValue:o.projects[c.index].subtotal,"onUpdate:modelValue":y=>o.projects[c.index].subtotal=y},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0),c.column.field=="action"?(M(),B("div",ho,[t("div",{class:"text-xl",onClick:y=>u.deleteProject(c.index)},[l(O,{icon:"heroicons-outline:trash",class:"text-danger-500"})],8,vo)])):w("",!0)]),_:1},8,["columns","rows"]),t("div",go,[l(k,{label:"T. RESERVA S/.",class:"append",name:"hi_Fullname",type:"number",placeholder:"",modelValue:o.bookinghotel.total,"onUpdate:modelValue":e[8]||(e[8]=c=>o.bookinghotel.total=c),horizontal:"",appendIcon:"heroicons-outline:cash",classInput:"text-right"},null,8,["modelValue"])])])]),t("div",_o,[fo,t("div",ko,[l(n,{text:"Cancelar",btnClass:"btn-light mr-2",onClick:e[9]||(e[9]=A(c=>u.closeEditModal(),["prevent"]))}),l(n,{type:"submit",text:"Guardar Reserva",btnClass:"btn-dark",onClick:e[10]||(e[10]=A(c=>u.saveReservaHotel(),["prevent"]))})])])]),l(K,{activeModal:o.showEditModal,onClose:e[11]||(e[11]=c=>o.showEditModal=!1),title:"Actualizar Registro de Colaborador",onUpdateClientList:u.fetchClients},null,8,["activeModal","onUpdateClientList"])]),_:1},8,["activeModal","onClose"])])}const Go=se(Jl,[["render",Vo],["__scopeId","data-v-f6a8d822"]]);export{Fo as A,Ho as C,Go as E,be as _};
